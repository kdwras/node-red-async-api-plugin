[
    {
        "id": "0c8e0c86799d088c",
        "type": "tab",
        "label": "openAPI red",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a527806fb52a0bc0",
        "type": "tab",
        "label": "Thermostat Dashboard",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d68460b3bb47684e",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a7f4785e36cba6a2",
        "type": "tab",
        "label": "Thermostats Demo",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b0c6f1e3d4fc18a3",
        "type": "tab",
        "label": "Flow 3",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "smarthome_flow",
        "type": "tab",
        "label": "SmartHome+",
        "disabled": false,
        "info": ""
    },
    {
        "id": "9d0b8d8486bf692d",
        "type": "tab",
        "label": "SmartHome+",
        "disabled": false,
        "info": ""
    },
    {
        "id": "db6486d1d2cd59d6",
        "type": "tab",
        "label": "SmartHome+",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4f4855f52107b72b",
        "type": "tab",
        "label": "SmartHome+",
        "disabled": false,
        "info": ""
    },
    {
        "id": "878f967ba70ceb42",
        "type": "tab",
        "label": "Flow 2",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "tab_neighborhood",
        "type": "tab",
        "label": "Neighborhood",
        "disabled": false,
        "info": ""
    },
    {
        "id": "240e9c78e5c49674",
        "type": "tab",
        "label": "ALL IN",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "5c2420afdd74920f",
        "type": "tab",
        "label": "Flow 5",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2a4e2856b37c3f19",
        "type": "tab",
        "label": "SMARTHOOD",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "438d596005491859",
        "type": "tab",
        "label": "smart plug test",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a1c0e100f11a4f9b",
        "type": "tab",
        "label": "Smart Plug Webhook",
        "disabled": false,
        "info": ""
    },
    {
        "id": "eeca424b18026ca1",
        "type": "subflow",
        "name": "Subflow 1",
        "info": "",
        "in": [],
        "out": []
    },
    {
        "id": "043c9b21da5cbba8",
        "type": "subflow",
        "name": "Subflow 2",
        "info": "",
        "in": [],
        "out": []
    },
    {
        "id": "subflow-thermostat-logic",
        "type": "subflow",
        "name": "Thermostat Logic",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "f1b4a93aa4e5e122"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 440,
                "y": 80,
                "wires": [
                    {
                        "id": "f1b4a93aa4e5e122",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "subflow_smarthome",
        "type": "subflow",
        "name": "SmartHome",
        "info": "Simulates one smart home with environment, devices and total energy.",
        "category": "smarthome",
        "in": [],
        "out": [],
        "env": [
            {
                "name": "homeId",
                "type": "num",
                "value": 1
            }
        ],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "7ecc82fdd5fcacdb",
        "type": "subflow",
        "name": "Smarthome subflow",
        "info": "",
        "category": "",
        "in": [],
        "out": [
            {
                "x": 2500,
                "y": 1040,
                "wires": [
                    {
                        "id": "c73637d98e05e80e",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "2785aa7402e0c422",
        "type": "group",
        "z": "0c8e0c86799d088c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "bfb6d9bfe0c540fc",
            "743761d0ea53bc31",
            "7292a72a4b6230c9",
            "d7f5f6ed015725be",
            "8708fbbaf99494f4",
            "eb7c8264bfd927b1",
            "fb837ec50d0e5ff5",
            "e590371eec36462b",
            "b6a518cae0ed236e",
            "d148bc258eb112ca",
            "a8b3b1803a943f5d",
            "2e21f69b42218552",
            "714e3635c401250f",
            "f86103930fc1fd85",
            "3323c6018c67090b",
            "7cdf47e943d3721a",
            "67e82cdae3014568",
            "60072a460f71141f"
        ],
        "x": 1094,
        "y": 579,
        "w": 832,
        "h": 442
    },
    {
        "id": "01c6034556accf3a",
        "type": "group",
        "z": "0c8e0c86799d088c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "fb0068a4371ff253",
            "2810755f89def0ab",
            "9d2350b1eee037db",
            "75126d56d71e3c3c",
            "facfb133068f19c4",
            "cfb1e29cc9832121",
            "12d7924ce265af7b",
            "8c42edd3ad8f483f",
            "11c835bfe0e324a3",
            "84f43a190c420cc0",
            "9f53aae319aea21a",
            "e70c041c9abdaf24",
            "032cdf22b09cbf50",
            "fae3ae2c4e4f2543",
            "12e3afafe385aec5",
            "14862242a91c03b1",
            "18797dbc244535cc",
            "9810d92794505360",
            "7f3d299d1ec31a66"
        ],
        "x": 1094,
        "y": 59,
        "w": 772,
        "h": 482
    },
    {
        "id": "efb7a27e4dfae1f6",
        "type": "group",
        "z": "0c8e0c86799d088c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a683470f9f9d2be2",
            "fd241870fe8e402a",
            "a88e075f0ee05109",
            "f13e6ce1a71fb95e",
            "e5fe633619ed6e0a",
            "d2c25c70ca021b0e",
            "d9b0d7fcf676d77f",
            "ea87fde3734d5f09",
            "4a34670d715fd56d",
            "21f13b66e154f470",
            "852ef3b902872cf8",
            "6d87958f749b4d65",
            "c8b83ed3e66303c2",
            "1b52e6c758aacb10",
            "54ce4caefeb8ba12",
            "c6e69660fab90ac4",
            "17b0e03a9286c258",
            "deee4299c301b4a8",
            "5e6a3d87843af348",
            "9571f83d9ff1cfb7",
            "a7a87e65a43ce895",
            "4a87ce22e00f3efa",
            "16ff18397b551163",
            "c2a567a74171bc92",
            "a2798a84ebf29821",
            "8045a1d812f80bfb",
            "3a9e9aaa25a5c025",
            "2acfae3a3b04e41f",
            "6d04430b35be0819",
            "fe01a9e33899abda",
            "5be937fe9b529fc1",
            "1d6d17c456d6e266",
            "1d205353151b266e",
            "8d63e9e4de8cbe37",
            "f7e22af6d625591e",
            "c897adafa788de00",
            "65110c919e408b85",
            "8a432c1017ac312e",
            "d81d9db98b14b421",
            "ad8ebbbf4fad2678",
            "751bd26d424cc321"
        ],
        "x": 54,
        "y": 59,
        "w": 872,
        "h": 1024.5
    },
    {
        "id": "50a045551ea38743",
        "type": "group",
        "z": "a527806fb52a0bc0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d4f8c637ba287db1",
            "69ded1d17cbec561",
            "9a05b0be9bfe3225",
            "1d06a67200a8e66e",
            "d9d04269593328c3",
            "1eb2f1ad87e9df5c",
            "09f2f1cdc17cf192",
            "5fd815fb2caf5aba",
            "ba5dc6718d645637",
            "27b270e5d78bc103",
            "8081e1c458fe1e4b"
        ],
        "x": 94,
        "y": 79,
        "w": 1362,
        "h": 242
    },
    {
        "id": "a0bc03072058d078",
        "type": "group",
        "z": "a527806fb52a0bc0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4c2bce897c0d2007",
            "652fef5d99c41776",
            "98def4b9de0bd9e0",
            "977bf35655af95ea",
            "325004b4427897ea",
            "4ffc7d206027f2ef",
            "180cc2c38f2b7ec2",
            "6f5c1f35a0395420",
            "c90d975ea0894abd",
            "e5f04a5e61c95926",
            "87c71e9f1e18a5cb",
            "a11a61d05abb0fd9",
            "97a42e312b36f637",
            "96ab1cc712be6574",
            "3cdc3eae3c728601"
        ],
        "x": 94,
        "y": 359,
        "w": 1412,
        "h": 282
    },
    {
        "id": "6996a7f421765b1a",
        "type": "group",
        "z": "a527806fb52a0bc0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "1616e8d0253bffbf",
            "29a719f9730293ac",
            "b58e5041e4c9741b",
            "d83a4d77d7f049bf",
            "84eae99cd8fb8148",
            "9b07cf1424fb44b6",
            "499267adb5adb442",
            "02494731b443fa30",
            "4229373250208f05",
            "dba1b26fa3a4b0a8",
            "c0f6b3899961c14c",
            "ae9ed5515183f125",
            "bdacb97c9c98471c",
            "f42d0e7a987f22d0"
        ],
        "x": 94,
        "y": 679,
        "w": 1742,
        "h": 382
    },
    {
        "id": "38af56c2be0e770c",
        "type": "group",
        "z": "a527806fb52a0bc0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2f8c3fe9e3a364d1",
            "aec069bf440e39e4",
            "601a43db7ca6fa0a",
            "47886e634365fb88",
            "f324d4a123376c63",
            "f6b18e5f375f811d",
            "6aa34857a3f76ef9"
        ],
        "x": 94,
        "y": 1099,
        "w": 1332,
        "h": 162
    },
    {
        "id": "d6d6813509f8a19b",
        "type": "group",
        "z": "a527806fb52a0bc0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d4868acaa6b1056b",
            "format_coffee",
            "join_coffee",
            "debug_coffee",
            "b972287969dd1e02",
            "ui_size",
            "ui_strength",
            "ui_coffee_status"
        ],
        "x": 94,
        "y": 1319,
        "w": 1272,
        "h": 222
    },
    {
        "id": "9d8fc96b503dd8a9",
        "type": "group",
        "z": "043c9b21da5cbba8",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2c2826fa3fc78558",
            "f034a42a7690f2b6",
            "5d88956b6c0935c0",
            "386c2541306d379c",
            "c9dd5b14b31c8ac4",
            "80a07121563fc510",
            "5838340eeabc7fc3",
            "a9a704cd8fe91875",
            "f5b57f8f9931df1d",
            "da3a80e17247daa5"
        ],
        "x": 134,
        "y": 19,
        "w": 1362,
        "h": 282
    },
    {
        "id": "9d700ddc16539c15",
        "type": "group",
        "z": "043c9b21da5cbba8",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4f9b9aad403a7716",
            "37bc8c54b51e0544",
            "238dc90f83e202b5",
            "47a8e2a4a04033b2",
            "19c76ec98c6c6f9e",
            "d91d138267780e70",
            "871fbf285c97ad32",
            "58cc42a80fabb538",
            "428fababd41468e5",
            "a2be1e487fc29763",
            "d402ccc398ad8e11",
            "f80d0cef913ac3b6",
            "7dad711be4a117f7",
            "b7bddd515b8a9da3",
            "9cc41c71b7e8e277"
        ],
        "x": 134,
        "y": 339,
        "w": 1412,
        "h": 282
    },
    {
        "id": "a2a5c6556a04c7ed",
        "type": "group",
        "z": "043c9b21da5cbba8",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2611be0f7bfa29c3",
            "641a94a8fde2acc3",
            "bc1ec909440f8c22",
            "bd9cca5d85c07dd4",
            "60cd23ec6f422ac1",
            "59f210ba6791d0a1",
            "9f318a7151cc5d6d",
            "56bd1f17c275a653",
            "4077b1f7c25ba23c",
            "d543fbc9eaaeb755",
            "326076c19834796f",
            "6cf09c18f6619610",
            "b73d117192e42809",
            "db70af4f273bfc97"
        ],
        "x": 134,
        "y": 659,
        "w": 1742,
        "h": 382
    },
    {
        "id": "e49647927e3b9d1e",
        "type": "group",
        "z": "043c9b21da5cbba8",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d9daa6e7df2953bb",
            "a87e8394d9f25e8c",
            "fb30e09493d3f725",
            "83982045fbc9296b",
            "0fb2875d235f6c99",
            "b6b89773a30b7a33",
            "f50a98b0aabb9eac"
        ],
        "x": 134,
        "y": 1079,
        "w": 1332,
        "h": 162
    },
    {
        "id": "1a95f1f2d410aea3",
        "type": "group",
        "z": "043c9b21da5cbba8",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "efee14a4a88be124",
            "c12f4c5b3b6032a4",
            "1855218a50989a4b",
            "9b2e7830db9edc47",
            "a8097aa9ba390408",
            "cd4279d372ca3068",
            "921bcc21c54deadc",
            "9e910b904fa61a23"
        ],
        "x": 134,
        "y": 1299,
        "w": 1272,
        "h": 222
    },
    {
        "id": "6fbdbe15acb6baf1",
        "type": "group",
        "z": "b0c6f1e3d4fc18a3",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "inject_temp",
            "gen_temp",
            "decide_mode",
            "thermostat_asyncapi",
            "thermostat_debug",
            "thermostat_ui",
            "7a5f61a9eaff8de0"
        ],
        "x": 114,
        "y": 159,
        "w": 1332,
        "h": 202
    },
    {
        "id": "thermostat_group",
        "type": "group",
        "z": "smarthome_flow",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "inject_thermostat",
            "func_thermostat",
            "asyncapi_thermostat",
            "debug_thermostat",
            "ui_thermostat",
            "comment_thermostat"
        ],
        "x": 124,
        "y": 89,
        "w": 1122,
        "h": 172
    },
    {
        "id": "60aadd304320ab68",
        "type": "group",
        "z": "9d0b8d8486bf692d",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "ec8567273d2eeee4",
            "4f76589d9ce93708",
            "3c02180f43d76483",
            "52372a1a90bed450",
            "08eba1a39da3c211",
            "d34fbeffad5f26c3"
        ],
        "x": 54,
        "y": 9,
        "w": 982,
        "h": 172
    },
    {
        "id": "7495cd4d423a5333",
        "type": "group",
        "z": "9d0b8d8486bf692d",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "b2ace2b50a3cffc6",
            "5767fb305640ce22",
            "320f5263b6a058cb",
            "6c79919ed6d57634",
            "d61ec178a3c22e54",
            "29acb7a9e4ad24bf"
        ],
        "x": 74,
        "y": 259,
        "w": 942,
        "h": 172
    },
    {
        "id": "5b08965eee815217",
        "type": "group",
        "z": "db6486d1d2cd59d6",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "565b754961e5b93e",
            "230fec0f35cc4133",
            "55079425775637d9",
            "559b9f04cf93c275",
            "512fb36647226d10"
        ],
        "x": 84,
        "y": 39,
        "w": 952,
        "h": 142
    },
    {
        "id": "4575d7c456ea2458",
        "type": "group",
        "z": "db6486d1d2cd59d6",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "01573af29b531a78",
            "4d738e0fc0f1352c",
            "a946ef667e501665",
            "0ab73cc9fa9c5c90",
            "91288be2c27b7ea4"
        ],
        "x": 74,
        "y": 289,
        "w": 942,
        "h": 142
    },
    {
        "id": "876a8dac7a94efab",
        "type": "group",
        "z": "4f4855f52107b72b",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "94935853959483b3",
            "d7982dd2528420ba",
            "c99ee48a54796f90",
            "lights_group",
            "fridge_group",
            "launder_group",
            "dehumidifier_group",
            "cooker_group",
            "19609f77c4ba5897",
            "dbcecb9927394929",
            "881db607590cd279",
            "e2e99964236f8675",
            "6578bf7b191c43b7",
            "9c58429dd67aded0",
            "d72e67c06e6e6132",
            "45e26e30f704ad47",
            "f47559f06abd3bf6",
            "3176681a660261ae"
        ],
        "x": 54,
        "y": 59,
        "w": 3138,
        "h": 1898
    },
    {
        "id": "e4a1e5e130e19d38",
        "type": "group",
        "z": "subflow_smarthome",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a9c603099da1e03f",
            "cda627aaa496a0a6",
            "895c7c19f3f0551f",
            "5a57beeed82dc92a",
            "4afe9ba8425f8677",
            "c22e79154c621f48",
            "f7cd6fc6dc26feb6",
            "f5fdf02df3e4db07",
            "4ac7585640aa85e7",
            "50ea0a25ce1a6cf2",
            "398f82e683f32eac",
            "e797385e830437c1",
            "b286887c3781c24d",
            "120aa6a9def4bbc7",
            "2e6836af4c8a6447",
            "99bfcadd3a7ad7f7",
            "2b7cb5b81308fd7d",
            "5392cb0f65e931be",
            "d57ddce80dd36ece",
            "b0adece6f42f3e45"
        ],
        "x": 14,
        "y": 99,
        "w": 2352,
        "h": 1488
    },
    {
        "id": "85b30d2997a48dee",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c73637d98e05e80e",
            "cbee460370ecb3f8",
            "30df11e17a49e28b",
            "11d91ae28562cdca",
            "3cd4dba2d47ed535",
            "e3185234fdbed879",
            "37227888554b698a",
            "12a36cdccd5ed9f8",
            "7d5c52aa5ac682d2",
            "a81d83c8e5e451b8",
            "3c917e3eeb92eecf",
            "a1714f7d84f7249a",
            "761fbf79bc5a0b6a",
            "8a7ff196473cf82f",
            "eee9708f5b5b3d60",
            "e5aad1750982bf58",
            "f8b4241ac415ab1f",
            "8ec75af908428eac",
            "3842878445c54be5",
            "db540a36c0cf8246"
        ],
        "x": 294,
        "y": 119,
        "w": 2352,
        "h": 1488
    },
    {
        "id": "f3a7b992615fd6e7",
        "type": "group",
        "z": "438d596005491859",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "7f7a81c81fb18909",
            "3e5336b3c932e13c"
        ],
        "x": 528,
        "y": 233,
        "w": 814,
        "h": 374
    },
    {
        "id": "9be3feeb419a7b53",
        "type": "group",
        "z": "4f4855f52107b72b",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d2748fb7d73cced7",
            "50d822b0af5cc61a",
            "fe7c6d62782a61e9",
            "6028a3ed46cca3d4",
            "abefde1276346b1c",
            "0d443770ff71eb54",
            "2fd9a75bdb7f05d0"
        ],
        "x": 128,
        "y": 2019,
        "w": 2684,
        "h": 488
    },
    {
        "id": "4aafd0fb6b684f3d",
        "type": "group",
        "z": "4f4855f52107b72b",
        "name": "Dehumidifier Smart Plug Control (Auto)",
        "style": {
            "label": true
        },
        "nodes": [
            "8e4f42e423d53fbb"
        ],
        "x": null,
        "y": null,
        "w": null,
        "h": null
    },
    {
        "id": "f9977bae9b3b4e4c",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "35bdc95fd4cb9f93",
            "ddf6fcec6341cd57",
            "4cdaba113baf505c",
            "3c9b727746d70288",
            "4d1e2166731b930e"
        ],
        "x": 434,
        "y": 4699,
        "w": 5664,
        "h": 1274
    },
    {
        "id": "e549cfd9ad9549fa",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "9ca34d0fa78dc4e6",
            "871d0abcb01cdc68",
            "35c69ea124d4d0e1",
            "eb32d2deafc74169",
            "f1b6a5525b0fd9d0",
            "add8e9250cbeec27",
            "766e712ef6fc6ed8",
            "2cc7b89db7db8ed8",
            "13ffcd31cb74f7a5",
            "ca4e2bae263dda8c",
            "28937a91c747bf27",
            "3b54f4b88201ae9f",
            "eab15c939712e89b",
            "9881ad96b9bcf2b7",
            "95e834be6abfd0af",
            "849f455c90b8193e",
            "36d214c8ee683881",
            "f76e5e035e6a0475"
        ],
        "x": 494,
        "y": 199,
        "w": 3138,
        "h": 1898
    },
    {
        "id": "e7e61c882634a6de",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "ce425eea2d991746",
            "efcdf63cfcc1dd48",
            "2dd4501966039026",
            "1007ee2791e026f6",
            "7831a62e791b5d1d",
            "a93877d13c210358",
            "5a107c630ab6ea2a",
            "5fa6601368fe9e2c",
            "fec5dcecdaa3c889",
            "575535f60d95ed0e",
            "428180dd82e49c18",
            "d50ad12694f17cd1",
            "b9ea0c25f0b04076",
            "73f3eb149c908946",
            "b65cd0c520e407f4",
            "28b4c86d1a067d3b",
            "6fb2c52901fa6564",
            "dd1077e8cd7a0f41"
        ],
        "x": 494,
        "y": 2279,
        "w": 3138,
        "h": 1898
    },
    {
        "id": "9e1acfb34c8e68b0",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4bea898bf80beb2a",
            "00cd4bf75f088c52",
            "be056a72e9275c15",
            "3fb223172ed07613",
            "e3d80939c7253d94",
            "aae6bf515142caa9",
            "8a08412bbf9f11a0",
            "e6db06e9dcfcc16d",
            "dfefcb553a63afda",
            "34f502e92c073b72",
            "9b1896d497f9ecb4",
            "042892b32870381c",
            "a12ae159f8cb4da2",
            "9977b3406dec1a0a",
            "c45d7f2673c9633a",
            "0c808411f05c1ea6",
            "421452f3a4703c8e",
            "43e9cdc67bd872b9"
        ],
        "x": 4354,
        "y": 199,
        "w": 3138,
        "h": 1898
    },
    {
        "id": "1097f133a27f5465",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "6392dd4d3971d9f8",
            "5273dd8568cb4dcb",
            "916e0cc111af8d8b",
            "b647d0210ac8b2db",
            "72c6c9f087ddb6ec",
            "6950d3876bef51db",
            "4cd08abf60f35b98",
            "48cc597ddf9d2a0b",
            "282ec275aee5bf61",
            "0aa83a9c829e4ad4",
            "daee0bc99036aa55",
            "75a075f042f21639",
            "2726468caef530d8",
            "1ba2b0626374db8a",
            "41caf86cf1e205e8",
            "9974167b54831097",
            "80b1a2a950fbf3a4",
            "532eae8f62ba2e88"
        ],
        "x": 4314,
        "y": 2519,
        "w": 3138,
        "h": 1898
    },
    {
        "id": "50d822b0af5cc61a",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "7beea3e98437718c",
            "4e8d16b83fa2b771",
            "0dc74f1972d85f33",
            "792d16844e582310"
        ],
        "x": 154,
        "y": 2119,
        "w": 762,
        "h": 142
    },
    {
        "id": "d2748fb7d73cced7",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "ebcda5c59f9a16f1",
            "c4e7455fb216592d",
            "79b596b657bb6429",
            "1e8883acb1fd6cae"
        ],
        "x": 994,
        "y": 2119,
        "w": 762,
        "h": 142
    },
    {
        "id": "7f7a81c81fb18909",
        "type": "group",
        "z": "438d596005491859",
        "g": "f3a7b992615fd6e7",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "0623d3f2732f194c",
            "474ac194c8bbc512",
            "dc0d300ba5c12af3",
            "a0774d5b5c031c59"
        ],
        "x": 594,
        "y": 259,
        "w": 672,
        "h": 142
    },
    {
        "id": "c99ee48a54796f90",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "07d92834eb8e47f5",
            "598f2008fafaa0f4",
            "fc5e972c26387247",
            "c966bb323b7cb3b5"
        ],
        "x": 1614,
        "y": 319,
        "w": 672,
        "h": 142
    },
    {
        "id": "lights_group",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "func_lights",
            "asyncapi_lights",
            "debug_lights",
            "750e70a11320f07b"
        ],
        "x": 1614,
        "y": 539,
        "w": 712,
        "h": 142
    },
    {
        "id": "fridge_group",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "func_fridge",
            "asyncapi_fridge",
            "debug_fridge",
            "047e02ede737fd4b"
        ],
        "x": 1614,
        "y": 759,
        "w": 752,
        "h": 162
    },
    {
        "id": "launder_group",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "asyncapi_launder",
            "debug_launder",
            "func_laundry_telemetry",
            "7acf5abf8245e211"
        ],
        "x": 1614,
        "y": 999,
        "w": 732,
        "h": 162
    },
    {
        "id": "dehumidifier_group",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "func_dehumidifier",
            "asyncapi_dehumidifier",
            "debug_dehumidifier",
            "f34984d5e6f1804a"
        ],
        "x": 1614,
        "y": 1259,
        "w": 832,
        "h": 142
    },
    {
        "id": "cooker_group",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "func_cooker",
            "asyncapi_cooker",
            "debug_cooker",
            "b8808b578daac992"
        ],
        "x": 1614,
        "y": 1479,
        "w": 832,
        "h": 142
    },
    {
        "id": "19609f77c4ba5897",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "1915adae0ac41c37",
            "dbd082096676a420",
            "f8959e1f024fcb3c",
            "c4d08d0f89251bfb"
        ],
        "x": 1614,
        "y": 119,
        "w": 772,
        "h": 142
    },
    {
        "id": "895c7c19f3f0551f",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "b52bab263572c522",
            "a7e703d573ec4166",
            "be13e5e3c979d9d4"
        ],
        "x": 714,
        "y": 479,
        "w": 712,
        "h": 102
    },
    {
        "id": "5a57beeed82dc92a",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c4556b999b1208b3",
            "8ec7e2a91468892d",
            "8fd588cc37f51938"
        ],
        "x": 714,
        "y": 679,
        "w": 712,
        "h": 82
    },
    {
        "id": "4afe9ba8425f8677",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "42d23aa09585e358",
            "7cafd92c117fdeb9",
            "f80ff6508ddb19de"
        ],
        "x": 714,
        "y": 879,
        "w": 752,
        "h": 82
    },
    {
        "id": "c22e79154c621f48",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "961faabd99242abd",
            "e35afa18d1e470d5",
            "262e6e90e095796a"
        ],
        "x": 734,
        "y": 1079,
        "w": 732,
        "h": 102
    },
    {
        "id": "f7cd6fc6dc26feb6",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "05dccd85d26e3e30",
            "bdc58d437bf02284",
            "46f0faaa609bbdbc"
        ],
        "x": 714,
        "y": 1279,
        "w": 832,
        "h": 102
    },
    {
        "id": "f5fdf02df3e4db07",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "628686b941d4090b",
            "013b60a3ce1b1613",
            "8c3c0e07bff92b9c"
        ],
        "x": 714,
        "y": 1479,
        "w": 752,
        "h": 82
    },
    {
        "id": "4ac7585640aa85e7",
        "type": "group",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "82413aa57e18a3ad",
            "19740f6dd834257d",
            "ab453755ab2ab8e2"
        ],
        "x": 714,
        "y": 259,
        "w": 892,
        "h": 102
    },
    {
        "id": "30df11e17a49e28b",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "9c27d852120b7dca",
            "d06e351e37ac7bb6",
            "1bc270fcb0f4a60e"
        ],
        "x": 994,
        "y": 499,
        "w": 712,
        "h": 102
    },
    {
        "id": "11d91ae28562cdca",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a77332e4e594898f",
            "7e3f0de7bd3f9c40",
            "fa9fa00ea88688f3"
        ],
        "x": 994,
        "y": 699,
        "w": 712,
        "h": 82
    },
    {
        "id": "3cd4dba2d47ed535",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "6fc0b7f5e8f6f9f9",
            "c56ca9ce7a363f13",
            "8de414979fd14e22"
        ],
        "x": 994,
        "y": 899,
        "w": 752,
        "h": 82
    },
    {
        "id": "e3185234fdbed879",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "80fd24d3cd148573",
            "db7b0582888824c4",
            "49af89a3f9808103"
        ],
        "x": 1014,
        "y": 1099,
        "w": 732,
        "h": 102
    },
    {
        "id": "37227888554b698a",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "792098efbd9ededb",
            "8fc22c9d5addaedc",
            "5e5d6d6a1e0281a5"
        ],
        "x": 994,
        "y": 1299,
        "w": 832,
        "h": 102
    },
    {
        "id": "12a36cdccd5ed9f8",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "f6d2febb9468a103",
            "99b158b91d7bbe1d",
            "f2a482331f276baa"
        ],
        "x": 994,
        "y": 1499,
        "w": 752,
        "h": 82
    },
    {
        "id": "7d5c52aa5ac682d2",
        "type": "group",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e0db9ffe797a141e",
            "788d9c42c03be73c",
            "8c75489cbd6fbf08"
        ],
        "x": 994,
        "y": 279,
        "w": 892,
        "h": 102
    },
    {
        "id": "3e5336b3c932e13c",
        "type": "group",
        "z": "438d596005491859",
        "g": "f3a7b992615fd6e7",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "1396224ee5de4b8d",
            "ac4c005192cf780a",
            "9e0c9391f9b4250a",
            "43333b017ce7e0ff"
        ],
        "x": 554,
        "y": 439,
        "w": 762,
        "h": 142
    },
    {
        "id": "881db607590cd279",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "5e636eef5daa1b5f",
            "ddf88dd27e263bd5",
            "0776bc1099a8818c",
            "91dad80f577e2b9f",
            "57eefc9f63239b74",
            "d19baf00cf51bded"
        ],
        "x": 374,
        "y": 99,
        "w": 932,
        "h": 212
    },
    {
        "id": "e2e99964236f8675",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "7b0894f417168af4",
            "a3255351da27c4c9",
            "f3aa31b745aa88b8",
            "43a4f2d07be30783",
            "58d6581bc5500dc9",
            "14fd1ecf6e17d3c3"
        ],
        "x": 354,
        "y": 1719,
        "w": 912,
        "h": 212
    },
    {
        "id": "6578bf7b191c43b7",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "577012c85e361b8b",
            "8084d0c60d963452",
            "f7310e18baa39bd1"
        ],
        "x": 534,
        "y": 699,
        "w": 612,
        "h": 142
    },
    {
        "id": "fe7c6d62782a61e9",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a3b4653f0cf6ae5d",
            "e94a1310f11d28ae",
            "c6af873c12f6835f",
            "7277ba557dca3273"
        ],
        "x": 1834,
        "y": 2119,
        "w": 812,
        "h": 142
    },
    {
        "id": "abefde1276346b1c",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4003081ec19ca6d6",
            "670d73bf79ea2a0d",
            "4deeabc6a75aae45",
            "7cb36fb185a2217e"
        ],
        "x": 154,
        "y": 2339,
        "w": 812,
        "h": 142
    },
    {
        "id": "0d443770ff71eb54",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "8fe7947781d8abaa",
            "e4d27f662a46cc39",
            "883f36bae22e7492",
            "5fcd41c00a481bb9"
        ],
        "x": 1074,
        "y": 2339,
        "w": 832,
        "h": 142
    },
    {
        "id": "9c58429dd67aded0",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "eed1f93db727e728",
            "638a5cf47e62722e",
            "8f8ef71dd8a15893",
            "e6fe9b42f4d79edf",
            "4434127a410944ad",
            "42a38b50701f7a16"
        ],
        "x": 354,
        "y": 899,
        "w": 912,
        "h": 212
    },
    {
        "id": "d72e67c06e6e6132",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "e6d51b72905c0448",
            "a7e74769d12738d5",
            "beea24a1850466d6",
            "a66a27203f3dea31",
            "4cc30fd54c279296",
            "df8beacd24a634c0"
        ],
        "x": 354,
        "y": 419,
        "w": 932,
        "h": 212
    },
    {
        "id": "2fd9a75bdb7f05d0",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "5567887ea0a363f7",
            "4bdcc2e5def36e60",
            "922e9857401b4999",
            "3bfda26157dbdd74"
        ],
        "x": 1974,
        "y": 2339,
        "w": 812,
        "h": 142
    },
    {
        "id": "45e26e30f704ad47",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "8a54f719f26ad8aa",
            "67c5da6c604320b8",
            "11e4fbb90c6f9d1a",
            "3474c5bf1ab29ecd",
            "f2a1daf9ebd965d6",
            "3c3f82bfebc2ba37"
        ],
        "x": 334,
        "y": 1139,
        "w": 912,
        "h": 212
    },
    {
        "id": "f47559f06abd3bf6",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "ef13bb4d03a55dae",
            "7c195bd85b16a570",
            "d37116182cd1018f",
            "6175e10e832537dd",
            "d2baa4f8658d3321"
        ],
        "x": 334,
        "y": 1439,
        "w": 912,
        "h": 202
    },
    {
        "id": "3176681a660261ae",
        "type": "group",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "3b274ef1ae8f85ee",
            "e742fb4a13f8f90e",
            "e7c13b2b64d3e56a"
        ],
        "x": 2634,
        "y": 1059,
        "w": 532,
        "h": 142
    },
    {
        "id": "35bdc95fd4cb9f93",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "f9977bae9b3b4e4c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "642bdcd7a497cdf6",
            "a4bf18d97f23db93",
            "e93baf4c775db1c8",
            "881d213998fa6ef6",
            "f58af42ff1414e91",
            "49fdf93c9cf5b077",
            "972914b7e4b5ae7b"
        ],
        "x": 508,
        "y": 4859,
        "w": 2684,
        "h": 488
    },
    {
        "id": "ddf6fcec6341cd57",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "f9977bae9b3b4e4c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a1e2ae6405173e77",
            "982b3547b8fb9afd",
            "3eaaf78597f01e4f",
            "5a84b0fe36b56f84",
            "d65619283ad53f59",
            "7f10d8530156d37a",
            "c83e83af9bfc71a9"
        ],
        "x": 508,
        "y": 5439,
        "w": 2684,
        "h": 488
    },
    {
        "id": "4cdaba113baf505c",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "f9977bae9b3b4e4c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "cfaf2d1ab4ed592e",
            "1a58d6157f9adf88",
            "705258e36df270ef",
            "808258ff93241f1c",
            "0be1f07c52dc1360",
            "b7be9ec65621baf7",
            "fbc690740f474539"
        ],
        "x": 3388,
        "y": 4859,
        "w": 2684,
        "h": 488
    },
    {
        "id": "3c9b727746d70288",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "f9977bae9b3b4e4c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "40bb858891246b0b",
            "08e3cc829ae88798",
            "e5c02bc1f2c77821",
            "5a86b945d935ae80",
            "a8cab455c13d5f12",
            "a2807e7892796e75",
            "cdaf6e3a19441667"
        ],
        "x": 3368,
        "y": 5459,
        "w": 2684,
        "h": 488
    },
    {
        "id": "35c69ea124d4d0e1",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "5c9a4c2cea348b1c",
            "b40c2ba16a9e0b97",
            "537c143553dbf431",
            "a3e425c9de103f33"
        ],
        "x": 2054,
        "y": 459,
        "w": 672,
        "h": 142
    },
    {
        "id": "eb32d2deafc74169",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c95c0493b1cf1564",
            "3adc24d8a0a778e0",
            "d9792bbed9e9637c",
            "c7d47440a9c4d1f0"
        ],
        "x": 2054,
        "y": 679,
        "w": 712,
        "h": 142
    },
    {
        "id": "f1b6a5525b0fd9d0",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a6a9daf27ee3ffec",
            "d91b91e8f5862d84",
            "ad2e9a97f7bbfb84",
            "03b6edb096f17e19"
        ],
        "x": 2054,
        "y": 899,
        "w": 752,
        "h": 162
    },
    {
        "id": "add8e9250cbeec27",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "180a9cb7fc690201",
            "2015e080f5172133",
            "92d40a75ccfec573",
            "45c8466203b752fa"
        ],
        "x": 2054,
        "y": 1139,
        "w": 732,
        "h": 162
    },
    {
        "id": "766e712ef6fc6ed8",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "f8643f33040aff1a",
            "d092ae53c0de247d",
            "fa6b8af412bfc71c",
            "1acac3b9836401a6"
        ],
        "x": 2054,
        "y": 1399,
        "w": 832,
        "h": 142
    },
    {
        "id": "2cc7b89db7db8ed8",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "77c16da5581cc176",
            "85fbb0fb9fc06d9d",
            "8bd9eb5e71a649da",
            "8f0eaecd1551e0eb"
        ],
        "x": 2054,
        "y": 1619,
        "w": 832,
        "h": 142
    },
    {
        "id": "13ffcd31cb74f7a5",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a299eab618e51d01",
            "f57f26837163c20f",
            "80b5856b8b44a209",
            "c508d61844094fd0"
        ],
        "x": 2054,
        "y": 259,
        "w": 772,
        "h": 142
    },
    {
        "id": "28937a91c747bf27",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "52ca2a0dfa6037cd",
            "f0231521a927886e",
            "d7fdef9ed5ae9dcc",
            "a42bc0a8398047ed",
            "ba651d29ec6ead77",
            "f9883bc397869284"
        ],
        "x": 814,
        "y": 239,
        "w": 932,
        "h": 212
    },
    {
        "id": "3b54f4b88201ae9f",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "e6d9f6fdd459b22a",
            "500117f04bce8a47",
            "fbe79471c0614fb4",
            "2e3aca0c108ecd82",
            "0493104c020576f0",
            "2b407dc7fe34c8b2"
        ],
        "x": 794,
        "y": 1859,
        "w": 912,
        "h": 212
    },
    {
        "id": "eab15c939712e89b",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "b1fa08026e078a18",
            "87cb19cfec07ba9a",
            "960ac81e8df06d55"
        ],
        "x": 974,
        "y": 839,
        "w": 612,
        "h": 142
    },
    {
        "id": "9881ad96b9bcf2b7",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "3d5921b2e8df14cc",
            "4cac8f143c853724",
            "209e103485d9c873",
            "74162f6d16b97849",
            "91bdb99f8c62d5c7",
            "cd33060a7b4578bb"
        ],
        "x": 794,
        "y": 1039,
        "w": 912,
        "h": 212
    },
    {
        "id": "95e834be6abfd0af",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "e9be5ab258103312",
            "f3c99bf9615369f6",
            "f8815c7583d75cb1",
            "9af1f16f7dea7e75",
            "fa2213ec132bd4e0",
            "696b0b010fbafce2"
        ],
        "x": 794,
        "y": 559,
        "w": 932,
        "h": 212
    },
    {
        "id": "849f455c90b8193e",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "49322c719098076f",
            "bff04f5fa84948f3",
            "1163ae440ff08857",
            "ccd4008bb9133664",
            "949eb1e7c251ce0e",
            "9828e7499122b338"
        ],
        "x": 774,
        "y": 1279,
        "w": 912,
        "h": 212
    },
    {
        "id": "36d214c8ee683881",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "220e1df26c776749",
            "0a9a43c67d298449",
            "c94794a0f94c1913",
            "214149b980a58a52",
            "481033abce76ccd5"
        ],
        "x": 774,
        "y": 1579,
        "w": 912,
        "h": 202
    },
    {
        "id": "f76e5e035e6a0475",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "17946e976372f036",
            "0575f3be4169e6d4",
            "343ceb6d448ae2cc"
        ],
        "x": 3074,
        "y": 1199,
        "w": 532,
        "h": 142
    },
    {
        "id": "2dd4501966039026",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "49711a16b33ceb4e",
            "4c331a7506ea7cc2",
            "71d453dc9f7ebbcb",
            "bd9db37aea1bbf6e"
        ],
        "x": 2054,
        "y": 2539,
        "w": 672,
        "h": 142
    },
    {
        "id": "1007ee2791e026f6",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "263589e71b03026a",
            "30204b977518c192",
            "928970bf36b05c09",
            "20bb8b0c688a7670"
        ],
        "x": 2054,
        "y": 2759,
        "w": 712,
        "h": 142
    },
    {
        "id": "7831a62e791b5d1d",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "f971ec1536c3f4e1",
            "f0afbd720a48a9cc",
            "8b0220606ede3813",
            "8b66f3ad3f9fad59"
        ],
        "x": 2054,
        "y": 2979,
        "w": 752,
        "h": 162
    },
    {
        "id": "a93877d13c210358",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e0aac8f85b7b7ada",
            "d79a487c0d7ef393",
            "87d8ed2bf9066f21",
            "cf286c112be3eb71"
        ],
        "x": 2054,
        "y": 3219,
        "w": 732,
        "h": 162
    },
    {
        "id": "5a107c630ab6ea2a",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "209ccda251fb314c",
            "92912e7f835ed2d8",
            "61581de9796c6e68",
            "0ea4b576160ebf66"
        ],
        "x": 2054,
        "y": 3479,
        "w": 832,
        "h": 142
    },
    {
        "id": "5fa6601368fe9e2c",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "86ecb8527df80e86",
            "b2fec3d8cb269771",
            "4781f74daf9b3bd1",
            "af817b2fdf746df6"
        ],
        "x": 2054,
        "y": 3699,
        "w": 832,
        "h": 142
    },
    {
        "id": "fec5dcecdaa3c889",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "ede8203690c3314a",
            "c685fa992e3f171a",
            "dda7f9b5e09aca38",
            "810e7649f79c53ac"
        ],
        "x": 2054,
        "y": 2339,
        "w": 772,
        "h": 142
    },
    {
        "id": "428180dd82e49c18",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "67e2072ce47be7a8",
            "b26e1204c81ac63c",
            "1ec8895889219d92",
            "1771c02e28b323ba",
            "26577696b63f7a81",
            "928de0acefcabb73"
        ],
        "x": 814,
        "y": 2319,
        "w": 932,
        "h": 212
    },
    {
        "id": "d50ad12694f17cd1",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "422cf5e5672cd744",
            "51ab2ba2188305b1",
            "aafd72bb516d01b2",
            "2311ab5e8cf7acf7",
            "373596c9ee98004b",
            "5af9e7e4f35cfd49"
        ],
        "x": 794,
        "y": 3939,
        "w": 912,
        "h": 212
    },
    {
        "id": "b9ea0c25f0b04076",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "3704fa590849c948",
            "b7d4d6d21f2d3633",
            "c89090cf29151f45"
        ],
        "x": 974,
        "y": 2919,
        "w": 612,
        "h": 142
    },
    {
        "id": "73f3eb149c908946",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "0f4f337023a45302",
            "8e4f89117a68860f",
            "492d7616d6f85075",
            "90851a370f06ae7c",
            "f243cec0fdf22df0",
            "5a7e0f5bc59a79f6"
        ],
        "x": 794,
        "y": 3119,
        "w": 912,
        "h": 212
    },
    {
        "id": "b65cd0c520e407f4",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "e3483d2becdf5de6",
            "d69454f7552fc63e",
            "c174acf839525902",
            "c84ce72905bcc4dc",
            "297092b1e2293f49",
            "95432ccfc5c65052"
        ],
        "x": 794,
        "y": 2639,
        "w": 932,
        "h": 212
    },
    {
        "id": "28b4c86d1a067d3b",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "4b1c838931c1b16e",
            "18e7484779e7db75",
            "3c6113922443086e",
            "1677a84585c739cd",
            "3601a3c55527ada6",
            "64779bcc785bea09"
        ],
        "x": 774,
        "y": 3359,
        "w": 912,
        "h": 212
    },
    {
        "id": "6fb2c52901fa6564",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "538f64e46b18b2cf",
            "e55b8c61fff5f9d2",
            "df38fe4d3db0b544",
            "161afa0aab30006e",
            "ea7a8a798a314876"
        ],
        "x": 774,
        "y": 3659,
        "w": 912,
        "h": 202
    },
    {
        "id": "dd1077e8cd7a0f41",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "78727073430e6654",
            "b33bdafa4acf33f0",
            "83b4dcdd05607602"
        ],
        "x": 3074,
        "y": 3279,
        "w": 532,
        "h": 142
    },
    {
        "id": "be056a72e9275c15",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4f73941073be689a",
            "dae0c498e0736ef0",
            "36e744d456a0e955",
            "b2b73bfd3a727288"
        ],
        "x": 5914,
        "y": 459,
        "w": 672,
        "h": 142
    },
    {
        "id": "3fb223172ed07613",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "fcb20853039afb06",
            "c506cb9fdbd315c0",
            "c70fc12d39c4efc7",
            "682fcf14a6ae490e"
        ],
        "x": 5914,
        "y": 679,
        "w": 712,
        "h": 142
    },
    {
        "id": "e3d80939c7253d94",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d6229089f43403c5",
            "156a7e5e3bd529de",
            "a5ac1e8cbfb91a9a",
            "3b7c4af51a783630"
        ],
        "x": 5914,
        "y": 899,
        "w": 752,
        "h": 162
    },
    {
        "id": "aae6bf515142caa9",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a4fc2573a28ef76a",
            "a048623cd06f2e38",
            "f26375516505b82f",
            "e098b7eba34255a8"
        ],
        "x": 5914,
        "y": 1139,
        "w": 732,
        "h": 162
    },
    {
        "id": "8a08412bbf9f11a0",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "91734d7fb3aa6d33",
            "231b1ccb76880334",
            "a8adbd77b3a00cbc",
            "8dbd13d9a8b8a91c"
        ],
        "x": 5914,
        "y": 1399,
        "w": 832,
        "h": 142
    },
    {
        "id": "e6db06e9dcfcc16d",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "f3b1d4be95deac6f",
            "0d381f2e4d645fa1",
            "65602439d6a37035",
            "87d7ba53f5d7f466"
        ],
        "x": 5914,
        "y": 1619,
        "w": 832,
        "h": 142
    },
    {
        "id": "dfefcb553a63afda",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c78fe1590a256aef",
            "8ef77f992f883d4b",
            "01acf8c4306f1c99",
            "90e49ef027cfac89"
        ],
        "x": 5914,
        "y": 259,
        "w": 772,
        "h": 142
    },
    {
        "id": "9b1896d497f9ecb4",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "14bba24040d29845",
            "665a75501870567d",
            "c35948e46e2ee075",
            "af801dbd2796e767",
            "8b2763acd1d04bde",
            "5fd4c653e7ae7bc8"
        ],
        "x": 4674,
        "y": 239,
        "w": 932,
        "h": 212
    },
    {
        "id": "042892b32870381c",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "96457fe4615cdd80",
            "1ff1e823ddd61546",
            "db5067e6b47571b4",
            "90fb6bf0c347c7c3",
            "88bae9d88638aa93",
            "4d782da3786fedf9"
        ],
        "x": 4654,
        "y": 1859,
        "w": 912,
        "h": 212
    },
    {
        "id": "a12ae159f8cb4da2",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "386905f3b034dacf",
            "12408e7815a3888d",
            "a829aaff56842c56"
        ],
        "x": 4834,
        "y": 839,
        "w": 612,
        "h": 142
    },
    {
        "id": "9977b3406dec1a0a",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "129f87b50ac43168",
            "90f81d4103b0fb08",
            "7f2390bbf67fd161",
            "5424d92c20fe97aa",
            "1926e50ad77a4e7f",
            "1dca671babce81b3"
        ],
        "x": 4654,
        "y": 1039,
        "w": 912,
        "h": 212
    },
    {
        "id": "c45d7f2673c9633a",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "c32b85c113f66e59",
            "41aecbcae0c8167a",
            "b237b47e91c6e6bd",
            "4718f5db45ffeec2",
            "454bc96d7f652be3",
            "510e274d5690b428"
        ],
        "x": 4654,
        "y": 559,
        "w": 932,
        "h": 212
    },
    {
        "id": "0c808411f05c1ea6",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "14015576079c66b1",
            "61303bf79d8aa7fd",
            "5dbf4ea61e01a2f8",
            "e53c4a76ace25844",
            "13bb5a423f014606",
            "11747bc89babe05c"
        ],
        "x": 4634,
        "y": 1279,
        "w": 912,
        "h": 212
    },
    {
        "id": "421452f3a4703c8e",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e748ae4d00d9d870",
            "17d18fe4136d511c",
            "aa0f049af23273a0",
            "a99d8953d79ecfad",
            "6b4487e8d3d02732"
        ],
        "x": 4634,
        "y": 1579,
        "w": 912,
        "h": 202
    },
    {
        "id": "43e9cdc67bd872b9",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2cf65e113c2b4a7b",
            "ac82794adfa37acc",
            "b389bcd9c3b36626"
        ],
        "x": 6934,
        "y": 1199,
        "w": 532,
        "h": 142
    },
    {
        "id": "916e0cc111af8d8b",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "07c1d2a55222992e",
            "b1999fa9dcfcd989",
            "5a440a8c68ad0010",
            "b83c9fc65863257f"
        ],
        "x": 5874,
        "y": 2779,
        "w": 672,
        "h": 142
    },
    {
        "id": "b647d0210ac8b2db",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "6436ee0649f1e4a5",
            "732692525fc05f58",
            "ee91f8cb140a5675",
            "7c0f155687cb104e"
        ],
        "x": 5874,
        "y": 2999,
        "w": 712,
        "h": 142
    },
    {
        "id": "72c6c9f087ddb6ec",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "130b1881150a300d",
            "83d4f6b673ca3c70",
            "9553a07e0712330f",
            "6ba095eefd51829f"
        ],
        "x": 5874,
        "y": 3219,
        "w": 752,
        "h": 162
    },
    {
        "id": "6950d3876bef51db",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c507d6daf4ca49a3",
            "80858ceb9dc58940",
            "f12856963450124f",
            "347fe92e7f29c6cd"
        ],
        "x": 5874,
        "y": 3459,
        "w": 732,
        "h": 162
    },
    {
        "id": "4cd08abf60f35b98",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d7e52f146c39a21d",
            "885cd4eed1d3e4fd",
            "559a6eaac8bfcb75",
            "e1f573577c5bec87"
        ],
        "x": 5874,
        "y": 3719,
        "w": 832,
        "h": 142
    },
    {
        "id": "48cc597ddf9d2a0b",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "aa270da6fd47e4bd",
            "8965dc7c7248c5a0",
            "9e4e3e37ea5512ca",
            "32f4bbef28dc26e0"
        ],
        "x": 5874,
        "y": 3939,
        "w": 832,
        "h": 142
    },
    {
        "id": "282ec275aee5bf61",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "9a7ea0f9330c5cf4",
            "cdc18a7d203d7802",
            "7ba787bbf05f5458",
            "03b62af0414a3c74"
        ],
        "x": 5874,
        "y": 2579,
        "w": 772,
        "h": 142
    },
    {
        "id": "daee0bc99036aa55",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "a0eb03e744b33bb5",
            "4ed676d7759d01d1",
            "66c27091763d575e",
            "314fa057984054c1",
            "9f1c292a383d7bb9",
            "952de4397df0c7ae"
        ],
        "x": 4634,
        "y": 2559,
        "w": 932,
        "h": 212
    },
    {
        "id": "75a075f042f21639",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "de9e631df19e29bd",
            "1aeb278cb949a180",
            "38a46258995cfee1",
            "8ac546d28dccce4d",
            "111a4730411174b2",
            "c44afb35658cb1ce"
        ],
        "x": 4614,
        "y": 4179,
        "w": 912,
        "h": 212
    },
    {
        "id": "2726468caef530d8",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "80c71fda039ddbda",
            "7a33a172ad66fec5",
            "7ad1eec5c580b00c"
        ],
        "x": 4794,
        "y": 3159,
        "w": 612,
        "h": 142
    },
    {
        "id": "1ba2b0626374db8a",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "8405f5d4af553c08",
            "7ff5edef9a11a224",
            "62648ca35a019951",
            "b42a0dd3998c1b01",
            "9675c36195775bb2",
            "db9b60bc8cb02cc7"
        ],
        "x": 4614,
        "y": 3359,
        "w": 912,
        "h": 212
    },
    {
        "id": "41caf86cf1e205e8",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "a9a17073d5a6ae7c",
            "235847ca7d977ddd",
            "4625ab24835db11a",
            "56fd5f5da3b182f5",
            "8a7e7c1acd4a2dd6",
            "077e4669553aa7f6"
        ],
        "x": 4614,
        "y": 2879,
        "w": 932,
        "h": 212
    },
    {
        "id": "9974167b54831097",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Smart Plug ",
        "style": {
            "label": true
        },
        "nodes": [
            "09f15728336619d1",
            "3ccbdf1f9e4ea311",
            "8750e519a3ef0d6a",
            "ba0d7edcb566d101",
            "cd3f6327d30fc1e3",
            "94b3ddc23c7d9424"
        ],
        "x": 4594,
        "y": 3599,
        "w": 912,
        "h": 212
    },
    {
        "id": "80b1a2a950fbf3a4",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "83d7f80b3f0d5327",
            "b902d9f53cac3f5f",
            "2fa067bacabd514b",
            "53a696aa61a0d001",
            "ea84a8a798be8b05"
        ],
        "x": 4594,
        "y": 3899,
        "w": 912,
        "h": 202
    },
    {
        "id": "532eae8f62ba2e88",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "397c310be0bc4b4a",
            "785066598243c053",
            "3926588e6002571b"
        ],
        "x": 6894,
        "y": 3519,
        "w": 532,
        "h": 142
    },
    {
        "id": "642bdcd7a497cdf6",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "6a4174cd4b9e3acb",
            "52829c313e4494f1",
            "995c44c3cc87eb9c",
            "bb63a520e48386da"
        ],
        "x": 1374,
        "y": 4959,
        "w": 762,
        "h": 142
    },
    {
        "id": "a4bf18d97f23db93",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "fc4dbad09b9ab186",
            "4f3d3a453eef62f1",
            "867de9d19386c3f9",
            "098373f7db0a30ef"
        ],
        "x": 534,
        "y": 4959,
        "w": 762,
        "h": 142
    },
    {
        "id": "e93baf4c775db1c8",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e3c9caf99f3947a0",
            "87ce893e6476a95e",
            "474a35aba342067e",
            "454f1f35f73e1353"
        ],
        "x": 2214,
        "y": 4959,
        "w": 812,
        "h": 142
    },
    {
        "id": "f58af42ff1414e91",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "98dcddedcff92b22",
            "0679ed655a5bd1e9",
            "61621021cebab314",
            "f47c238c6fad3dc5"
        ],
        "x": 534,
        "y": 5179,
        "w": 812,
        "h": 142
    },
    {
        "id": "49fdf93c9cf5b077",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4762d134b369c283",
            "bdc3df59db8e772c",
            "4a312499b3618828",
            "d3aa7a99a762cc0b"
        ],
        "x": 1454,
        "y": 5179,
        "w": 832,
        "h": 142
    },
    {
        "id": "972914b7e4b5ae7b",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "42edc2bd9a812b11",
            "dd16030f7650e7bf",
            "50a6020a172ed08e",
            "d04493879af518db"
        ],
        "x": 2354,
        "y": 5179,
        "w": 812,
        "h": 142
    },
    {
        "id": "a1e2ae6405173e77",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4ec3b84d91efdfa1",
            "44b4f3eeb0fd8991",
            "2830d15e6f0b06d6",
            "c5eda7a957571c47"
        ],
        "x": 1374,
        "y": 5539,
        "w": 762,
        "h": 142
    },
    {
        "id": "982b3547b8fb9afd",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "cfdbe07da53dc764",
            "a3485a49b709aa57",
            "1620537b0c6c0be3",
            "6939265e9d8c682b"
        ],
        "x": 534,
        "y": 5539,
        "w": 762,
        "h": 142
    },
    {
        "id": "3eaaf78597f01e4f",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c83af6cadf64cac9",
            "64a2c3904b37e282",
            "44841ee7fcec441a",
            "909650fa993b1869"
        ],
        "x": 2214,
        "y": 5539,
        "w": 812,
        "h": 142
    },
    {
        "id": "d65619283ad53f59",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "eedddda6a3d17944",
            "6301a181be35c4c9",
            "5a5a9ce3040d8699",
            "8e95f35d0436ea16"
        ],
        "x": 534,
        "y": 5759,
        "w": 812,
        "h": 142
    },
    {
        "id": "7f10d8530156d37a",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "1cedb53bb0354879",
            "d043fc5627a0780a",
            "0f04c3723b67d042",
            "a8d84f78ea0b6cf9"
        ],
        "x": 1454,
        "y": 5759,
        "w": 832,
        "h": 142
    },
    {
        "id": "c83e83af9bfc71a9",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "09d5f9fb24bb348a",
            "49c8235493e7fbd5",
            "75e0402921d75ea7",
            "c7afb14084bd80fc"
        ],
        "x": 2354,
        "y": 5759,
        "w": 812,
        "h": 142
    },
    {
        "id": "cfaf2d1ab4ed592e",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "17f218a897f77e4f",
            "161fcdeaf77184c0",
            "84e40799bf763f92",
            "bee54f67d03b6608"
        ],
        "x": 4254,
        "y": 4959,
        "w": 762,
        "h": 142
    },
    {
        "id": "1a58d6157f9adf88",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "759f6cb9d8bb72ba",
            "95a488b5be5cf27e",
            "5acc1b766c0cc841",
            "a668221ade4bdf96"
        ],
        "x": 3414,
        "y": 4959,
        "w": 762,
        "h": 142
    },
    {
        "id": "705258e36df270ef",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "1a76f2b4cf89eb44",
            "9ad1f6496323450b",
            "6de2d25bb2efdf97",
            "0f43654b38248f93"
        ],
        "x": 5094,
        "y": 4959,
        "w": 812,
        "h": 142
    },
    {
        "id": "0be1f07c52dc1360",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2b9e58857ebc7959",
            "5f85b37753537a41",
            "1f27fef1b7b6ef25",
            "2c471b1c7ac53748"
        ],
        "x": 3414,
        "y": 5179,
        "w": 812,
        "h": 142
    },
    {
        "id": "b7be9ec65621baf7",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "8e1aefb81c508c7c",
            "e7d95675e409bdea",
            "0dbcde175aafd49e",
            "7a9f05c84e0ab90d"
        ],
        "x": 4334,
        "y": 5179,
        "w": 832,
        "h": 142
    },
    {
        "id": "fbc690740f474539",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "cb0aee241e435de7",
            "a366c37c17aa525f",
            "3408f95de3559d99",
            "b2a3a37ff77ff2e2"
        ],
        "x": 5234,
        "y": 5179,
        "w": 812,
        "h": 142
    },
    {
        "id": "40bb858891246b0b",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "93052a3c407a8c1a",
            "077b712be3471530",
            "492c428ea3853a0b",
            "95a31e17647f25d6"
        ],
        "x": 4234,
        "y": 5559,
        "w": 762,
        "h": 142
    },
    {
        "id": "08e3cc829ae88798",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "6fb920fa5977b541",
            "8e9e6d3883076acb",
            "585f5f73ceb7251f",
            "f5bd8a41702acc12"
        ],
        "x": 3394,
        "y": 5559,
        "w": 762,
        "h": 142
    },
    {
        "id": "e5c02bc1f2c77821",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "0712e81e13a0e86f",
            "2f9d4e3236742937",
            "e9290239fee4f7ae",
            "d5de36b14ab7d47e"
        ],
        "x": 5074,
        "y": 5559,
        "w": 812,
        "h": 142
    },
    {
        "id": "a8cab455c13d5f12",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "227a6a9e6b8a1df1",
            "2598a7ed9ff7e1b8",
            "47f9a99caa49d461",
            "d1513398d607369e"
        ],
        "x": 3394,
        "y": 5779,
        "w": 812,
        "h": 142
    },
    {
        "id": "a2807e7892796e75",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "5a0d7892cba76fdd",
            "a64cacd9f63cef3c",
            "4ac58ffe08d4cc7c",
            "3238b39247b1385a"
        ],
        "x": 4314,
        "y": 5779,
        "w": 832,
        "h": 142
    },
    {
        "id": "cdaf6e3a19441667",
        "type": "group",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "f106ef98e4c6237c",
            "28eef0dd6c1a6686",
            "bb7f0ce563a224b4",
            "23bd70206db5b309"
        ],
        "x": 5214,
        "y": 5779,
        "w": 812,
        "h": 142
    },
    {
        "id": "4fc15b76b4d55d7d",
        "type": "openApi-red-url",
        "name": "petstore openApi (v3)",
        "url": "https://petstore3.swagger.io/api/v3/openapi.json",
        "urlType": "str",
        "server": "https://petstore3.swagger.io/api/v3",
        "serverType": "server",
        "devMode": false,
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "4e8e4d5957412be2",
        "type": "openApi-red-url",
        "name": "petstore swagger (v2)",
        "url": "https://petstore.swagger.io/v2/swagger.json",
        "urlType": "str",
        "server": "",
        "serverType": "custom",
        "devMode": false,
        "headers": [
            {
                "key": "HUND",
                "valueType": "str",
                "value": "Katze"
            },
            {
                "key": "Bearer",
                "valueType": "str",
                "value": ""
            }
        ],
        "_version": "2.1.3"
    },
    {
        "id": "ebcd5e7d922cbc68",
        "type": "openApi-red-url",
        "name": "",
        "url": "openapi.json",
        "urlType": "Files",
        "server": "http://172.16.1.1:5002/AirCondition_actuator",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "3551e0fac838662f",
        "type": "openApi-red-url",
        "name": "",
        "url": "openapi.json",
        "urlType": "Files",
        "server": "http://172.16.1.1:8080/AirCondition_actuator",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "51fce998cf99ca3b",
        "type": "mqtt-broker",
        "name": "",
        "broker": "mqtt://172.17.0.1:1883/",
        "port": 1883,
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 60,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthRetain": "false",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closeRetain": "false",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willRetain": "false",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "mqtt-broker",
        "type": "mqtt-broker",
        "name": "Local MQTT",
        "broker": "localhost",
        "port": "1883",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": 15,
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthQos": "0",
        "willQos": "0"
    },
    {
        "id": "4f0d8a914be2cfb6",
        "type": "mqtt-broker",
        "name": "Local MQTT",
        "broker": "172.17.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true
    },
    {
        "id": "mqtt_local_broker",
        "type": "mqtt-broker",
        "name": "Local MQTT",
        "broker": "172.17.0.1",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "3ff102b65ec67eb7",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "83c770877dc34b82",
        "type": "ui_tab",
        "name": "Smarthome+",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "8c896da163d208f1",
        "type": "ui_group",
        "name": "Default",
        "tab": "83c770877dc34b82",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "878fdd13b31382f1",
        "type": "ui_tab",
        "name": "Smarthome+",
        "icon": "dashboard",
        "order": 1
    },
    {
        "id": "50ee364d11f0bce8",
        "type": "ui_group",
        "name": "Default",
        "tab": "878fdd13b31382f1",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false
    },
    {
        "id": "dc836ed8a4522e30",
        "type": "ui_group",
        "name": "AC Device",
        "tab": "83c770877dc34b82",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "env_tab",
        "type": "ui_tab",
        "name": "Environment",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "env_group",
        "type": "ui_group",
        "name": "Room",
        "tab": "env_tab",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ui_tab_dashboard",
        "type": "ui_tab",
        "name": "SmartHome+",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ui_group_neighborhood",
        "type": "ui_group",
        "name": "Neighborhood",
        "tab": "ui_tab_dashboard",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false
    },
    {
        "id": "6d55c70992ff39a9",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug.json.yaml",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "92fb21b02d9a57e6",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "742282c109ee77de",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug-cooker.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "6d897e1ac1cd195a",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug-laundry.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "f2d3a14b35277c31",
        "type": "openApi-red-url",
        "name": "",
        "url": "smartplugs.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "a33f75c91933dc08",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug-laundry.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "f63fb066d1c65936",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug-lights.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "360efb94946efef5",
        "type": "openApi-red-url",
        "name": "",
        "url": "",
        "urlType": "str",
        "server": "",
        "serverType": "custom",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "d7b4d9ce6378ec33",
        "type": "openApi-red-url",
        "name": "",
        "url": "smart-plug-ac.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "6056ff2b1cf95f99",
        "type": "openApi-red-url",
        "name": "",
        "url": "dehimidifier-smart-plug.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "8e4f42e423d53fbb",
        "type": "openApi-red-url",
        "g": "4aafd0fb6b684f3d",
        "name": "",
        "url": "dehimidifier-smart-plug.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "7b3a2e9531bb364e",
        "type": "openApi-red-url",
        "name": "",
        "url": "dehimidifier-smart-plug.json",
        "urlType": "Files",
        "server": "http://localhost:1880",
        "serverType": "server",
        "devMode": "",
        "headers": [],
        "_version": "2.1.3"
    },
    {
        "id": "2c2826fa3fc78558",
        "type": "inject",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Inject Current Temp",
        "props": [],
        "repeat": "300",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 300,
        "y": 180,
        "wires": [
            [
                "f5b57f8f9931df1d"
            ]
        ]
    },
    {
        "id": "f034a42a7690f2b6",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Compare and Decide",
        "func": "const desired = flow.get('desired_temp') || 22;\nconst current = msg.payload.current;\nlet state = \"IDLE\";\nif (current < desired - 1) state = \"HEATING\";\nelse if (current > desired + 1) state = \"COOLING\";\nmsg.payload = { temperature: desired, unit: \"C\", current, state };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 140,
        "wires": [
            [
                "386c2541306d379c"
            ]
        ]
    },
    {
        "id": "5d88956b6c0935c0",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Status Display",
        "label": "Thermostat Status",
        "format": "{{msg.payload.state}} | Current: {{msg.payload.current}}C | Target: {{msg.payload.temperature}}C",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1370,
        "y": 240,
        "wires": []
    },
    {
        "id": "386c2541306d379c",
        "type": "async-api-red",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Send to Thermostat Device",
        "x": 1050,
        "y": 180,
        "wires": [
            [
                "c9dd5b14b31c8ac4",
                "5d88956b6c0935c0"
            ]
        ]
    },
    {
        "id": "c9dd5b14b31c8ac4",
        "type": "debug",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Debug Output",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 160,
        "wires": []
    },
    {
        "id": "80a07121563fc510",
        "type": "comment",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Thermostat simulation",
        "info": "",
        "x": 260,
        "y": 60,
        "wires": []
    },
    {
        "id": "5838340eeabc7fc3",
        "type": "ui_slider",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Desired Temp",
        "label": "Set Desired Temp",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": 15,
        "max": 30,
        "step": 1,
        "className": "",
        "x": 280,
        "y": 260,
        "wires": [
            [
                "a9a704cd8fe91875"
            ]
        ]
    },
    {
        "id": "a9a704cd8fe91875",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Store Desired Temp",
        "func": "flow.set('desired_temp', msg.payload);\nreturn null;",
        "outputs": 1,
        "x": 510,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "f5b57f8f9931df1d",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Generate Current Temp",
        "func": "msg.payload = { current: Math.floor(15 + Math.random() * 15) };\nreturn msg;",
        "outputs": 1,
        "x": 530,
        "y": 180,
        "wires": [
            [
                "f034a42a7690f2b6",
                "da3a80e17247daa5"
            ]
        ]
    },
    {
        "id": "da3a80e17247daa5",
        "type": "ui_gauge",
        "z": "043c9b21da5cbba8",
        "g": "9d8fc96b503dd8a9",
        "name": "Current Temp",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Current Temperature",
        "label": "C",
        "format": "{{msg.payload.current}}",
        "min": "10",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 770,
        "y": 240,
        "wires": []
    },
    {
        "id": "4f9b9aad403a7716",
        "type": "comment",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "AC simulation",
        "info": "",
        "x": 230,
        "y": 400,
        "wires": []
    },
    {
        "id": "37bc8c54b51e0544",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Check AC State",
        "func": "const currentTemp = msg.payload.temperature;\nconst desiredTemp = flow.get(\"desired_temp\") || 24;\nmsg.payload = {\n    temperature: currentTemp,\n    desired: desiredTemp,\n    unit: 'C',\n    state: currentTemp > desiredTemp ? \"ON\" : \"OFF\"\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 440,
        "wires": [
            [
                "238dc90f83e202b5",
                "9cc41c71b7e8e277"
            ]
        ]
    },
    {
        "id": "238dc90f83e202b5",
        "type": "async-api-red",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "AC Controller Node",
        "x": 1080,
        "y": 440,
        "wires": [
            [
                "47a8e2a4a04033b2",
                "19c76ec98c6c6f9e",
                "58cc42a80fabb538"
            ]
        ]
    },
    {
        "id": "47a8e2a4a04033b2",
        "type": "debug",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Debug AC Output",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1410,
        "y": 400,
        "wires": []
    },
    {
        "id": "19c76ec98c6c6f9e",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "AC State",
        "label": "AC State",
        "format": "AC is {{msg.payload.state}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1440,
        "y": 480,
        "wires": []
    },
    {
        "id": "d91d138267780e70",
        "type": "ui_slider",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Desired Temp",
        "label": "Set Desired Temp",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": 15,
        "max": 30,
        "step": 1,
        "className": "",
        "x": 340,
        "y": 520,
        "wires": [
            [
                "871fbf285c97ad32"
            ]
        ]
    },
    {
        "id": "871fbf285c97ad32",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Store Desired Temp",
        "func": "flow.set('desired_temp', msg.payload);\nreturn null;",
        "outputs": 1,
        "x": 610,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "58cc42a80fabb538",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Track Energy",
        "func": "// Constants\nconst power_kW = 1.5; // Power usage of the AC in kW\n\n// Get previous state and timestamp\nconst prevState = flow.get(\"ac_last_state\") || \"OFF\";\nconst lastChange = flow.get(\"ac_last_change\") || Date.now();\nconst energy = flow.get(\"energy_consumed\") || 0;\n\nconst now = Date.now();\nlet newEnergy = energy;\n\nif (prevState === \"ON\" && msg.payload.state === \"OFF\") {\n    const durationHrs = (now - lastChange) / (1000 * 60 * 60);\n    newEnergy += durationHrs * power_kW;\n    flow.set(\"energy_consumed\", newEnergy);\n}\n\n// Update flow context\nflow.set(\"ac_last_state\", msg.payload.state);\nflow.set(\"ac_last_change\", now);\n\nmsg.energy = newEnergy.toFixed(3);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1230,
        "y": 520,
        "wires": [
            [
                "428fababd41468e5"
            ]
        ]
    },
    {
        "id": "428fababd41468e5",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Energy Display",
        "label": "Total Energy (kWh)",
        "format": "{{msg.energy}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1440,
        "y": 560,
        "wires": []
    },
    {
        "id": "a2be1e487fc29763",
        "type": "ui_button",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Reset Energy",
        "label": "Reset Energy",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 340,
        "y": 580,
        "wires": [
            [
                "d402ccc398ad8e11"
            ]
        ]
    },
    {
        "id": "d402ccc398ad8e11",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Reset Energy Values",
        "func": "flow.set(\"energy_consumed\", 0);\nflow.set(\"ac_last_change\", Date.now());\nreturn null;",
        "outputs": 0,
        "x": 610,
        "y": 580,
        "wires": []
    },
    {
        "id": "f80d0cef913ac3b6",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Generate Current Temp",
        "func": "msg.payload = { temperature: Math.floor(15 + Math.random() * 15) };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 440,
        "wires": [
            [
                "b7bddd515b8a9da3",
                "37bc8c54b51e0544"
            ]
        ]
    },
    {
        "id": "7dad711be4a117f7",
        "type": "inject",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Inject Current Temp",
        "props": [],
        "repeat": "5",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 340,
        "y": 440,
        "wires": [
            [
                "f80d0cef913ac3b6"
            ]
        ]
    },
    {
        "id": "b7bddd515b8a9da3",
        "type": "ui_gauge",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "Current Temp",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Current Temperature",
        "label": "C",
        "format": "{{msg.payload.temperature}}",
        "min": "10",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 830,
        "y": 500,
        "wires": []
    },
    {
        "id": "9cc41c71b7e8e277",
        "type": "debug",
        "z": "043c9b21da5cbba8",
        "g": "9d700ddc16539c15",
        "name": "input ac",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 960,
        "y": 380,
        "wires": []
    },
    {
        "id": "2611be0f7bfa29c3",
        "type": "inject",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Inject Random Brightness",
        "props": [],
        "repeat": "5",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 300,
        "y": 840,
        "wires": [
            [
                "641a94a8fde2acc3"
            ]
        ]
    },
    {
        "id": "641a94a8fde2acc3",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Generate Brightness",
        "func": "const brightness = Math.floor(Math.random() * 101);\nmsg.payload = { brightness };\nreturn msg;",
        "outputs": 1,
        "x": 560,
        "y": 780,
        "wires": [
            [
                "bc1ec909440f8c22",
                "bd9cca5d85c07dd4"
            ]
        ]
    },
    {
        "id": "bc1ec909440f8c22",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Check Brightness",
        "func": "const brightness = msg.payload.brightness;\nmsg.payload = {\n    state: brightness >= 80 ? \"on\" : \"off\",\n    brightness\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 780,
        "wires": [
            [
                "d543fbc9eaaeb755"
            ]
        ]
    },
    {
        "id": "bd9cca5d85c07dd4",
        "type": "ui_chart",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Brightness Chart",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Brightness Over Time",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Waiting...",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 750,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "60cd23ec6f422ac1",
        "type": "switch",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Light ON or OFF?",
        "property": "payload.state",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1270,
        "y": 720,
        "wires": [
            [
                "59f210ba6791d0a1"
            ],
            [
                "9f318a7151cc5d6d"
            ]
        ]
    },
    {
        "id": "59f210ba6791d0a1",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Count ON",
        "func": "let count = context.get('on') || 0;\ncount += 1;\ncontext.set('on', count);\nmsg.payload = count;\nreturn msg;",
        "outputs": 1,
        "x": 1560,
        "y": 700,
        "wires": [
            [
                "56bd1f17c275a653"
            ]
        ]
    },
    {
        "id": "9f318a7151cc5d6d",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Count OFF",
        "func": "let count = context.get('off') || 0;\ncount += 1;\ncontext.set('off', count);\nmsg.payload = count;\nreturn msg;",
        "outputs": 1,
        "x": 1560,
        "y": 740,
        "wires": [
            [
                "4077b1f7c25ba23c"
            ]
        ]
    },
    {
        "id": "56bd1f17c275a653",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "group": "",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "Times ON",
        "label": "Light ON Count",
        "format": "{{msg.payload}} times",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1780,
        "y": 700,
        "wires": []
    },
    {
        "id": "4077b1f7c25ba23c",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "group": "",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "Times OFF",
        "label": "Light OFF Count",
        "format": "{{msg.payload}} times",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1780,
        "y": 740,
        "wires": []
    },
    {
        "id": "d543fbc9eaaeb755",
        "type": "async-api-red",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Send to Light Device",
        "x": 1040,
        "y": 840,
        "wires": [
            [
                "60cd23ec6f422ac1",
                "326076c19834796f",
                "6cf09c18f6619610",
                "b73d117192e42809"
            ]
        ]
    },
    {
        "id": "326076c19834796f",
        "type": "ui_gauge",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "Brightness",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Brightness",
        "label": "%",
        "format": "{{msg.payload.brightness}}",
        "min": 0,
        "max": 100,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": 60,
        "seg2": 80,
        "diff": false,
        "className": "",
        "x": 1290,
        "y": 820,
        "wires": []
    },
    {
        "id": "6cf09c18f6619610",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Light State",
        "label": "Light State",
        "format": "{{msg.payload.state}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1290,
        "y": 920,
        "wires": []
    },
    {
        "id": "b73d117192e42809",
        "type": "debug",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 1000,
        "wires": []
    },
    {
        "id": "db70af4f273bfc97",
        "type": "comment",
        "z": "043c9b21da5cbba8",
        "g": "a2a5c6556a04c7ed",
        "name": "smartlights simulation",
        "info": "",
        "x": 260,
        "y": 700,
        "wires": []
    },
    {
        "id": "d9daa6e7df2953bb",
        "type": "ui_switch",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "name": "Door Lock Switch",
        "label": "Lock Door",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 3,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 250,
        "y": 1180,
        "wires": [
            [
                "a87e8394d9f25e8c"
            ]
        ]
    },
    {
        "id": "a87e8394d9f25e8c",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "name": "Format DoorLock Payload",
        "func": "msg.payload = { locked: msg.payload };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 1180,
        "wires": [
            [
                "fb30e09493d3f725"
            ]
        ]
    },
    {
        "id": "fb30e09493d3f725",
        "type": "async-api-red",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "name": "SmartDoor Lock ",
        "x": 760,
        "y": 1120,
        "wires": [
            [
                "b6b89773a30b7a33",
                "83982045fbc9296b"
            ]
        ]
    },
    {
        "id": "83982045fbc9296b",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "name": "Update Dashboard Status",
        "func": "msg.payload = msg.payload.locked ? \"Locked\" : \"Unlocked\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1070,
        "y": 1200,
        "wires": [
            [
                "0fb2875d235f6c99"
            ]
        ]
    },
    {
        "id": "0fb2875d235f6c99",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "group": "",
        "order": 2,
        "width": 3,
        "height": 1,
        "name": "Lock Status Text",
        "label": "Door Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1360,
        "y": 1200,
        "wires": []
    },
    {
        "id": "b6b89773a30b7a33",
        "type": "debug",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1180,
        "y": 1120,
        "wires": []
    },
    {
        "id": "f50a98b0aabb9eac",
        "type": "comment",
        "z": "043c9b21da5cbba8",
        "g": "e49647927e3b9d1e",
        "name": "Smartdoor",
        "info": "",
        "x": 220,
        "y": 1120,
        "wires": []
    },
    {
        "id": "efee14a4a88be124",
        "type": "comment",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "cofee machine simulator",
        "info": "",
        "x": 270,
        "y": 1340,
        "wires": []
    },
    {
        "id": "c12f4c5b3b6032a4",
        "type": "function",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "Format Coffee Payload",
        "func": "msg.payload = {\n  strength: msg.payload.strength,\n  size: msg.payload.size\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 810,
        "y": 1440,
        "wires": [
            [
                "a8097aa9ba390408"
            ]
        ]
    },
    {
        "id": "1855218a50989a4b",
        "type": "join",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "Join Strength & Size",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "useparts": true,
        "accumulate": false,
        "timeout": "",
        "count": "2",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 520,
        "y": 1440,
        "wires": [
            [
                "c12f4c5b3b6032a4"
            ]
        ]
    },
    {
        "id": "9b2e7830db9edc47",
        "type": "debug",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "Debug Coffee Payload",
        "active": true,
        "console": "false",
        "complete": "true",
        "x": 1260,
        "y": 1380,
        "wires": []
    },
    {
        "id": "a8097aa9ba390408",
        "type": "async-api-red",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "SmartDoor Lock ",
        "x": 1040,
        "y": 1440,
        "wires": [
            [
                "9b2e7830db9edc47",
                "9e910b904fa61a23"
            ]
        ]
    },
    {
        "id": "cd4279d372ca3068",
        "type": "ui_dropdown",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "Select Size",
        "label": "Coffee Size",
        "tooltip": "",
        "place": "",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "Small",
                "value": "small",
                "type": "str"
            },
            {
                "label": "Medium",
                "value": "medium",
                "type": "str"
            },
            {
                "label": "Large",
                "value": "large",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "size",
        "topicType": "str",
        "className": "",
        "x": 270,
        "y": 1480,
        "wires": [
            [
                "1855218a50989a4b"
            ]
        ]
    },
    {
        "id": "921bcc21c54deadc",
        "type": "ui_dropdown",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "name": "Select Strength",
        "label": "Coffee Strength",
        "tooltip": "",
        "place": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "Light",
                "value": "light",
                "type": "str"
            },
            {
                "label": "Medium",
                "value": "medium",
                "type": "str"
            },
            {
                "label": "Strong",
                "value": "strong",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "strength",
        "topicType": "str",
        "className": "",
        "x": 260,
        "y": 1420,
        "wires": [
            [
                "1855218a50989a4b"
            ]
        ]
    },
    {
        "id": "9e910b904fa61a23",
        "type": "ui_text",
        "z": "043c9b21da5cbba8",
        "g": "1a95f1f2d410aea3",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "Order Status",
        "label": "Coffee Order",
        "format": "{{msg.payload.strength}} / {{msg.payload.size}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1270,
        "y": 1460,
        "wires": []
    },
    {
        "id": "f1b4a93aa4e5e122",
        "type": "function",
        "z": "subflow-thermostat-logic",
        "name": "Compare Temps",
        "func": "const desired = msg.desired || 22;\nconst current = msg.payload.current;\nlet state = \"IDLE\";\n\nif (current < desired - 1) state = \"HEATING\";\nelse if (current > desired + 1) state = \"COOLING\";\n\nmsg.payload = {\n    current,\n    desired,\n    state\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "a9c603099da1e03f",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Total Energy Calculator",
        "func": "// Get previous total from flow or global context\nlet total = flow.get('energy.total') || 0;\n\n// Add new energy from this payload\nlet deviceEnergy = msg.payload.energyUsed || 0;\ntotal += deviceEnergy;\n\n// Round to 2 decimal places\ntotal = parseFloat(total.toFixed(2));\n\n// Save updated total\nflow.set('energy.total', total);\nglobal.set('energy.total', total); // optional\n\n// Prepare payload for ui_chart\nmsg.payload = {\n    series: [\"Total Energy\"],\n    data: [[total]],\n    labels: [new Date().toLocaleTimeString()]\n};\n\n// Also send total for debug node\nmsg.totalEnergy = `${total} KWh`;\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1990,
        "y": 980,
        "wires": [
            [
                "cda627aaa496a0a6"
            ]
        ]
    },
    {
        "id": "cda627aaa496a0a6",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Total Energy Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2230,
        "y": 920,
        "wires": []
    },
    {
        "id": "b52bab263572c522",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "895c7c19f3f0551f",
        "name": "AC Telemetry",
        "func": "// Environment values\nlet envTemp = parseFloat(msg.payload.temperature);\nlet envHumidity = msg.payload.humidity;\n\n// Random setpoint between 1630C\nlet setpoint = Math.floor(16 + Math.random() * (30 - 16 + 1));\n\n// Random drift\nlet current = envTemp;\ncurrent += (Math.random() * 1 - 0.5);\n\n// Determine AC mode\nlet mode = 'idle';\nlet fanSpeed = 'low';\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    fanSpeed = 'high';\n} else if (current < setpoint - 1) {\n    mode = 'fan';\n    fanSpeed = 'medium';\n}\n\n// Energy tracking\nlet energy = flow.get('energy.ac') || 0;\nconst acPower = 1200;  // W\nconst fanPower = 100;  // W\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale;  // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (mode === 'cool') {\n    energy += wattToKwh(acPower, tickDuration);\n} else if (mode === 'fan') {\n    energy += wattToKwh(fanPower, tickDuration);\n}\n\n// Save state\nflow.set('energy.ac', energy);\nflow.set('current_ac_temp', current);\n\n// Output telemetry\nmsg.payload = {\n    device: \"ac\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    fanSpeed: fanSpeed,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 520,
        "wires": [
            [
                "a7e703d573ec4166"
            ]
        ]
    },
    {
        "id": "a7e703d573ec4166",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "895c7c19f3f0551f",
        "name": "AC AsyncAPI",
        "x": 1070,
        "y": 520,
        "wires": [
            [
                "be13e5e3c979d9d4",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "be13e5e3c979d9d4",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "895c7c19f3f0551f",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1310,
        "y": 540,
        "wires": []
    },
    {
        "id": "c4556b999b1208b3",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "5a57beeed82dc92a",
        "name": "Lights Telemetry",
        "func": "// Get environment info\nlet envTemp = parseFloat(msg.payload.temperature);\nlet envHumidity = msg.payload.humidity;\nlet envLight = msg.payload.lightIntensity;\n\n// Threshold for turning on lights (0-100)\nconst lightThreshold = 30;\n\n// Determine light state based on room intensity\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// Random brightness if ON, otherwise 0\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50-100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// Energy tracking\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0;\nenergy += (power / 1000) * (tickSeconds / 3600);\nenergy = parseFloat(energy.toFixed(3));\nflow.set('energy.light', energy);\n\n// Telemetry output\nmsg.payload = {\n    state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: energy,\n    voltage: 230,\n    power: parseFloat(power.toFixed(2)),\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 720,
        "wires": [
            [
                "8ec7e2a91468892d"
            ]
        ]
    },
    {
        "id": "8ec7e2a91468892d",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "5a57beeed82dc92a",
        "name": "Lights AsyncAPI",
        "x": 1080,
        "y": 720,
        "wires": [
            [
                "8fd588cc37f51938",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "8fd588cc37f51938",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "5a57beeed82dc92a",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1310,
        "y": 720,
        "wires": []
    },
    {
        "id": "42d23aa09585e358",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "4afe9ba8425f8677",
        "name": "Fridge Telemetry",
        "func": "// === Fridge Telemetry Simulation ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;    // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") || fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") || freezerSet + (Math.random() * 2 - 1);\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);\nfreezerTemp += (Math.random() * 0.6 - 0.3);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// Compressor state logic\nlet compressor = \"OFF\";\nif (fridgeTemp > fridgeSet + 1 || freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3 * scale;   // cooling effect scales\n    freezerTemp -= 0.5 * scale;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nconst compressorPower = 150; // W typical fridge draw\nconst idlePower = 5;         // W electronics/LEDs\n\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\n\nif (compressor === \"ON\") {\n    energy += wattToKwh(compressorPower, tickSeconds);\n} else {\n    energy += wattToKwh(idlePower, tickSeconds);\n}\n\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// Telemetry payload\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 920,
        "wires": [
            [
                "7cafd92c117fdeb9"
            ]
        ]
    },
    {
        "id": "7cafd92c117fdeb9",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "4afe9ba8425f8677",
        "name": "Fridge AsyncAPI",
        "x": 1080,
        "y": 920,
        "wires": [
            [
                "f80ff6508ddb19de",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "f80ff6508ddb19de",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "4afe9ba8425f8677",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1340,
        "y": 920,
        "wires": []
    },
    {
        "id": "961faabd99242abd",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "c22e79154c621f48",
        "name": "Launder AsyncAPI",
        "x": 1070,
        "y": 1120,
        "wires": [
            [
                "e35afa18d1e470d5",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "e35afa18d1e470d5",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "c22e79154c621f48",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1340,
        "y": 1140,
        "wires": []
    },
    {
        "id": "262e6e90e095796a",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "c22e79154c621f48",
        "name": "Laundry Telemetry",
        "func": "// --- Washing machine telemetry simulator ---\n\n// Persist cycle state across ticks\nlet cyclePhase = flow.get('laundry.phase') || \"idle\";\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || false;\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\n\n// Simulation scale\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 60 * scale; // scale time in seconds\n\n// Randomly decide if machine is turned on\nlet powerStates = [\"ON\", \"OFF\", \"STANDBY\"];\nlet power = powerStates[Math.floor(Math.random() * powerStates.length)];\n\n// If machine is ON and idle, start a new cycle sometimes\nif (power === \"ON\" && !running && Math.random() < 0.05) {\n    running = true;\n    const modes = [\"eco\", \"normal\", \"quick\", \"heavy\", \"delicate\", \"wool\", \"rinse\", \"spin\", \"dry\"];\n    let mode = modes[Math.floor(Math.random() * modes.length)];\n    flow.set('laundry.mode', mode);\n\n    // Random cycle length based on mode\n    let cycleLengths = {\n        eco: 120,\n        normal: 90,\n        quick: 30,\n        heavy: 150,\n        delicate: 60,\n        wool: 70,\n        rinse: 20,\n        spin: 15,\n        dry: 80\n    };\n    remainingTime = cycleLengths[mode];\n    cyclePhase = \"filling\";\n}\n\n// Progress cycle if running\nif (running && power === \"ON\") {\n    remainingTime = Math.max(0, remainingTime - 1 * scale); // scaled progression\n\n    // Phase progression\n    if (remainingTime <= 0) {\n        running = false;\n        cyclePhase = \"completed\";\n    } else if (remainingTime > 60) {\n        cyclePhase = \"washing\";\n    } else if (remainingTime > 30) {\n        cyclePhase = \"rinsing\";\n    } else if (remainingTime > 10) {\n        cyclePhase = \"spinning\";\n    } else {\n        cyclePhase = \"drying\";\n    }\n\n    // Energy & water usage simulation\n    let powerWatts = 0;\n    if (cyclePhase === \"washing\") powerWatts = 500;\n    if (cyclePhase === \"rinsing\") powerWatts = 300;\n    if (cyclePhase === \"spinning\") powerWatts = 800;\n    if (cyclePhase === \"drying\") powerWatts = 2000;\n\n    function wattToKwh(powerWatts, seconds) {\n        return (powerWatts / 1000) * (seconds / 3600);\n    }\n\n    energy += wattToKwh(powerWatts, tickSeconds);\n    if ([\"filling\", \"washing\", \"rinsing\"].includes(cyclePhase)) {\n        waterUsed += Math.random() * 0.5 * scale; // scale water usage\n    }\n}\n\n// Simulated values\nlet mode = flow.get('laundry.mode') || \"idle\";\nlet waterTemp = (cyclePhase === \"washing\") ? 40 + Math.random() * 20 : 25;\nlet spinSpeed = (cyclePhase === \"spinning\") ? 800 + Math.floor(Math.random() * 400) : 0;\nlet loadWeight = 5 + Math.random() * 3; // 5-8 kg load\n\n// Door status\nlet doorStatus = (running || cyclePhase === \"completed\") ? \"locked\" : (Math.random() < 0.8 ? \"closed\" : \"open\");\n\n// Save state\nflow.set('laundry.phase', cyclePhase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\n\n// Output payload\nmsg.payload = {\n    device: \"laundry\",\n    power,\n    running,\n    mode,\n    cyclePhase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)),\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 850,
        "y": 1120,
        "wires": [
            [
                "961faabd99242abd"
            ]
        ]
    },
    {
        "id": "05dccd85d26e3e30",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "f7cd6fc6dc26feb6",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1;\n\n// Random running state\nconst power = Math.random() > 0.5 ? \"ON\" : \"OFF\";\n\n// Modes and fan speeds\nconst modes = [\"auto\", \"manual\"];\nconst mode = modes[Math.floor(Math.random() * modes.length)];\n\nconst fanSpeeds = [\"low\", \"medium\", \"high\"];\nconst fanSpeed = power === \"ON\" ? fanSpeeds[Math.floor(Math.random() * fanSpeeds.length)] : \"low\";\n\n// Random humidity values\nconst environmentHumidity = 30 + Math.floor(Math.random() * 50); // current room humidity\nconst humidityRemoved = power === \"ON\" ? parseFloat((Math.random() * 5).toFixed(2)) : 0; // %RH removed\n\n// Tank level simulation\nconst tankLevel = Math.min(100, Math.max(0, (flow.get('dehumidifier.tankLevel') || 0) + (humidityRemoved / 2)));\nflow.set('dehumidifier.tankLevel', tankLevel);\n\n// Energy tracking\nlet energy = flow.get('energy.dehumidifier') || 0;\nconst powerWatts = 200; // average dehumidifier power\nconst tickSeconds = 60 * scale;\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (power === \"ON\") {\n    energy += wattToKwh(powerWatts, tickSeconds);\n}\n\nflow.set('energy.dehumidifier', energy);\n\n// Telemetry payload\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: power,\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    humidityRemoved: humidityRemoved,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    environmentHumidity: environmentHumidity\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 1340,
        "wires": [
            [
                "bdc58d437bf02284"
            ]
        ]
    },
    {
        "id": "bdc58d437bf02284",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "f7cd6fc6dc26feb6",
        "name": "Dehumidifier AsyncAPI",
        "x": 1090,
        "y": 1340,
        "wires": [
            [
                "46f0faaa609bbdbc",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "46f0faaa609bbdbc",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "f7cd6fc6dc26feb6",
        "name": "Dehumidifier Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1400,
        "y": 1320,
        "wires": []
    },
    {
        "id": "628686b941d4090b",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "f5fdf02df3e4db07",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1;\n\n// Random running state\nconst running = Math.random() > 0.5;\n\n// Cooking modes\nconst modes = ['idle','bake','grill','roast','steam'];\nconst mode = running ? modes[Math.floor(Math.random() * (modes.length - 1)) + 1] : 'idle';\n\n// Timer and temperature\nconst timer = running ? Math.floor(Math.random() * 60) : 0;          // minutes remaining\nconst currentTemp = running ? 100 + Math.floor(Math.random() * 150) : 25; // current oven temp\nconst setTemp = running ? currentTemp + Math.floor(Math.random() * 20) : 0; // target temp\n\n// Energy tracking\nlet energy = flow.get('energy.cooker') || 0;\nconst powerWatts = 1500; // average cooker power\nconst tickSeconds = 60 * scale;\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (running) {\n    energy += wattToKwh(powerWatts, tickSeconds);\n}\n\nflow.set('energy.cooker', energy);\n\n// Telemetry payload matching your schema\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    setTemp: setTemp,\n    currentTemp: currentTemp,\n    timer: timer,\n    energyUsed: parseFloat(energy.toFixed(3))\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 1520,
        "wires": [
            [
                "013b60a3ce1b1613"
            ]
        ]
    },
    {
        "id": "013b60a3ce1b1613",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "f5fdf02df3e4db07",
        "name": "Cooker AsyncAPI",
        "x": 1080,
        "y": 1520,
        "wires": [
            [
                "8c3c0e07bff92b9c",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "8c3c0e07bff92b9c",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "f5fdf02df3e4db07",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1340,
        "y": 1520,
        "wires": []
    },
    {
        "id": "82413aa57e18a3ad",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "4ac7585640aa85e7",
        "name": "Thermostat Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1470,
        "y": 300,
        "wires": []
    },
    {
        "id": "19740f6dd834257d",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "4ac7585640aa85e7",
        "name": "Thermostat Telemetry",
        "func": "// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature); // environment temperature\nlet envHumidity = msg.payload.humidity;\n\n// Desired temperature\nconst desired = 24;\n\n// Start at environment temperature\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() * 1 - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5; // heating effect\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5; // cooling effect\n}\n\n// Energy tracking\nlet energy = flow.get('energy.thermostat') || 0;\nconst heaterPower = 2000; // W\nconst acPower = 1200;     // W\n\n// Get simulation scale (default = 1)\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale;  // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (mode === 'heat') {\n    energy += wattToKwh(heaterPower, tickDuration);\n} else if (mode === 'cool') {\n    energy += wattToKwh(acPower, tickDuration);\n}\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// Output telemetry\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 320,
        "wires": [
            [
                "ab453755ab2ab8e2"
            ]
        ]
    },
    {
        "id": "ab453755ab2ab8e2",
        "type": "async-api-red",
        "z": "subflow_smarthome",
        "g": "4ac7585640aa85e7",
        "name": " Thermostat AsyncAPI",
        "x": 1180,
        "y": 320,
        "wires": [
            [
                "82413aa57e18a3ad",
                "a9c603099da1e03f",
                "120aa6a9def4bbc7"
            ]
        ]
    },
    {
        "id": "50ea0a25ce1a6cf2",
        "type": "comment",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "SMARTHOME",
        "info": "",
        "x": 140,
        "y": 140,
        "wires": []
    },
    {
        "id": "398f82e683f32eac",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\n// Only set once (if not already set)\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60);\n    // 1s = 1 minute\n    // change to 3600 for 1s = 1 hour\n}\n\n// --- Environment State ---\nconst desired = flow.get('desired_temp') || 22;\nlet current = flow.get('current_temp') || (desired + (Math.random() * 4 - 2));\n\n// Random drift\ncurrent += (Math.random() * 1 - 0.5);\n\n// Calculate humidity\nlet humidity = 40 + Math.floor(Math.random() * 20);\n\n// Simulate room light intensity (0 = dark, 100 = very bright)\nlet lightIntensity = Math.floor(Math.random() * 101);\n\n// Save globally for all devices\nflow.set('env.temperature', current);\nflow.set('env.humidity', humidity);\nflow.set('env.lightIntensity', lightIntensity);\nflow.set('current_temp', current);\n\n// Output payload\nmsg.payload = {\n    environment: true,\n    temperature: current.toFixed(1),\n    humidity: humidity,\n    lightIntensity: lightIntensity,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\") // include scale for visibility\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 640,
        "wires": [
            [
                "19740f6dd834257d",
                "b52bab263572c522",
                "c4556b999b1208b3",
                "42d23aa09585e358",
                "262e6e90e095796a",
                "05dccd85d26e3e30",
                "628686b941d4090b",
                "99bfcadd3a7ad7f7"
            ]
        ]
    },
    {
        "id": "e797385e830437c1",
        "type": "inject",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 150,
        "y": 680,
        "wires": [
            [
                "398f82e683f32eac"
            ]
        ]
    },
    {
        "id": "b286887c3781c24d",
        "type": "ui_template",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "group": "8c896da163d208f1",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<style>\n    html,\n    body,\n    .nr-dashboard-template {\n        height: 100%;\n        margin: 0;\n        padding: 0;\n    }\n\n    /* Remove huge stretching */\n    md-card {\n        min-height: auto;\n        min-width: auto;\n    }\n\n    /* Flexbox container for all cards */\n    .device-card-container {\n        display: flex;\n        flex-wrap: wrap;\n        /* wrap into rows */\n        gap: 15px;\n        /* space between cards */\n        padding: 10px;\n        justify-content: flex-start;\n        /* align left */\n        align-items: stretch;\n        /* equal height per row */\n    }\n\n    .device-card {\n        background-color: #f4f4f4;\n        border-radius: 10px;\n        padding: 15px;\n        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n        font-family: Arial, sans-serif;\n        box-sizing: border-box;\n        width: 20em;\n        /* fixed width per card */\n        min-height: 160px;\n        /* consistent height */\n        display: flex;\n        flex-direction: column;\n        justify-content: flex-start;\n    }\n\n    .device-card h3 {\n        margin-top: 0;\n        font-size: 1.1em;\n        margin-bottom: 10px;\n    }\n\n    .device-card p {\n        margin: 4px 0;\n        font-size: 0.9em;\n    }\n</style>\n\n<div class=\"device-card-container\">\n    <div class=\"device-card\" ng-repeat=\"(key, device) in msg.payload\"\n        ng-if=\"device.device && device.device !== 'Undefined'\">\n        <h3>{{ device.device }}</h3>\n        <p ng-if=\"device.temperature !== undefined\">Temp: {{ device.temperature }} C</p>\n        <p ng-if=\"device.humidity !== undefined\">Humidity: {{ device.humidity }}%</p>\n        <p ng-if=\"device.mode !== undefined\">Mode: {{ device.mode }}</p>\n        <p ng-if=\"device.fanSpeed !== undefined\">Fan: {{ device.fanSpeed }}</p>\n        <p ng-if=\"device.energyUsed !== undefined\">Energy: {{ device.energyUsed }}</p>\n    </div>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 2120,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "120aa6a9def4bbc7",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Merge all device payloads",
        "func": "// Initialize merged payload in flow context if it doesn't exist\nlet merged = flow.get('mergedPayload') || {};\n\n// Use the device name from the incoming payload as the key\nmerged[msg.payload.device] = msg.payload;\n\n// Save updated merged payload back to flow context\nflow.set('mergedPayload', merged);\n\n// Optionally send the merged object as msg.payload to the UI template\nmsg.payload = merged;\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1970,
        "y": 600,
        "wires": [
            [
                "b286887c3781c24d",
                "2e6836af4c8a6447"
            ]
        ]
    },
    {
        "id": "2e6836af4c8a6447",
        "type": "debug",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Merged payloads",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2150,
        "y": 500,
        "wires": []
    },
    {
        "id": "99bfcadd3a7ad7f7",
        "type": "function",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Route Env Data",
        "func": "// Split Environment Generator data\nconst out = [];\n\nif (msg.payload.environment) {\n    out.push({ topic: \"temperature\", payload: Number(msg.payload.temperature) });\n    out.push({ topic: \"humidity\", payload: Number(msg.payload.humidity) });\n    out.push({ topic: \"light\", payload: Number(msg.payload.lightIntensity) });\n}\n\nreturn [out];",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 240,
        "y": 900,
        "wires": [
            [
                "2b7cb5b81308fd7d",
                "5392cb0f65e931be",
                "d57ddce80dd36ece",
                "b0adece6f42f3e45"
            ]
        ]
    },
    {
        "id": "2b7cb5b81308fd7d",
        "type": "ui_chart",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Temperature Chart",
        "group": "8c896da163d208f1",
        "order": 1,
        "width": "6",
        "height": 4,
        "label": "Temperature (C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Waiting for data...",
        "dot": false,
        "ymin": "15",
        "ymax": "35",
        "removeOlder": "1",
        "removeOlderPoints": "100",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#ff7f0e",
            "#1f77b4",
            "#2ca02c",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 490,
        "y": 840,
        "wires": [
            []
        ]
    },
    {
        "id": "5392cb0f65e931be",
        "type": "ui_gauge",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Temperature Gauge",
        "group": "env_group",
        "order": 2,
        "width": 6,
        "height": 4,
        "gtype": "gage",
        "title": "Temperature",
        "label": "C",
        "format": "{{value}}",
        "min": "0",
        "max": "40",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 500,
        "y": 900,
        "wires": []
    },
    {
        "id": "d57ddce80dd36ece",
        "type": "ui_gauge",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Humidity Gauge",
        "group": "env_group",
        "order": 3,
        "width": 6,
        "height": 4,
        "gtype": "gage",
        "title": "Humidity",
        "label": "%",
        "format": "{{value}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#00b5e9",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 500,
        "y": 960,
        "wires": []
    },
    {
        "id": "b0adece6f42f3e45",
        "type": "ui_slider",
        "z": "subflow_smarthome",
        "g": "e4a1e5e130e19d38",
        "name": "Light Intensity",
        "label": "Light Intensity",
        "group": "env_group",
        "order": 4,
        "width": 12,
        "height": 1,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": "0",
        "max": "100",
        "step": 1,
        "x": 490,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "c73637d98e05e80e",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Total Energy Calculator",
        "func": "// Get previous total from flow or global context\nlet total = flow.get('energy.total') || 0;\n\n// Add new energy from this payload\nlet deviceEnergy = msg.payload.energyUsed || 0;\ntotal += deviceEnergy;\n\n// Round to 2 decimal places\ntotal = parseFloat(total.toFixed(2));\n\n// Save updated total\nflow.set('energy.total', total);\nglobal.set('energy.total', total); // optional\n\n// Prepare payload for ui_chart\nmsg.payload = {\n    series: [\"Total Energy\"],\n    data: [[total]],\n    labels: [new Date().toLocaleTimeString()]\n};\n\n// Also send total for debug node\nmsg.totalEnergy = `${total} KWh`;\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2270,
        "y": 1000,
        "wires": [
            [
                "cbee460370ecb3f8"
            ]
        ]
    },
    {
        "id": "cbee460370ecb3f8",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Total Energy Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2510,
        "y": 940,
        "wires": []
    },
    {
        "id": "9c27d852120b7dca",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "30df11e17a49e28b",
        "name": "AC Telemetry",
        "func": "// Environment values\nlet envTemp = parseFloat(msg.payload.temperature);\nlet envHumidity = msg.payload.humidity;\n\n// Random setpoint between 1630C\nlet setpoint = Math.floor(16 + Math.random() * (30 - 16 + 1));\n\n// Random drift\nlet current = envTemp;\ncurrent += (Math.random() * 1 - 0.5);\n\n// Determine AC mode\nlet mode = 'idle';\nlet fanSpeed = 'low';\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    fanSpeed = 'high';\n} else if (current < setpoint - 1) {\n    mode = 'fan';\n    fanSpeed = 'medium';\n}\n\n// Energy tracking\nlet energy = flow.get('energy.ac') || 0;\nconst acPower = 1200;  // W\nconst fanPower = 100;  // W\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale;  // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (mode === 'cool') {\n    energy += wattToKwh(acPower, tickDuration);\n} else if (mode === 'fan') {\n    energy += wattToKwh(fanPower, tickDuration);\n}\n\n// Save state\nflow.set('energy.ac', energy);\nflow.set('current_ac_temp', current);\n\n// Output telemetry\nmsg.payload = {\n    device: \"ac\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    fanSpeed: fanSpeed,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1100,
        "y": 540,
        "wires": [
            [
                "d06e351e37ac7bb6"
            ]
        ]
    },
    {
        "id": "d06e351e37ac7bb6",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "30df11e17a49e28b",
        "name": "AC AsyncAPI",
        "x": 1350,
        "y": 540,
        "wires": [
            [
                "1bc270fcb0f4a60e",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "1bc270fcb0f4a60e",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "30df11e17a49e28b",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1590,
        "y": 560,
        "wires": []
    },
    {
        "id": "a77332e4e594898f",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "11d91ae28562cdca",
        "name": "Lights Telemetry",
        "func": "// Get environment info\nlet envTemp = parseFloat(msg.payload.temperature);\nlet envHumidity = msg.payload.humidity;\nlet envLight = msg.payload.lightIntensity;\n\n// Threshold for turning on lights (0-100)\nconst lightThreshold = 30;\n\n// Determine light state based on room intensity\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// Random brightness if ON, otherwise 0\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50-100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// Energy tracking\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0;\nenergy += (power / 1000) * (tickSeconds / 3600);\nenergy = parseFloat(energy.toFixed(3));\nflow.set('energy.light', energy);\n\n// Telemetry output\nmsg.payload = {\n    state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: energy,\n    voltage: 230,\n    power: parseFloat(power.toFixed(2)),\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1100,
        "y": 740,
        "wires": [
            [
                "7e3f0de7bd3f9c40"
            ]
        ]
    },
    {
        "id": "7e3f0de7bd3f9c40",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "11d91ae28562cdca",
        "name": "Lights AsyncAPI",
        "x": 1360,
        "y": 740,
        "wires": [
            [
                "fa9fa00ea88688f3",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "fa9fa00ea88688f3",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "11d91ae28562cdca",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1590,
        "y": 740,
        "wires": []
    },
    {
        "id": "6fc0b7f5e8f6f9f9",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "3cd4dba2d47ed535",
        "name": "Fridge Telemetry",
        "func": "// === Fridge Telemetry Simulation ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;    // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") || fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") || freezerSet + (Math.random() * 2 - 1);\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);\nfreezerTemp += (Math.random() * 0.6 - 0.3);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// Compressor state logic\nlet compressor = \"OFF\";\nif (fridgeTemp > fridgeSet + 1 || freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3 * scale;   // cooling effect scales\n    freezerTemp -= 0.5 * scale;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nconst compressorPower = 150; // W typical fridge draw\nconst idlePower = 5;         // W electronics/LEDs\n\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\n\nif (compressor === \"ON\") {\n    energy += wattToKwh(compressorPower, tickSeconds);\n} else {\n    energy += wattToKwh(idlePower, tickSeconds);\n}\n\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// Telemetry payload\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1110,
        "y": 940,
        "wires": [
            [
                "c56ca9ce7a363f13"
            ]
        ]
    },
    {
        "id": "c56ca9ce7a363f13",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "3cd4dba2d47ed535",
        "name": "Fridge AsyncAPI",
        "x": 1360,
        "y": 940,
        "wires": [
            [
                "8de414979fd14e22",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "8de414979fd14e22",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "3cd4dba2d47ed535",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1620,
        "y": 940,
        "wires": []
    },
    {
        "id": "80fd24d3cd148573",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "e3185234fdbed879",
        "name": "Launder AsyncAPI",
        "x": 1350,
        "y": 1140,
        "wires": [
            [
                "db7b0582888824c4",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "db7b0582888824c4",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "e3185234fdbed879",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1620,
        "y": 1160,
        "wires": []
    },
    {
        "id": "49af89a3f9808103",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "e3185234fdbed879",
        "name": "Laundry Telemetry",
        "func": "// --- Washing machine telemetry simulator ---\n\n// Persist cycle state across ticks\nlet cyclePhase = flow.get('laundry.phase') || \"idle\";\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || false;\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\n\n// Simulation scale\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 60 * scale; // scale time in seconds\n\n// Randomly decide if machine is turned on\nlet powerStates = [\"ON\", \"OFF\", \"STANDBY\"];\nlet power = powerStates[Math.floor(Math.random() * powerStates.length)];\n\n// If machine is ON and idle, start a new cycle sometimes\nif (power === \"ON\" && !running && Math.random() < 0.05) {\n    running = true;\n    const modes = [\"eco\", \"normal\", \"quick\", \"heavy\", \"delicate\", \"wool\", \"rinse\", \"spin\", \"dry\"];\n    let mode = modes[Math.floor(Math.random() * modes.length)];\n    flow.set('laundry.mode', mode);\n\n    // Random cycle length based on mode\n    let cycleLengths = {\n        eco: 120,\n        normal: 90,\n        quick: 30,\n        heavy: 150,\n        delicate: 60,\n        wool: 70,\n        rinse: 20,\n        spin: 15,\n        dry: 80\n    };\n    remainingTime = cycleLengths[mode];\n    cyclePhase = \"filling\";\n}\n\n// Progress cycle if running\nif (running && power === \"ON\") {\n    remainingTime = Math.max(0, remainingTime - 1 * scale); // scaled progression\n\n    // Phase progression\n    if (remainingTime <= 0) {\n        running = false;\n        cyclePhase = \"completed\";\n    } else if (remainingTime > 60) {\n        cyclePhase = \"washing\";\n    } else if (remainingTime > 30) {\n        cyclePhase = \"rinsing\";\n    } else if (remainingTime > 10) {\n        cyclePhase = \"spinning\";\n    } else {\n        cyclePhase = \"drying\";\n    }\n\n    // Energy & water usage simulation\n    let powerWatts = 0;\n    if (cyclePhase === \"washing\") powerWatts = 500;\n    if (cyclePhase === \"rinsing\") powerWatts = 300;\n    if (cyclePhase === \"spinning\") powerWatts = 800;\n    if (cyclePhase === \"drying\") powerWatts = 2000;\n\n    function wattToKwh(powerWatts, seconds) {\n        return (powerWatts / 1000) * (seconds / 3600);\n    }\n\n    energy += wattToKwh(powerWatts, tickSeconds);\n    if ([\"filling\", \"washing\", \"rinsing\"].includes(cyclePhase)) {\n        waterUsed += Math.random() * 0.5 * scale; // scale water usage\n    }\n}\n\n// Simulated values\nlet mode = flow.get('laundry.mode') || \"idle\";\nlet waterTemp = (cyclePhase === \"washing\") ? 40 + Math.random() * 20 : 25;\nlet spinSpeed = (cyclePhase === \"spinning\") ? 800 + Math.floor(Math.random() * 400) : 0;\nlet loadWeight = 5 + Math.random() * 3; // 5-8 kg load\n\n// Door status\nlet doorStatus = (running || cyclePhase === \"completed\") ? \"locked\" : (Math.random() < 0.8 ? \"closed\" : \"open\");\n\n// Save state\nflow.set('laundry.phase', cyclePhase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\n\n// Output payload\nmsg.payload = {\n    device: \"laundry\",\n    power,\n    running,\n    mode,\n    cyclePhase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)),\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1130,
        "y": 1140,
        "wires": [
            [
                "80fd24d3cd148573"
            ]
        ]
    },
    {
        "id": "792098efbd9ededb",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "37227888554b698a",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1;\n\n// Random running state\nconst power = Math.random() > 0.5 ? \"ON\" : \"OFF\";\n\n// Modes and fan speeds\nconst modes = [\"auto\", \"manual\"];\nconst mode = modes[Math.floor(Math.random() * modes.length)];\n\nconst fanSpeeds = [\"low\", \"medium\", \"high\"];\nconst fanSpeed = power === \"ON\" ? fanSpeeds[Math.floor(Math.random() * fanSpeeds.length)] : \"low\";\n\n// Random humidity values\nconst environmentHumidity = 30 + Math.floor(Math.random() * 50); // current room humidity\nconst humidityRemoved = power === \"ON\" ? parseFloat((Math.random() * 5).toFixed(2)) : 0; // %RH removed\n\n// Tank level simulation\nconst tankLevel = Math.min(100, Math.max(0, (flow.get('dehumidifier.tankLevel') || 0) + (humidityRemoved / 2)));\nflow.set('dehumidifier.tankLevel', tankLevel);\n\n// Energy tracking\nlet energy = flow.get('energy.dehumidifier') || 0;\nconst powerWatts = 200; // average dehumidifier power\nconst tickSeconds = 60 * scale;\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (power === \"ON\") {\n    energy += wattToKwh(powerWatts, tickSeconds);\n}\n\nflow.set('energy.dehumidifier', energy);\n\n// Telemetry payload\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: power,\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    humidityRemoved: humidityRemoved,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    environmentHumidity: environmentHumidity\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 1360,
        "wires": [
            [
                "8fc22c9d5addaedc"
            ]
        ]
    },
    {
        "id": "8fc22c9d5addaedc",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "37227888554b698a",
        "name": "Dehumidifier AsyncAPI",
        "x": 1370,
        "y": 1360,
        "wires": [
            [
                "5e5d6d6a1e0281a5",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "5e5d6d6a1e0281a5",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "37227888554b698a",
        "name": "Dehumidifier Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1680,
        "y": 1340,
        "wires": []
    },
    {
        "id": "f6d2febb9468a103",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "12a36cdccd5ed9f8",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1;\n\n// Random running state\nconst running = Math.random() > 0.5;\n\n// Cooking modes\nconst modes = ['idle','bake','grill','roast','steam'];\nconst mode = running ? modes[Math.floor(Math.random() * (modes.length - 1)) + 1] : 'idle';\n\n// Timer and temperature\nconst timer = running ? Math.floor(Math.random() * 60) : 0;          // minutes remaining\nconst currentTemp = running ? 100 + Math.floor(Math.random() * 150) : 25; // current oven temp\nconst setTemp = running ? currentTemp + Math.floor(Math.random() * 20) : 0; // target temp\n\n// Energy tracking\nlet energy = flow.get('energy.cooker') || 0;\nconst powerWatts = 1500; // average cooker power\nconst tickSeconds = 60 * scale;\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (running) {\n    energy += wattToKwh(powerWatts, tickSeconds);\n}\n\nflow.set('energy.cooker', energy);\n\n// Telemetry payload matching your schema\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    setTemp: setTemp,\n    currentTemp: currentTemp,\n    timer: timer,\n    energyUsed: parseFloat(energy.toFixed(3))\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1110,
        "y": 1540,
        "wires": [
            [
                "99b158b91d7bbe1d"
            ]
        ]
    },
    {
        "id": "99b158b91d7bbe1d",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "12a36cdccd5ed9f8",
        "name": "Cooker AsyncAPI",
        "x": 1360,
        "y": 1540,
        "wires": [
            [
                "f2a482331f276baa",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "f2a482331f276baa",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "12a36cdccd5ed9f8",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 1620,
        "y": 1540,
        "wires": []
    },
    {
        "id": "e0db9ffe797a141e",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "7d5c52aa5ac682d2",
        "name": "Thermostat Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1750,
        "y": 320,
        "wires": []
    },
    {
        "id": "788d9c42c03be73c",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "7d5c52aa5ac682d2",
        "name": "Thermostat Telemetry",
        "func": "// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature); // environment temperature\nlet envHumidity = msg.payload.humidity;\n\n// Desired temperature\nconst desired = 24;\n\n// Start at environment temperature\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() * 1 - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5; // heating effect\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5; // cooling effect\n}\n\n// Energy tracking\nlet energy = flow.get('energy.thermostat') || 0;\nconst heaterPower = 2000; // W\nconst acPower = 1200;     // W\n\n// Get simulation scale (default = 1)\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale;  // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\nif (mode === 'heat') {\n    energy += wattToKwh(heaterPower, tickDuration);\n} else if (mode === 'cool') {\n    energy += wattToKwh(acPower, tickDuration);\n}\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// Output telemetry\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 340,
        "wires": [
            [
                "8c75489cbd6fbf08"
            ]
        ]
    },
    {
        "id": "8c75489cbd6fbf08",
        "type": "async-api-red",
        "z": "7ecc82fdd5fcacdb",
        "g": "7d5c52aa5ac682d2",
        "name": " Thermostat AsyncAPI",
        "x": 1460,
        "y": 340,
        "wires": [
            [
                "e0db9ffe797a141e",
                "c73637d98e05e80e",
                "8a7ff196473cf82f"
            ]
        ]
    },
    {
        "id": "a81d83c8e5e451b8",
        "type": "comment",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "SMARTHOME",
        "info": "",
        "x": 420,
        "y": 160,
        "wires": []
    },
    {
        "id": "3c917e3eeb92eecf",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\n// Only set once (if not already set)\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60);\n    // 1s = 1 minute\n    // change to 3600 for 1s = 1 hour\n}\n\n// --- Environment State ---\nconst desired = flow.get('desired_temp') || 22;\nlet current = flow.get('current_temp') || (desired + (Math.random() * 4 - 2));\n\n// Random drift\ncurrent += (Math.random() * 1 - 0.5);\n\n// Calculate humidity\nlet humidity = 40 + Math.floor(Math.random() * 20);\n\n// Simulate room light intensity (0 = dark, 100 = very bright)\nlet lightIntensity = Math.floor(Math.random() * 101);\n\n// Save globally for all devices\nflow.set('env.temperature', current);\nflow.set('env.humidity', humidity);\nflow.set('env.lightIntensity', lightIntensity);\nflow.set('current_temp', current);\n\n// Output payload\nmsg.payload = {\n    environment: true,\n    temperature: current.toFixed(1),\n    humidity: humidity,\n    lightIntensity: lightIntensity,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\") // include scale for visibility\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 660,
        "wires": [
            [
                "788d9c42c03be73c",
                "9c27d852120b7dca",
                "a77332e4e594898f",
                "6fc0b7f5e8f6f9f9",
                "49af89a3f9808103",
                "792098efbd9ededb",
                "f6d2febb9468a103",
                "e5aad1750982bf58"
            ]
        ]
    },
    {
        "id": "a1714f7d84f7249a",
        "type": "inject",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 430,
        "y": 700,
        "wires": [
            [
                "3c917e3eeb92eecf"
            ]
        ]
    },
    {
        "id": "761fbf79bc5a0b6a",
        "type": "ui_template",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "group": "8c896da163d208f1",
        "name": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<style>\n    html,\n    body,\n    .nr-dashboard-template {\n        height: 100%;\n        margin: 0;\n        padding: 0;\n    }\n\n    /* Remove huge stretching */\n    md-card {\n        min-height: auto;\n        min-width: auto;\n    }\n\n    /* Flexbox container for all cards */\n    .device-card-container {\n        display: flex;\n        flex-wrap: wrap;\n        /* wrap into rows */\n        gap: 15px;\n        /* space between cards */\n        padding: 10px;\n        justify-content: flex-start;\n        /* align left */\n        align-items: stretch;\n        /* equal height per row */\n    }\n\n    .device-card {\n        background-color: #f4f4f4;\n        border-radius: 10px;\n        padding: 15px;\n        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n        font-family: Arial, sans-serif;\n        box-sizing: border-box;\n        width: 20em;\n        /* fixed width per card */\n        min-height: 160px;\n        /* consistent height */\n        display: flex;\n        flex-direction: column;\n        justify-content: flex-start;\n    }\n\n    .device-card h3 {\n        margin-top: 0;\n        font-size: 1.1em;\n        margin-bottom: 10px;\n    }\n\n    .device-card p {\n        margin: 4px 0;\n        font-size: 0.9em;\n    }\n</style>\n\n<div class=\"device-card-container\">\n    <div class=\"device-card\" ng-repeat=\"(key, device) in msg.payload\"\n        ng-if=\"device.device && device.device !== 'Undefined'\">\n        <h3>{{ device.device }}</h3>\n        <p ng-if=\"device.temperature !== undefined\">Temp: {{ device.temperature }} C</p>\n        <p ng-if=\"device.humidity !== undefined\">Humidity: {{ device.humidity }}%</p>\n        <p ng-if=\"device.mode !== undefined\">Mode: {{ device.mode }}</p>\n        <p ng-if=\"device.fanSpeed !== undefined\">Fan: {{ device.fanSpeed }}</p>\n        <p ng-if=\"device.energyUsed !== undefined\">Energy: {{ device.energyUsed }}</p>\n    </div>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 2400,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "8a7ff196473cf82f",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Merge all device payloads",
        "func": "// Initialize merged payload in flow context if it doesn't exist\nlet merged = flow.get('mergedPayload') || {};\n\n// Use the device name from the incoming payload as the key\nmerged[msg.payload.device] = msg.payload;\n\n// Save updated merged payload back to flow context\nflow.set('mergedPayload', merged);\n\n// Optionally send the merged object as msg.payload to the UI template\nmsg.payload = merged;\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2250,
        "y": 620,
        "wires": [
            [
                "761fbf79bc5a0b6a",
                "eee9708f5b5b3d60"
            ]
        ]
    },
    {
        "id": "eee9708f5b5b3d60",
        "type": "debug",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Merged payloads",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2430,
        "y": 520,
        "wires": []
    },
    {
        "id": "e5aad1750982bf58",
        "type": "function",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Route Env Data",
        "func": "// Split Environment Generator data\nconst out = [];\n\nif (msg.payload.environment) {\n    out.push({ topic: \"temperature\", payload: Number(msg.payload.temperature) });\n    out.push({ topic: \"humidity\", payload: Number(msg.payload.humidity) });\n    out.push({ topic: \"light\", payload: Number(msg.payload.lightIntensity) });\n}\n\nreturn [out];",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 920,
        "wires": [
            [
                "f8b4241ac415ab1f",
                "8ec75af908428eac",
                "3842878445c54be5",
                "db540a36c0cf8246"
            ]
        ]
    },
    {
        "id": "f8b4241ac415ab1f",
        "type": "ui_chart",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Temperature Chart",
        "group": "8c896da163d208f1",
        "order": 1,
        "width": "6",
        "height": 4,
        "label": "Temperature (C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Waiting for data...",
        "dot": false,
        "ymin": "15",
        "ymax": "35",
        "removeOlder": "1",
        "removeOlderPoints": "100",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#ff7f0e",
            "#1f77b4",
            "#2ca02c",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 770,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "8ec75af908428eac",
        "type": "ui_gauge",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Temperature Gauge",
        "group": "env_group",
        "order": 2,
        "width": 6,
        "height": 4,
        "gtype": "gage",
        "title": "Temperature",
        "label": "C",
        "format": "{{value}}",
        "min": "0",
        "max": "40",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 780,
        "y": 920,
        "wires": []
    },
    {
        "id": "3842878445c54be5",
        "type": "ui_gauge",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Humidity Gauge",
        "group": "env_group",
        "order": 3,
        "width": 6,
        "height": 4,
        "gtype": "gage",
        "title": "Humidity",
        "label": "%",
        "format": "{{value}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#00b5e9",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 780,
        "y": 980,
        "wires": []
    },
    {
        "id": "db540a36c0cf8246",
        "type": "ui_slider",
        "z": "7ecc82fdd5fcacdb",
        "g": "85b30d2997a48dee",
        "name": "Light Intensity",
        "label": "Light Intensity",
        "group": "env_group",
        "order": 4,
        "width": 12,
        "height": 1,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": "0",
        "max": "100",
        "step": 1,
        "x": 770,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "a683470f9f9d2be2",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "success",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 180,
        "wires": []
    },
    {
        "id": "fd241870fe8e402a",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "body body": {
                "name": "body",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "editor:body",
                "collapsed": false,
                "parameters": {
                    "id": {
                        "name": "id",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "msg",
                        "collapsed": false,
                        "value": "payload.body.id"
                    },
                    "category": {
                        "name": "category",
                        "activeFilter": "",
                        "type": "editor:Category",
                        "parameters": {
                            "id": {
                                "name": "id",
                                "activeFilter": ""
                            },
                            "name": {
                                "name": "name",
                                "activeFilter": ""
                            }
                        }
                    },
                    "name": {
                        "name": "name",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.body.name"
                    },
                    "photoUrls": {
                        "name": "photoUrls",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.body.photoUrls"
                    },
                    "tags": {
                        "name": "tags",
                        "activeFilter": ""
                    },
                    "status": {
                        "name": "status",
                        "activeFilter": ""
                    }
                },
                "in": "body"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            },
            {
                "code": "405",
                "text": "Invalid input"
            }
        ],
        "responseAsPayload": false,
        "debugMode": "",
        "headers": [
            {
                "key": "Affe",
                "valueType": "str",
                "value": "Elefant"
            }
        ],
        "_version": "2.2.0",
        "x": 360,
        "y": 200,
        "wires": [
            [
                "a683470f9f9d2be2"
            ],
            [
                "c8b83ed3e66303c2"
            ]
        ]
    },
    {
        "id": "bfb6d9bfe0c540fc",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1200,
        "y": 720,
        "wires": [
            [
                "3323c6018c67090b"
            ]
        ]
    },
    {
        "id": "743761d0ea53bc31",
        "type": "switch",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "check msg.response.ok",
        "property": "payload.ok",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1630,
        "y": 720,
        "wires": [
            [
                "7292a72a4b6230c9"
            ],
            [
                "d7f5f6ed015725be"
            ]
        ]
    },
    {
        "id": "7292a72a4b6230c9",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "ok",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1830,
        "y": 700,
        "wires": []
    },
    {
        "id": "d7f5f6ed015725be",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "error",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1830,
        "y": 740,
        "wires": []
    },
    {
        "id": "8708fbbaf99494f4",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "Standard",
        "info": "",
        "x": 1200,
        "y": 680,
        "wires": []
    },
    {
        "id": "eb7c8264bfd927b1",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1200,
        "y": 820,
        "wires": [
            [
                "7cdf47e943d3721a"
            ]
        ]
    },
    {
        "id": "fb837ec50d0e5ff5",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "ok",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1570,
        "y": 800,
        "wires": []
    },
    {
        "id": "e590371eec36462b",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "error",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1570,
        "y": 840,
        "wires": []
    },
    {
        "id": "b6a518cae0ed236e",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "Other output",
        "info": "",
        "x": 1210,
        "y": 780,
        "wires": []
    },
    {
        "id": "d148bc258eb112ca",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1200,
        "y": 940,
        "wires": [
            [
                "67e82cdae3014568"
            ]
        ]
    },
    {
        "id": "a8b3b1803a943f5d",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "ok",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1570,
        "y": 940,
        "wires": []
    },
    {
        "id": "2e21f69b42218552",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "Throw exception",
        "info": "",
        "x": 1220,
        "y": 900,
        "wires": []
    },
    {
        "id": "714e3635c401250f",
        "type": "catch",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "",
        "scope": [
            "67e82cdae3014568"
        ],
        "uncaught": false,
        "x": 1370,
        "y": 980,
        "wires": [
            [
                "f86103930fc1fd85"
            ]
        ]
    },
    {
        "id": "f86103930fc1fd85",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "error",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1570,
        "y": 980,
        "wires": []
    },
    {
        "id": "3323c6018c67090b",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "set an error",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "classic",
        "errorHandling": "default",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "source": ""
        },
        "parameters": {
            "body body": {
                "name": "body",
                "isActive": true,
                "required": true,
                "type": "json",
                "value": "{\"name\":\"bad cat\",\"photoUrls\":\"not an array\"}",
                "in": "body"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1390,
        "y": 720,
        "wires": [
            [
                "743761d0ea53bc31"
            ]
        ]
    },
    {
        "id": "60072a460f71141f",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "Classic error handling",
        "info": "",
        "x": 1240,
        "y": 620,
        "wires": []
    },
    {
        "id": "a88e075f0ee05109",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "pet shop swagger example",
        "info": "\n",
        "x": 210,
        "y": 160,
        "wires": []
    },
    {
        "id": "7cdf47e943d3721a",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "set an error",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "classic",
        "errorHandling": "other output",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "source": ""
        },
        "parameters": {
            "body body": {
                "name": "body",
                "isActive": true,
                "required": true,
                "type": "json",
                "value": "{\"name\":\"bad cat\",\"photoUrls\":\"Not an array\"}",
                "in": "body"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "all",
                "text": "all responses"
            },
            {
                "code": "undefinedResponses",
                "text": "all undefined responses"
            }
        ],
        "responseAsPayload": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1390,
        "y": 820,
        "wires": [
            [
                "fb837ec50d0e5ff5"
            ],
            [
                "e590371eec36462b"
            ]
        ]
    },
    {
        "id": "67e82cdae3014568",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "2785aa7402e0c422",
        "name": "set an error",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "classic",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "source": ""
        },
        "parameters": {
            "body body": {
                "name": "body",
                "isActive": true,
                "required": true,
                "type": "json",
                "value": "{\"name\": \"bad cat\", \"photoUrls\": \"Not an array\"  }",
                "in": "body"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "all",
                "text": "all responses"
            }
        ],
        "responseAsPayload": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1390,
        "y": 940,
        "wires": [
            [
                "a8b3b1803a943f5d"
            ]
        ]
    },
    {
        "id": "f13e6ce1a71fb95e",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add pet 66",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "test",
                "v": "hund",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 520,
        "wires": [
            [
                "d2c25c70ca021b0e"
            ]
        ]
    },
    {
        "id": "e5fe633619ed6e0a",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "success",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 500,
        "wires": []
    },
    {
        "id": "d2c25c70ca021b0e",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add pet",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "json",
                "value": "{\n    \"id\": \"66\",\n    \"name\": \"Krawallnudel Lilli\",\n    \"category\": {},\n    \"photoUrls\": [],\n    \"tags\": [],\n    \"status\": \"available\"\n}",
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 4,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Successful operation"
            },
            {
                "code": "400",
                "text": "Invalid input"
            },
            {
                "code": "422",
                "text": "Validation exception"
            },
            {
                "code": "default",
                "text": "Unexpected error"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [
            {
                "key": "abc",
                "valueType": "msg",
                "value": "test"
            }
        ],
        "_version": "2.2.0",
        "x": 360,
        "y": 520,
        "wires": [
            [
                "e5fe633619ed6e0a"
            ],
            [
                "4a87ce22e00f3efa"
            ],
            [],
            []
        ]
    },
    {
        "id": "d9b0d7fcf676d77f",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "pet shop openApi 3 example",
        "info": "",
        "x": 220,
        "y": 480,
        "wires": []
    },
    {
        "id": "ea87fde3734d5f09",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 1020,
        "wires": [
            [
                "21f13b66e154f470"
            ]
        ]
    },
    {
        "id": "4a34670d715fd56d",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "success",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 1000,
        "wires": []
    },
    {
        "id": "21f13b66e154f470",
        "type": "file in",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "",
        "filename": "./examples/dog.jpg",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 370,
        "y": 1020,
        "wires": [
            [
                "852ef3b902872cf8"
            ]
        ]
    },
    {
        "id": "852ef3b902872cf8",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "uploadFile",
            "hasOperationId": true,
            "path": "/pet/{petId}/uploadImage",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "other output",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "isActive": true,
                "activeFilter": "",
                "type": "msg",
                "value": "payload"
            },
            "petId path": {
                "name": "petId",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "num",
                "value": "66",
                "in": "path"
            },
            "additionalMetadata query": {
                "name": "additionalMetadata",
                "activeFilter": "",
                "type": "str",
                "value": "",
                "in": "query"
            }
        },
        "requestContentType": "application/octet-stream",
        "responseContentType": "application/json",
        "outputs": 5,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "successful operation"
            },
            {
                "code": "400",
                "text": "No file uploaded"
            },
            {
                "code": "404",
                "text": "Pet not found"
            },
            {
                "code": "default",
                "text": "Unexpected error"
            },
            {
                "code": "undefinedResponses",
                "text": "all undefined responses"
            }
        ],
        "responseAsPayload": true,
        "debugMode": "",
        "headers": [],
        "_version": "2.2.0",
        "x": 570,
        "y": 1020,
        "wires": [
            [
                "4a34670d715fd56d"
            ],
            [
                "fe01a9e33899abda"
            ],
            [],
            [],
            []
        ]
    },
    {
        "id": "6d87958f749b4d65",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "set a path to an existing file",
        "info": "",
        "x": 390,
        "y": 980,
        "wires": []
    },
    {
        "id": "c8b83ed3e66303c2",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 405",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 220,
        "wires": []
    },
    {
        "id": "fb0068a4371ff253",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "set payload",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ \"id\": 451,  \"name\": \"Benny Superstar\", \"photoUrl\": [] }",
        "payloadType": "json",
        "x": 1210,
        "y": 140,
        "wires": [
            [
                "9d2350b1eee037db"
            ]
        ]
    },
    {
        "id": "2810755f89def0ab",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 140,
        "wires": []
    },
    {
        "id": "9d2350b1eee037db",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "classic",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "body body": {
                "name": "body",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "editor:body",
                "collapsed": false,
                "parameters": {
                    "id": {
                        "name": "id",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "msg",
                        "value": "payload.id"
                    },
                    "category": {
                        "name": "category",
                        "activeFilter": "",
                        "type": "editor:Category",
                        "parameters": {
                            "id": {
                                "name": "id",
                                "activeFilter": "",
                                "type": "msg",
                                "value": "payload.category.id"
                            },
                            "name": {
                                "name": "name",
                                "activeFilter": "",
                                "type": "msg",
                                "value": "payload.category.name"
                            }
                        }
                    },
                    "name": {
                        "name": "name",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.name"
                    },
                    "photoUrls": {
                        "name": "photoUrls",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "json",
                        "value": "[]"
                    },
                    "tags": {
                        "name": "tags",
                        "activeFilter": "",
                        "type": "json",
                        "value": "true"
                    },
                    "status": {
                        "name": "status",
                        "activeFilter": "",
                        "type": "msg",
                        "value": "payload.status"
                    }
                },
                "in": "body"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "all",
                "text": "all responses"
            }
        ],
        "responseAsPayload": false,
        "debugMode": "",
        "headers": [],
        "_version": "2.2.0",
        "x": 1380,
        "y": 140,
        "wires": [
            [
                "2810755f89def0ab"
            ]
        ]
    },
    {
        "id": "75126d56d71e3c3c",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "pet shop swagger example (classic)",
        "info": "",
        "x": 1280,
        "y": 100,
        "wires": []
    },
    {
        "id": "facfb133068f19c4",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1200,
        "y": 360,
        "wires": [
            [
                "84f43a190c420cc0"
            ]
        ]
    },
    {
        "id": "cfb1e29cc9832121",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 360,
        "wires": []
    },
    {
        "id": "12d7924ce265af7b",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 1200,
        "y": 420,
        "wires": [
            [
                "11c835bfe0e324a3"
            ]
        ]
    },
    {
        "id": "8c42edd3ad8f483f",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 420,
        "wires": []
    },
    {
        "id": "11c835bfe0e324a3",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "getPetById",
            "hasOperationId": true,
            "path": "/pet/{petId}",
            "method": "get"
        },
        "outputStyle": "classic",
        "errorHandling": "default",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "source": ""
        },
        "parameters": {
            "petId path": {
                "name": "petId",
                "isActive": true,
                "required": true,
                "type": "num",
                "value": "47",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": "",
        "headers": [],
        "_version": "2.2.0",
        "x": 1390,
        "y": 420,
        "wires": [
            [
                "8c42edd3ad8f483f"
            ]
        ]
    },
    {
        "id": "84f43a190c420cc0",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "classic",
        "errorHandling": "default",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "type": "json",
                "value": "{\"id\":47,\"name\":\"Hildegard\",\"photoUrls\":[]}",
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": "",
        "headers": [],
        "_version": "2.2.0",
        "x": 1380,
        "y": 360,
        "wires": [
            [
                "cfb1e29cc9832121"
            ]
        ]
    },
    {
        "id": "9f53aae319aea21a",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "pet shop openApi 3 example (classic)",
        "info": "",
        "x": 1290,
        "y": 320,
        "wires": []
    },
    {
        "id": "e70c041c9abdaf24",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1200,
        "y": 500,
        "wires": [
            [
                "fae3ae2c4e4f2543"
            ]
        ]
    },
    {
        "id": "032cdf22b09cbf50",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1770,
        "y": 500,
        "wires": []
    },
    {
        "id": "fae3ae2c4e4f2543",
        "type": "file in",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "filename": "./examples/dog.jpg",
        "filenameType": "str",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 1410,
        "y": 500,
        "wires": [
            [
                "12e3afafe385aec5"
            ]
        ]
    },
    {
        "id": "12e3afafe385aec5",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "uploadFile",
            "hasOperationId": true,
            "path": "/pet/{petId}/uploadImage",
            "method": "post"
        },
        "outputStyle": "classic",
        "errorHandling": "default",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "isActive": true,
                "type": "msg",
                "value": "payload"
            },
            "petId path": {
                "name": "petId",
                "isActive": true,
                "required": true,
                "type": "num",
                "value": "66",
                "in": "path"
            },
            "additionalMetadata query": {
                "name": "additionalMetadata",
                "type": "str",
                "value": "",
                "in": "query"
            }
        },
        "requestContentType": "application/octet-stream",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": true,
        "headers": [],
        "_version": "2.2.0",
        "x": 1610,
        "y": 500,
        "wires": [
            [
                "032cdf22b09cbf50"
            ]
        ]
    },
    {
        "id": "14862242a91c03b1",
        "type": "comment",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "set a path to an existing file",
        "info": "",
        "x": 1430,
        "y": 460,
        "wires": []
    },
    {
        "id": "18797dbc244535cc",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1200,
        "y": 220,
        "wires": [
            [
                "7f3d299d1ec31a66"
            ]
        ]
    },
    {
        "id": "9810d92794505360",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 220,
        "wires": []
    },
    {
        "id": "7f3d299d1ec31a66",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "01c6034556accf3a",
        "name": "",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": false,
        "operationData": {
            "id": "getPetById",
            "hasOperationId": true,
            "path": "/pet/{petId}",
            "method": "get"
        },
        "outputStyle": "classic",
        "errorHandling": "default",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "petId path": {
                "name": "petId",
                "isActive": true,
                "required": true,
                "type": "num",
                "value": "451",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": true,
        "debugMode": "",
        "headers": [],
        "_version": "2.2.0",
        "x": 1390,
        "y": 220,
        "wires": [
            [
                "9810d92794505360"
            ]
        ]
    },
    {
        "id": "1b52e6c758aacb10",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "get pet 451",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "451",
        "payloadType": "num",
        "x": 160,
        "y": 320,
        "wires": [
            [
                "17b0e03a9286c258"
            ]
        ]
    },
    {
        "id": "54ce4caefeb8ba12",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 200",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 300,
        "wires": []
    },
    {
        "id": "c6e69660fab90ac4",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 404",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 380,
        "wires": []
    },
    {
        "id": "17b0e03a9286c258",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "",
        "configUrlNode": "4e8e4d5957412be2",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "getPetById",
            "hasOperationId": true,
            "path": "/pet/{petId}",
            "method": "get"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "petId path": {
                "name": "petId",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "collapsed": false,
                "value": "payload",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 3,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "successful operation"
            },
            {
                "code": "400",
                "text": "Invalid ID supplied"
            },
            {
                "code": "404",
                "text": "Pet not found"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [
            {
                "key": "Hund",
                "valueType": "str",
                "value": "katze"
            }
        ],
        "_version": "2.2.0",
        "x": 370,
        "y": 340,
        "wires": [
            [
                "54ce4caefeb8ba12"
            ],
            [
                "deee4299c301b4a8"
            ],
            [
                "c6e69660fab90ac4"
            ]
        ]
    },
    {
        "id": "deee4299c301b4a8",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 400",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 340,
        "wires": []
    },
    {
        "id": "5e6a3d87843af348",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "error 404",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 360,
        "wires": [
            [
                "17b0e03a9286c258"
            ]
        ]
    },
    {
        "id": "9571f83d9ff1cfb7",
        "type": "catch",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "catching all undefined responses",
        "scope": null,
        "uncaught": true,
        "x": 230,
        "y": 100,
        "wires": [
            [
                "a7a87e65a43ce895"
            ]
        ]
    },
    {
        "id": "a7a87e65a43ce895",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "error log",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 100,
        "wires": []
    },
    {
        "id": "4a87ce22e00f3efa",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 405",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 540,
        "wires": []
    },
    {
        "id": "16ff18397b551163",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "get pet 66",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "66",
        "payloadType": "num",
        "x": 160,
        "y": 780,
        "wires": [
            [
                "8045a1d812f80bfb"
            ]
        ]
    },
    {
        "id": "c2a567a74171bc92",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 200",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 820,
        "wires": []
    },
    {
        "id": "a2798a84ebf29821",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 404",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 900,
        "wires": []
    },
    {
        "id": "8045a1d812f80bfb",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "getPetById",
            "hasOperationId": true,
            "path": "/pet/{petId}",
            "method": "get"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "urlNotRead": false,
            "url": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "petId path": {
                "name": "petId",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 4,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "successful operation"
            },
            {
                "code": "400",
                "text": "Invalid ID supplied"
            },
            {
                "code": "404",
                "text": "Pet not found"
            },
            {
                "code": "default",
                "text": "Unexpected error"
            }
        ],
        "responseAsPayload": false,
        "debugMode": "",
        "headers": [],
        "_version": "2.2.0",
        "x": 370,
        "y": 860,
        "wires": [
            [
                "c2a567a74171bc92"
            ],
            [
                "3a9e9aaa25a5c025"
            ],
            [
                "a2798a84ebf29821"
            ],
            []
        ]
    },
    {
        "id": "3a9e9aaa25a5c025",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 400",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 860,
        "wires": []
    },
    {
        "id": "2acfae3a3b04e41f",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "error 400",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "\"10a\"",
        "payloadType": "str",
        "x": 160,
        "y": 900,
        "wires": [
            [
                "8045a1d812f80bfb"
            ]
        ]
    },
    {
        "id": "6d04430b35be0819",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "error 404",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 940,
        "wires": [
            [
                "8045a1d812f80bfb"
            ]
        ]
    },
    {
        "id": "fe01a9e33899abda",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "not defined response",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 780,
        "y": 1040,
        "wires": []
    },
    {
        "id": "5be937fe9b529fc1",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add pet 952",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 620,
        "wires": [
            [
                "1d205353151b266e"
            ]
        ]
    },
    {
        "id": "1d6d17c456d6e266",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "success",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 600,
        "wires": []
    },
    {
        "id": "1d205353151b266e",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add Pet by editor",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Pet",
                "parameters": {
                    "id": {
                        "name": "id",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "num",
                        "value": "952"
                    },
                    "name": {
                        "name": "name",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "str",
                        "value": "Mr. Whizzlecat"
                    },
                    "category": {
                        "name": "category",
                        "activeFilter": "",
                        "type": "editor:Category",
                        "parameters": {
                            "id": {
                                "name": "id",
                                "activeFilter": ""
                            },
                            "name": {
                                "name": "name",
                                "activeFilter": ""
                            }
                        }
                    },
                    "photoUrls": {
                        "name": "photoUrls",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "json",
                        "value": "[]"
                    },
                    "tags": {
                        "name": "tags",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "array",
                        "value": [
                            {
                                "name": 0,
                                "isActive": true,
                                "activeFilter": "",
                                "required": true,
                                "type": "editor:Tag",
                                "collapsed": false,
                                "value": "",
                                "parameters": {
                                    "id": {
                                        "name": "id",
                                        "isActive": true,
                                        "activeFilter": "",
                                        "required": false,
                                        "type": "num",
                                        "collapsed": true,
                                        "value": "123",
                                        "parameters": {},
                                        "msgPathString": "payload.tags[\"0\"].id"
                                    },
                                    "name": {
                                        "name": "name",
                                        "isActive": true,
                                        "activeFilter": "",
                                        "required": false,
                                        "type": "str",
                                        "collapsed": true,
                                        "value": "has a tag",
                                        "parameters": {},
                                        "msgPathString": "payload.tags[\"0\"].name"
                                    }
                                },
                                "msgPathString": "payload.tags[\"0\"]"
                            },
                            {
                                "name": 1,
                                "isActive": true,
                                "activeFilter": "",
                                "required": true,
                                "type": "editor:Tag",
                                "collapsed": false,
                                "value": "",
                                "parameters": {
                                    "id": {
                                        "name": "id",
                                        "isActive": true,
                                        "activeFilter": "",
                                        "required": false,
                                        "type": "num",
                                        "collapsed": true,
                                        "value": "124",
                                        "parameters": {},
                                        "msgPathString": "payload.tags[\"1\"].id"
                                    },
                                    "name": {
                                        "name": "name",
                                        "isActive": true,
                                        "activeFilter": "",
                                        "required": false,
                                        "type": "str",
                                        "collapsed": true,
                                        "value": "and even a second one",
                                        "parameters": {},
                                        "msgPathString": "payload.tags[\"1\"].name"
                                    }
                                },
                                "msgPathString": "payload.tags[\"1\"]"
                            }
                        ]
                    },
                    "status": {
                        "name": "status",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "select",
                        "value": "available"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Successful operation"
            },
            {
                "code": "405",
                "text": "Invalid input"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 390,
        "y": 620,
        "wires": [
            [
                "1d6d17c456d6e266"
            ],
            [
                "8d63e9e4de8cbe37"
            ]
        ]
    },
    {
        "id": "8d63e9e4de8cbe37",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 405",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 640,
        "wires": []
    },
    {
        "id": "f7e22af6d625591e",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "get pet 952",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "952",
        "payloadType": "num",
        "x": 160,
        "y": 820,
        "wires": [
            [
                "8045a1d812f80bfb"
            ]
        ]
    },
    {
        "id": "c897adafa788de00",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add pet 632",
        "props": [
            {
                "p": "id",
                "v": "632",
                "vt": "num"
            },
            {
                "p": "payload"
            },
            {
                "p": "urls",
                "v": "[\"http://www.myDog.de\",\"http://www.myDog.com\",\"http://www.myDog.at\",\"http://www.myDog.gov\"]",
                "vt": "json"
            },
            {
                "p": "isActive",
                "v": "true",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[{\"id\":13,\"nameX\":\"YEAH\"},{\"id\":15,\"nameX\":\"IT\"},{\"id\":1232,\"nameX\":\"WORKS\"}]",
        "payloadType": "json",
        "x": 170,
        "y": 720,
        "wires": [
            [
                "ad8ebbbf4fad2678"
            ]
        ]
    },
    {
        "id": "65110c919e408b85",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "success",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 700,
        "wires": []
    },
    {
        "id": "8a432c1017ac312e",
        "type": "debug",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "defined response 405",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 640,
        "y": 740,
        "wires": []
    },
    {
        "id": "d81d9db98b14b421",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "get pet 632",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "632",
        "payloadType": "num",
        "x": 160,
        "y": 860,
        "wires": [
            [
                "8045a1d812f80bfb"
            ]
        ]
    },
    {
        "id": "ad8ebbbf4fad2678",
        "type": "openApi-red",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add Pet by editor (has filter)",
        "configUrlNode": "4fc15b76b4d55d7d",
        "apiTag": "pet",
        "keepAuth": "",
        "operationData": {
            "id": "addPet",
            "hasOperationId": true,
            "path": "/pet",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "readUrl": false,
            "text": "",
            "url": false,
            "urlNotRead": false,
            "parameters": false,
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Pet",
                "parameters": {
                    "id": {
                        "name": "id",
                        "isActive": true,
                        "activeFilter": "{\n\treturn value === 632\n}",
                        "type": "msg",
                        "collapsed": false,
                        "value": "id"
                    },
                    "name": {
                        "name": "name",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "str",
                        "value": "Doggy Mc Dogface"
                    },
                    "category": {
                        "name": "category",
                        "activeFilter": "",
                        "type": "editor:Category",
                        "collapsed": false,
                        "parameters": {
                            "id": {
                                "name": "id",
                                "activeFilter": ""
                            },
                            "name": {
                                "name": "name",
                                "activeFilter": ""
                            }
                        }
                    },
                    "photoUrls": {
                        "name": "photoUrls",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "each",
                        "collapsed": false,
                        "value": [
                            {
                                "name": "0",
                                "isActive": true,
                                "activeFilter": "{\n\treturn url !== \"http://www.myDog.at\"\n}",
                                "required": true,
                                "type": "_each_url",
                                "collapsed": true,
                                "value": "",
                                "parameters": {},
                                "msgPathString": "payload.photoUrls[\"0\"]"
                            }
                        ],
                        "eachType": "msg",
                        "each": "urls",
                        "as": "url"
                    },
                    "tags": {
                        "name": "tags",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "each",
                        "collapsed": false,
                        "value": [
                            {
                                "name": 0,
                                "isActive": true,
                                "required": true,
                                "type": "editor:Tag",
                                "collapsed": false,
                                "value": "[{ \"id\": \"integer\", \"name\": \"string\" }]",
                                "parameters": {
                                    "id": {
                                        "name": "id",
                                        "isActive": true,
                                        "required": false,
                                        "type": "_each_tag",
                                        "collapsed": true,
                                        "value": ".id",
                                        "parameters": {},
                                        "msgPathString": "payload.tags[\"0\"].id",
                                        "activeFilter": "{\n\treturn tag.id !== 13\n}"
                                    },
                                    "name": {
                                        "name": "name",
                                        "isActive": true,
                                        "required": false,
                                        "type": "_each_tag",
                                        "collapsed": true,
                                        "value": ".nameX",
                                        "parameters": {},
                                        "msgPathString": "payload.tags[\"0\"].name"
                                    }
                                },
                                "msgPathString": "payload.tags[\"0\"]",
                                "activeFilter": "{\n\treturn tag.id === 13 || tag.id === 15\n}"
                            }
                        ],
                        "eachType": "msg",
                        "each": "payload",
                        "as": "tag"
                    },
                    "status": {
                        "name": "status",
                        "isActive": true,
                        "activeFilter": "",
                        "type": "select",
                        "value": "available"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Successful operation"
            },
            {
                "code": "405",
                "text": "Invalid input"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 380,
        "y": 720,
        "wires": [
            [
                "65110c919e408b85"
            ],
            [
                "8a432c1017ac312e"
            ]
        ]
    },
    {
        "id": "751bd26d424cc321",
        "type": "inject",
        "z": "0c8e0c86799d088c",
        "g": "efb7a27e4dfae1f6",
        "name": "add pet 451",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "fd241870fe8e402a"
            ]
        ]
    },
    {
        "id": "d4f8c637ba287db1",
        "type": "inject",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Inject Current Temp",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 260,
        "y": 200,
        "wires": [
            [
                "ba5dc6718d645637"
            ]
        ]
    },
    {
        "id": "69ded1d17cbec561",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Compare and Decide",
        "func": "const desired = flow.get('desired_temp') || 22;\nconst current = msg.payload.current;\nlet state = \"IDLE\";\nif (current < desired - 1) state = \"HEATING\";\nelse if (current > desired + 1) state = \"COOLING\";\nmsg.payload = { temperature: desired, unit: \"C\", current, state };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 160,
        "wires": [
            [
                "1d06a67200a8e66e",
                "8081e1c458fe1e4b"
            ]
        ]
    },
    {
        "id": "9a05b0be9bfe3225",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Status Display",
        "label": "Thermostat Status",
        "format": "{{msg.payload.state}} | Current: {{msg.payload.current}}C | Target: {{msg.payload.temperature}}C",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1330,
        "y": 260,
        "wires": []
    },
    {
        "id": "1d06a67200a8e66e",
        "type": "async-api-red",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Send to Thermostat Device",
        "x": 1010,
        "y": 200,
        "wires": [
            [
                "d9d04269593328c3",
                "9a05b0be9bfe3225"
            ]
        ]
    },
    {
        "id": "d9d04269593328c3",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Debug Output",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "statusVal": "",
        "statusType": "auto",
        "x": 1330,
        "y": 180,
        "wires": []
    },
    {
        "id": "1eb2f1ad87e9df5c",
        "type": "comment",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Thermostat simulation",
        "info": "",
        "x": 220,
        "y": 120,
        "wires": []
    },
    {
        "id": "09f2f1cdc17cf192",
        "type": "ui_slider",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Desired Temp",
        "label": "Set Desired Temp",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": 15,
        "max": 30,
        "step": 1,
        "className": "",
        "x": 240,
        "y": 280,
        "wires": [
            [
                "5fd815fb2caf5aba"
            ]
        ]
    },
    {
        "id": "5fd815fb2caf5aba",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Store Desired Temp",
        "func": "flow.set('desired_temp', msg.payload);\nreturn null;",
        "outputs": 1,
        "x": 470,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "4c2bce897c0d2007",
        "type": "comment",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "AC simulation",
        "info": "",
        "x": 190,
        "y": 400,
        "wires": []
    },
    {
        "id": "1616e8d0253bffbf",
        "type": "inject",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Inject Random Brightness",
        "props": [],
        "repeat": "5",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 260,
        "y": 860,
        "wires": [
            [
                "29a719f9730293ac"
            ]
        ]
    },
    {
        "id": "29a719f9730293ac",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Generate Brightness",
        "func": "const brightness = Math.floor(Math.random() * 101);\nmsg.payload = { brightness };\nreturn msg;",
        "outputs": 1,
        "x": 520,
        "y": 800,
        "wires": [
            [
                "b58e5041e4c9741b",
                "d83a4d77d7f049bf"
            ]
        ]
    },
    {
        "id": "b58e5041e4c9741b",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Check Brightness",
        "func": "const brightness = msg.payload.brightness;\nmsg.payload = {\n    state: brightness >= 80 ? \"on\" : \"off\",\n    brightness\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 800,
        "wires": [
            [
                "dba1b26fa3a4b0a8"
            ]
        ]
    },
    {
        "id": "d83a4d77d7f049bf",
        "type": "ui_chart",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Brightness Chart",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Brightness Over Time",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "Waiting...",
        "dot": false,
        "ymin": "0",
        "ymax": "100",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 710,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "84eae99cd8fb8148",
        "type": "switch",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Light ON or OFF?",
        "property": "payload.state",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1230,
        "y": 740,
        "wires": [
            [
                "9b07cf1424fb44b6"
            ],
            [
                "499267adb5adb442"
            ]
        ]
    },
    {
        "id": "9b07cf1424fb44b6",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Count ON",
        "func": "let count = context.get('on') || 0;\ncount += 1;\ncontext.set('on', count);\nmsg.payload = count;\nreturn msg;",
        "outputs": 1,
        "x": 1520,
        "y": 720,
        "wires": [
            [
                "02494731b443fa30"
            ]
        ]
    },
    {
        "id": "499267adb5adb442",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Count OFF",
        "func": "let count = context.get('off') || 0;\ncount += 1;\ncontext.set('off', count);\nmsg.payload = count;\nreturn msg;",
        "outputs": 1,
        "x": 1520,
        "y": 760,
        "wires": [
            [
                "4229373250208f05"
            ]
        ]
    },
    {
        "id": "02494731b443fa30",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "group": "",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "Times ON",
        "label": "Light ON Count",
        "format": "{{msg.payload}} times",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1740,
        "y": 720,
        "wires": []
    },
    {
        "id": "4229373250208f05",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "group": "",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "Times OFF",
        "label": "Light OFF Count",
        "format": "{{msg.payload}} times",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1740,
        "y": 760,
        "wires": []
    },
    {
        "id": "dba1b26fa3a4b0a8",
        "type": "async-api-red",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Send to Light Device",
        "x": 1000,
        "y": 860,
        "wires": [
            [
                "84eae99cd8fb8148",
                "c0f6b3899961c14c",
                "ae9ed5515183f125",
                "bdacb97c9c98471c"
            ]
        ]
    },
    {
        "id": "c0f6b3899961c14c",
        "type": "ui_gauge",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "Brightness",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Brightness",
        "label": "%",
        "format": "{{msg.payload.brightness}}",
        "min": 0,
        "max": 100,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": 60,
        "seg2": 80,
        "diff": false,
        "className": "",
        "x": 1250,
        "y": 840,
        "wires": []
    },
    {
        "id": "ae9ed5515183f125",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Light State",
        "label": "Light State",
        "format": "{{msg.payload.state}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1250,
        "y": 940,
        "wires": []
    },
    {
        "id": "bdacb97c9c98471c",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1040,
        "y": 1020,
        "wires": []
    },
    {
        "id": "f42d0e7a987f22d0",
        "type": "comment",
        "z": "a527806fb52a0bc0",
        "g": "6996a7f421765b1a",
        "name": "smartlights simulation",
        "info": "",
        "x": 220,
        "y": 720,
        "wires": []
    },
    {
        "id": "2f8c3fe9e3a364d1",
        "type": "ui_switch",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "name": "Door Lock Switch",
        "label": "Lock Door",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 3,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 210,
        "y": 1200,
        "wires": [
            [
                "aec069bf440e39e4"
            ]
        ]
    },
    {
        "id": "aec069bf440e39e4",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "name": "Format DoorLock Payload",
        "func": "msg.payload = { locked: msg.payload };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 1200,
        "wires": [
            [
                "601a43db7ca6fa0a"
            ]
        ]
    },
    {
        "id": "601a43db7ca6fa0a",
        "type": "async-api-red",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "name": "SmartDoor Lock ",
        "x": 720,
        "y": 1140,
        "wires": [
            [
                "f6b18e5f375f811d",
                "47886e634365fb88"
            ]
        ]
    },
    {
        "id": "47886e634365fb88",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "name": "Update Dashboard Status",
        "func": "msg.payload = msg.payload.locked ? \"Locked\" : \"Unlocked\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1030,
        "y": 1220,
        "wires": [
            [
                "f324d4a123376c63"
            ]
        ]
    },
    {
        "id": "f324d4a123376c63",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "group": "",
        "order": 2,
        "width": 3,
        "height": 1,
        "name": "Lock Status Text",
        "label": "Door Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1320,
        "y": 1220,
        "wires": []
    },
    {
        "id": "f6b18e5f375f811d",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "name": "debug 15",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1140,
        "y": 1140,
        "wires": []
    },
    {
        "id": "6aa34857a3f76ef9",
        "type": "comment",
        "z": "a527806fb52a0bc0",
        "g": "38af56c2be0e770c",
        "name": "Smartdoor",
        "info": "",
        "x": 180,
        "y": 1140,
        "wires": []
    },
    {
        "id": "d4868acaa6b1056b",
        "type": "comment",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "cofee machine simulator",
        "info": "",
        "x": 230,
        "y": 1360,
        "wires": []
    },
    {
        "id": "format_coffee",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "Format Coffee Payload",
        "func": "msg.payload = {\n  strength: msg.payload.strength,\n  size: msg.payload.size\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 1460,
        "wires": [
            [
                "b972287969dd1e02"
            ]
        ]
    },
    {
        "id": "join_coffee",
        "type": "join",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "Join Strength & Size",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "useparts": true,
        "accumulate": false,
        "timeout": "",
        "count": "2",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 480,
        "y": 1460,
        "wires": [
            [
                "format_coffee"
            ]
        ]
    },
    {
        "id": "debug_coffee",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "Debug Coffee Payload",
        "active": true,
        "console": "false",
        "complete": "true",
        "x": 1220,
        "y": 1400,
        "wires": []
    },
    {
        "id": "b972287969dd1e02",
        "type": "async-api-red",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "SmartDoor Lock ",
        "x": 1000,
        "y": 1460,
        "wires": [
            [
                "debug_coffee",
                "ui_coffee_status"
            ]
        ]
    },
    {
        "id": "ui_size",
        "type": "ui_dropdown",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "Select Size",
        "label": "Coffee Size",
        "tooltip": "",
        "place": "",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "Small",
                "value": "small",
                "type": "str"
            },
            {
                "label": "Medium",
                "value": "medium",
                "type": "str"
            },
            {
                "label": "Large",
                "value": "large",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "size",
        "topicType": "str",
        "className": "",
        "x": 230,
        "y": 1500,
        "wires": [
            [
                "join_coffee"
            ]
        ]
    },
    {
        "id": "ui_strength",
        "type": "ui_dropdown",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "name": "Select Strength",
        "label": "Coffee Strength",
        "tooltip": "",
        "place": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "Light",
                "value": "light",
                "type": "str"
            },
            {
                "label": "Medium",
                "value": "medium",
                "type": "str"
            },
            {
                "label": "Strong",
                "value": "strong",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "strength",
        "topicType": "str",
        "className": "",
        "x": 220,
        "y": 1440,
        "wires": [
            [
                "join_coffee"
            ]
        ]
    },
    {
        "id": "ui_coffee_status",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "d6d6813509f8a19b",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "Order Status",
        "label": "Coffee Order",
        "format": "{{msg.payload.strength}} / {{msg.payload.size}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1230,
        "y": 1480,
        "wires": []
    },
    {
        "id": "652fef5d99c41776",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Check AC State",
        "func": "const currentTemp = msg.payload.temperature;\nconst desiredTemp = flow.get(\"desired_temp\") || 24;\nmsg.payload = {\n    temperature: currentTemp,\n    desired: desiredTemp,\n    unit: 'C',\n    state: currentTemp > desiredTemp ? \"ON\" : \"OFF\"\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 780,
        "y": 460,
        "wires": [
            [
                "98def4b9de0bd9e0",
                "3cdc3eae3c728601"
            ]
        ]
    },
    {
        "id": "98def4b9de0bd9e0",
        "type": "async-api-red",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "AC Controller Node",
        "x": 1040,
        "y": 460,
        "wires": [
            [
                "977bf35655af95ea",
                "325004b4427897ea",
                "6f5c1f35a0395420"
            ]
        ]
    },
    {
        "id": "977bf35655af95ea",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Debug AC Output",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1370,
        "y": 420,
        "wires": []
    },
    {
        "id": "325004b4427897ea",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "AC State",
        "label": "AC State",
        "format": "AC is {{msg.payload.state}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1400,
        "y": 500,
        "wires": []
    },
    {
        "id": "4ffc7d206027f2ef",
        "type": "ui_slider",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Desired Temp",
        "label": "Set Desired Temp",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": 15,
        "max": 30,
        "step": 1,
        "className": "",
        "x": 300,
        "y": 540,
        "wires": [
            [
                "180cc2c38f2b7ec2"
            ]
        ]
    },
    {
        "id": "180cc2c38f2b7ec2",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Store Desired Temp",
        "func": "flow.set('desired_temp', msg.payload);\nreturn null;",
        "outputs": 1,
        "x": 570,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "6f5c1f35a0395420",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Track Energy",
        "func": "// Constants\nconst power_kW = 1.5; // Power usage of the AC in kW\n\n// Get previous state and timestamp\nconst prevState = flow.get(\"ac_last_state\") || \"OFF\";\nconst lastChange = flow.get(\"ac_last_change\") || Date.now();\nconst energy = flow.get(\"energy_consumed\") || 0;\n\nconst now = Date.now();\nlet newEnergy = energy;\n\nif (prevState === \"ON\" && msg.payload.state === \"OFF\") {\n    const durationHrs = (now - lastChange) / (1000 * 60 * 60);\n    newEnergy += durationHrs * power_kW;\n    flow.set(\"energy_consumed\", newEnergy);\n}\n\n// Update flow context\nflow.set(\"ac_last_state\", msg.payload.state);\nflow.set(\"ac_last_change\", now);\n\nmsg.energy = newEnergy.toFixed(3);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1190,
        "y": 540,
        "wires": [
            [
                "c90d975ea0894abd"
            ]
        ]
    },
    {
        "id": "c90d975ea0894abd",
        "type": "ui_text",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Energy Display",
        "label": "Total Energy (kWh)",
        "format": "{{msg.energy}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1400,
        "y": 580,
        "wires": []
    },
    {
        "id": "e5f04a5e61c95926",
        "type": "ui_button",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Reset Energy",
        "label": "Reset Energy",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 300,
        "y": 600,
        "wires": [
            [
                "87c71e9f1e18a5cb"
            ]
        ]
    },
    {
        "id": "87c71e9f1e18a5cb",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Reset Energy Values",
        "func": "flow.set(\"energy_consumed\", 0);\nflow.set(\"ac_last_change\", Date.now());\nreturn null;",
        "outputs": 0,
        "x": 570,
        "y": 600,
        "wires": []
    },
    {
        "id": "ba5dc6718d645637",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Generate Current Temp",
        "func": "msg.payload = { current: Math.floor(15 + Math.random() * 15) };\nreturn msg;",
        "outputs": 1,
        "x": 490,
        "y": 200,
        "wires": [
            [
                "69ded1d17cbec561",
                "27b270e5d78bc103"
            ]
        ]
    },
    {
        "id": "27b270e5d78bc103",
        "type": "ui_gauge",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "Current Temp",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Current Temperature",
        "label": "C",
        "format": "{{msg.payload.current}}",
        "min": "10",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 730,
        "y": 260,
        "wires": []
    },
    {
        "id": "a11a61d05abb0fd9",
        "type": "function",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Generate Current Temp",
        "func": "msg.payload = { temperature: Math.floor(15 + Math.random() * 15) };\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 550,
        "y": 460,
        "wires": [
            [
                "96ab1cc712be6574",
                "652fef5d99c41776"
            ]
        ]
    },
    {
        "id": "97a42e312b36f637",
        "type": "inject",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Inject Current Temp",
        "props": [],
        "repeat": "5",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 300,
        "y": 460,
        "wires": [
            [
                "a11a61d05abb0fd9"
            ]
        ]
    },
    {
        "id": "96ab1cc712be6574",
        "type": "ui_gauge",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "Current Temp",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Current Temperature",
        "label": "C",
        "format": "{{msg.payload.temperature}}",
        "min": "10",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 790,
        "y": 520,
        "wires": []
    },
    {
        "id": "3cdc3eae3c728601",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "a0bc03072058d078",
        "name": "input ac",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 400,
        "wires": []
    },
    {
        "id": "8081e1c458fe1e4b",
        "type": "debug",
        "z": "a527806fb52a0bc0",
        "g": "50a045551ea38743",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1040,
        "y": 120,
        "wires": []
    },
    {
        "id": "209eb22e55aef159",
        "type": "subflow:subflow-thermostat-logic",
        "z": "a7f4785e36cba6a2",
        "name": "Thermostat 1 Logic",
        "x": 1290,
        "y": 300,
        "wires": [
            [
                "b693ac0c316bb007",
                "278d3dc18bde92a3"
            ]
        ]
    },
    {
        "id": "b693ac0c316bb007",
        "type": "ui_text",
        "z": "a7f4785e36cba6a2",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Status 1",
        "label": "Thermostat 1",
        "format": "{{msg.payload.state}} | {{msg.payload.current}}C / {{msg.payload.desired}}C",
        "layout": "row-spread",
        "x": 1530,
        "y": 280,
        "wires": []
    },
    {
        "id": "278d3dc18bde92a3",
        "type": "ui_gauge",
        "z": "a7f4785e36cba6a2",
        "name": "Gauge 1",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Current Temp 1",
        "label": "C",
        "format": "{{msg.payload.current}}",
        "min": 10,
        "max": 35,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "x": 1530,
        "y": 320,
        "wires": []
    },
    {
        "id": "d413c272304f7027",
        "type": "function",
        "z": "a7f4785e36cba6a2",
        "name": "Attach Desired Temp 1",
        "func": "msg.desired = flow.get(\"desired1\") || 22;\nreturn msg;",
        "outputs": 1,
        "x": 1070,
        "y": 300,
        "wires": [
            [
                "209eb22e55aef159"
            ]
        ]
    },
    {
        "id": "04f14957bb63ad6c",
        "type": "inject",
        "z": "a7f4785e36cba6a2",
        "name": "Simulate Temp 1",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "x": 690,
        "y": 300,
        "wires": [
            [
                "e5cf4791a88d36ed"
            ]
        ]
    },
    {
        "id": "e5cf4791a88d36ed",
        "type": "function",
        "z": "a7f4785e36cba6a2",
        "name": "Generate Random Temp",
        "func": "msg.payload = { current: Math.floor(15 + Math.random() * 10) };\nreturn msg;",
        "outputs": 1,
        "x": 890,
        "y": 360,
        "wires": [
            [
                "d413c272304f7027"
            ]
        ]
    },
    {
        "id": "b1b29f96499e193e",
        "type": "ui_slider",
        "z": "a7f4785e36cba6a2",
        "name": "Slider 1",
        "label": "Desired Temp 1",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "min": 15,
        "max": 30,
        "step": 1,
        "x": 890,
        "y": 240,
        "wires": [
            [
                "a3b785ec104fb684"
            ]
        ]
    },
    {
        "id": "a3b785ec104fb684",
        "type": "function",
        "z": "a7f4785e36cba6a2",
        "name": "Store Desired 1",
        "func": "flow.set(\"desired1\", msg.payload);\nreturn null;",
        "outputs": 1,
        "x": 1080,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "f3c546cb501a34c1",
        "type": "subflow:subflow-thermostat-logic",
        "z": "a7f4785e36cba6a2",
        "name": "Thermostat 2 Logic",
        "x": 1290,
        "y": 500,
        "wires": [
            [
                "de83e57ebf24426f",
                "f43d8752f3a53b9e"
            ]
        ]
    },
    {
        "id": "de83e57ebf24426f",
        "type": "ui_text",
        "z": "a7f4785e36cba6a2",
        "group": "",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "Status 2",
        "label": "Thermostat 2",
        "format": "{{msg.payload.state}} | {{msg.payload.current}}C / {{msg.payload.desired}}C",
        "layout": "row-spread",
        "x": 1530,
        "y": 480,
        "wires": []
    },
    {
        "id": "f43d8752f3a53b9e",
        "type": "ui_gauge",
        "z": "a7f4785e36cba6a2",
        "name": "Gauge 2",
        "group": "",
        "order": 3,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Current Temp 2",
        "label": "C",
        "format": "{{msg.payload.current}}",
        "min": 10,
        "max": 35,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "x": 1530,
        "y": 520,
        "wires": []
    },
    {
        "id": "1deeb3c38486ec3e",
        "type": "inject",
        "z": "a7f4785e36cba6a2",
        "name": "Simulate Temp 2",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "x": 610,
        "y": 500,
        "wires": [
            [
                "dcbcc6db108b2ef3"
            ]
        ]
    },
    {
        "id": "dcbcc6db108b2ef3",
        "type": "function",
        "z": "a7f4785e36cba6a2",
        "name": "Generate Temp 2",
        "func": "msg.payload = { current: Math.floor(15 + Math.random() * 10) };\nreturn msg;",
        "outputs": 1,
        "x": 830,
        "y": 560,
        "wires": [
            [
                "a7f9f85e8ad8fa6e"
            ]
        ]
    },
    {
        "id": "a7f9f85e8ad8fa6e",
        "type": "function",
        "z": "a7f4785e36cba6a2",
        "name": "Attach Desired 2",
        "func": "msg.desired = flow.get(\"desired2\") || 22;\nreturn msg;",
        "outputs": 1,
        "x": 1070,
        "y": 500,
        "wires": [
            [
                "f3c546cb501a34c1"
            ]
        ]
    },
    {
        "id": "1f5477c9da2d418f",
        "type": "ui_slider",
        "z": "a7f4785e36cba6a2",
        "name": "Slider 2",
        "label": "Desired Temp 2",
        "tooltip": "",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "min": 15,
        "max": 30,
        "step": 1,
        "x": 840,
        "y": 440,
        "wires": [
            [
                "ba9cd257a3f10828"
            ]
        ]
    },
    {
        "id": "ba9cd257a3f10828",
        "type": "function",
        "z": "a7f4785e36cba6a2",
        "name": "Store Desired 2",
        "func": "flow.set(\"desired2\", msg.payload);\nreturn null;",
        "outputs": 1,
        "x": 1080,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "inject_temp",
        "type": "inject",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "name": "Inject Current Temp",
        "props": [],
        "repeat": "5",
        "once": true,
        "topic": "",
        "x": 260,
        "y": 260,
        "wires": [
            [
                "gen_temp"
            ]
        ]
    },
    {
        "id": "gen_temp",
        "type": "function",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "name": "Generate Current Temp",
        "func": "msg.payload = { current: 15 + Math.floor(Math.random()*10) };\nreturn msg;",
        "outputs": 1,
        "x": 550,
        "y": 260,
        "wires": [
            [
                "decide_mode"
            ]
        ]
    },
    {
        "id": "decide_mode",
        "type": "function",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "name": "Compare and Decide",
        "func": "const desired = flow.get('desired_temp') || 22;\nconst current = msg.payload.current;\nlet mode = \"idle\";\nif (current < desired - 1) mode = \"heat\";\nelse if (current > desired + 1) mode = \"cool\";\n\n// track energy use\nlet energy = flow.get('energy.thermostat') || 0;\nif (mode !== \"idle\") energy += 0.05; // add kWh step\nflow.set('energy.thermostat', energy);\n\nmsg.payload = {\n    temperature: current,\n    humidity: Math.floor(40 + Math.random()*20),\n    mode: mode,\n    energyUsed: energy,\n    unit: \"C\"\n};\nreturn msg;",
        "outputs": 1,
        "x": 810,
        "y": 260,
        "wires": [
            [
                "thermostat_asyncapi",
                "thermostat_ui"
            ]
        ]
    },
    {
        "id": "thermostat_asyncapi",
        "type": "async-api-red",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "name": "thermostatState",
        "x": 1080,
        "y": 260,
        "wires": [
            [
                "thermostat_debug"
            ]
        ]
    },
    {
        "id": "thermostat_debug",
        "type": "debug",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1310,
        "y": 260,
        "wires": []
    },
    {
        "id": "thermostat_ui",
        "type": "ui_text",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "group": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "Thermostat Status",
        "label": "Thermostat",
        "format": "Temp: {{msg.payload.temperature}}C | Mode: {{msg.payload.mode}} | Energy: {{msg.payload.energyUsed.toFixed(2)}} kWh",
        "layout": "row-spread",
        "x": 1080,
        "y": 320,
        "wires": []
    },
    {
        "id": "7a5f61a9eaff8de0",
        "type": "comment",
        "z": "b0c6f1e3d4fc18a3",
        "g": "6fbdbe15acb6baf1",
        "name": "Thermostat",
        "info": "",
        "x": 210,
        "y": 200,
        "wires": []
    },
    {
        "id": "inject_thermostat",
        "type": "inject",
        "z": "smarthome_flow",
        "g": "thermostat_group",
        "name": "Inject Temp",
        "props": [],
        "repeat": "5",
        "once": true,
        "x": 250,
        "y": 200,
        "wires": [
            [
                "func_thermostat"
            ]
        ]
    },
    {
        "id": "func_thermostat",
        "type": "function",
        "z": "smarthome_flow",
        "g": "thermostat_group",
        "name": "Thermostat State & Energy",
        "func": "const desired = flow.get('desired_temp') || 22;\nconst current = 15 + Math.floor(Math.random()*10);\nlet mode='idle';\nif(current < desired-1) mode='heat';\nelse if(current>desired+1) mode='cool';\nlet energy=flow.get('energy.thermostat')||0;\nif(mode!=='idle') energy+=0.05;\nflow.set('energy.thermostat',energy);\nmsg.payload={temperature:current,humidity:40+Math.floor(Math.random()*20),mode:mode,energyUsed:energy,unit:'C'};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 200,
        "wires": [
            [
                "asyncapi_thermostat",
                "ui_thermostat"
            ]
        ]
    },
    {
        "id": "asyncapi_thermostat",
        "type": "async-api-red",
        "z": "smarthome_flow",
        "g": "thermostat_group",
        "name": "Thermostat AsyncAPI",
        "x": 840,
        "y": 160,
        "wires": [
            [
                "debug_thermostat"
            ]
        ]
    },
    {
        "id": "debug_thermostat",
        "type": "debug",
        "z": "smarthome_flow",
        "g": "thermostat_group",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 1110,
        "y": 160,
        "wires": []
    },
    {
        "id": "ui_thermostat",
        "type": "ui_text",
        "z": "smarthome_flow",
        "g": "thermostat_group",
        "group": "",
        "order": 1,
        "width": "",
        "height": "",
        "name": "",
        "label": "Thermostat",
        "format": "Temp: {{msg.payload.temperature}}C | Mode: {{msg.payload.mode}} | Energy: {{msg.payload.energyUsed.toFixed(2)}} kWh",
        "layout": "",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 810,
        "y": 220,
        "wires": []
    },
    {
        "id": "comment_thermostat",
        "type": "comment",
        "z": "smarthome_flow",
        "g": "thermostat_group",
        "name": "Thermostat",
        "info": "",
        "x": 220,
        "y": 130,
        "wires": []
    },
    {
        "id": "ec8567273d2eeee4",
        "type": "inject",
        "z": "9d0b8d8486bf692d",
        "g": "60aadd304320ab68",
        "name": "Inject Temp",
        "props": [],
        "repeat": "5",
        "once": true,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "4f76589d9ce93708"
            ]
        ]
    },
    {
        "id": "4f76589d9ce93708",
        "type": "function",
        "z": "9d0b8d8486bf692d",
        "g": "60aadd304320ab68",
        "name": "Thermostat State & Energy",
        "func": "const desired = flow.get('desired_temp') || 22;\nconst current = 15 + Math.floor(Math.random()*10);\nlet mode='idle';\nif(current < desired-1) mode='heat';\nelse if(current>desired+1) mode='cool';\nlet energy=flow.get('energy.thermostat')||0;\nif(mode!=='idle') energy+=0.05;\nflow.set('energy.thermostat',energy);\nmsg.payload={temperature:current,humidity:40+Math.floor(Math.random()*20),mode:mode,energyUsed:energy,unit:'C'};\nreturn msg;",
        "outputs": 1,
        "x": 450,
        "y": 80,
        "wires": [
            [
                "3c02180f43d76483",
                "08eba1a39da3c211"
            ]
        ]
    },
    {
        "id": "3c02180f43d76483",
        "type": "async-api-red",
        "z": "9d0b8d8486bf692d",
        "g": "60aadd304320ab68",
        "name": "Thermostat AsyncAPI",
        "x": 700,
        "y": 80,
        "wires": [
            [
                "52372a1a90bed450"
            ]
        ]
    },
    {
        "id": "52372a1a90bed450",
        "type": "debug",
        "z": "9d0b8d8486bf692d",
        "g": "60aadd304320ab68",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 900,
        "y": 80,
        "wires": []
    },
    {
        "id": "08eba1a39da3c211",
        "type": "ui_text",
        "z": "9d0b8d8486bf692d",
        "g": "60aadd304320ab68",
        "group": "",
        "order": 1,
        "label": "Thermostat",
        "format": "Temp: {{msg.payload.temperature}}C | Mode: {{msg.payload.mode}} | Energy: {{msg.payload.energyUsed.toFixed(2)}} kWh",
        "x": 700,
        "y": 140,
        "wires": []
    },
    {
        "id": "d34fbeffad5f26c3",
        "type": "comment",
        "z": "9d0b8d8486bf692d",
        "g": "60aadd304320ab68",
        "name": "Thermostat",
        "info": "",
        "x": 150,
        "y": 50,
        "wires": []
    },
    {
        "id": "b2ace2b50a3cffc6",
        "type": "inject",
        "z": "9d0b8d8486bf692d",
        "g": "7495cd4d423a5333",
        "name": "Inject AC State",
        "props": [],
        "repeat": "5",
        "once": true,
        "x": 200,
        "y": 330,
        "wires": [
            [
                "5767fb305640ce22"
            ]
        ]
    },
    {
        "id": "5767fb305640ce22",
        "type": "function",
        "z": "9d0b8d8486bf692d",
        "g": "7495cd4d423a5333",
        "name": "AC State & Energy",
        "func": "const state=Math.random()>0.5?'ON':'OFF';\nlet energy=flow.get('energy.ac')||0;\nif(state==='ON') energy+=0.2;\nflow.set('energy.ac',energy);\nmsg.payload={state:state,energyUsed:energy,mode:'cooling'};\nreturn msg;",
        "outputs": 1,
        "x": 450,
        "y": 330,
        "wires": [
            [
                "320f5263b6a058cb",
                "d61ec178a3c22e54"
            ]
        ]
    },
    {
        "id": "320f5263b6a058cb",
        "type": "async-api-red",
        "z": "9d0b8d8486bf692d",
        "g": "7495cd4d423a5333",
        "name": "AC AsyncAPI",
        "x": 700,
        "y": 330,
        "wires": [
            [
                "6c79919ed6d57634"
            ]
        ]
    },
    {
        "id": "6c79919ed6d57634",
        "type": "debug",
        "z": "9d0b8d8486bf692d",
        "g": "7495cd4d423a5333",
        "name": "AC Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 900,
        "y": 330,
        "wires": []
    },
    {
        "id": "d61ec178a3c22e54",
        "type": "ui_text",
        "z": "9d0b8d8486bf692d",
        "g": "7495cd4d423a5333",
        "group": "",
        "order": 1,
        "label": "AC",
        "format": "State: {{msg.payload.state}} | Energy: {{msg.payload.energyUsed.toFixed(2)}} kWh",
        "x": 700,
        "y": 390,
        "wires": []
    },
    {
        "id": "29acb7a9e4ad24bf",
        "type": "comment",
        "z": "9d0b8d8486bf692d",
        "g": "7495cd4d423a5333",
        "name": "AC",
        "info": "",
        "x": 150,
        "y": 300,
        "wires": []
    },
    {
        "id": "565b754961e5b93e",
        "type": "inject",
        "z": "db6486d1d2cd59d6",
        "g": "5b08965eee815217",
        "name": "Inject Temp",
        "props": [],
        "repeat": "5",
        "once": true,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "230fec0f35cc4133"
            ]
        ]
    },
    {
        "id": "230fec0f35cc4133",
        "type": "function",
        "z": "db6486d1d2cd59d6",
        "g": "5b08965eee815217",
        "name": "Thermostat State & Energy",
        "func": "const desired = flow.get('desired_temp') || 22;\nconst current = 15 + Math.floor(Math.random()*10);\nlet mode='idle';\nif(current < desired-1) mode='heat';\nelse if(current>desired+1) mode='cool';\nlet energy=flow.get('energy.thermostat')||0;\nif(mode!=='idle') energy+=0.05;\nflow.set('energy.thermostat',energy);\nmsg.payload={temperature:current,humidity:40+Math.floor(Math.random()*20),mode:mode,energyUsed:energy,unit:'C'};\nreturn msg;",
        "outputs": 1,
        "x": 450,
        "y": 80,
        "wires": [
            [
                "55079425775637d9",
                "512fb36647226d10"
            ]
        ]
    },
    {
        "id": "55079425775637d9",
        "type": "async-api-red",
        "z": "db6486d1d2cd59d6",
        "g": "5b08965eee815217",
        "name": "Thermostat AsyncAPI",
        "x": 700,
        "y": 80,
        "wires": [
            [
                "559b9f04cf93c275"
            ]
        ]
    },
    {
        "id": "559b9f04cf93c275",
        "type": "debug",
        "z": "db6486d1d2cd59d6",
        "g": "5b08965eee815217",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 900,
        "y": 80,
        "wires": []
    },
    {
        "id": "512fb36647226d10",
        "type": "ui_text",
        "z": "db6486d1d2cd59d6",
        "g": "5b08965eee815217",
        "group": "",
        "order": 1,
        "width": "",
        "height": "",
        "name": "",
        "label": "Thermostat",
        "format": "Temp: {{msg.payload.temperature}}C | Mode: {{msg.payload.mode}} | Energy: {{msg.payload.energyUsed.toFixed(2)}} kWh",
        "layout": "",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 700,
        "y": 140,
        "wires": []
    },
    {
        "id": "01573af29b531a78",
        "type": "inject",
        "z": "db6486d1d2cd59d6",
        "g": "4575d7c456ea2458",
        "name": "Inject AC State",
        "props": [],
        "repeat": "5",
        "once": true,
        "x": 200,
        "y": 330,
        "wires": [
            [
                "4d738e0fc0f1352c"
            ]
        ]
    },
    {
        "id": "4d738e0fc0f1352c",
        "type": "function",
        "z": "db6486d1d2cd59d6",
        "g": "4575d7c456ea2458",
        "name": "AC State & Energy",
        "func": "const state=Math.random()>0.5?'ON':'OFF';\nlet energy=flow.get('energy.ac')||0;\nif(state==='ON') energy+=0.2;\nflow.set('energy.ac',energy);\nmsg.payload={state:state,energyUsed:energy,mode:'cooling'};\nreturn msg;",
        "outputs": 1,
        "x": 450,
        "y": 330,
        "wires": [
            [
                "a946ef667e501665",
                "91288be2c27b7ea4"
            ]
        ]
    },
    {
        "id": "a946ef667e501665",
        "type": "async-api-red",
        "z": "db6486d1d2cd59d6",
        "g": "4575d7c456ea2458",
        "name": "AC AsyncAPI",
        "x": 700,
        "y": 330,
        "wires": [
            [
                "0ab73cc9fa9c5c90"
            ]
        ]
    },
    {
        "id": "0ab73cc9fa9c5c90",
        "type": "debug",
        "z": "db6486d1d2cd59d6",
        "g": "4575d7c456ea2458",
        "name": "AC Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 900,
        "y": 330,
        "wires": []
    },
    {
        "id": "91288be2c27b7ea4",
        "type": "ui_text",
        "z": "db6486d1d2cd59d6",
        "g": "4575d7c456ea2458",
        "group": "",
        "order": 1,
        "width": "",
        "height": "",
        "name": "",
        "label": "AC",
        "format": "State: {{msg.payload.state}} | Energy: {{msg.payload.energyUsed.toFixed(2)}} kWh",
        "layout": "",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 700,
        "y": 390,
        "wires": []
    },
    {
        "id": "07d92834eb8e47f5",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "c99ee48a54796f90",
        "name": "AC Telemetry",
        "func": "// === Air Conditioner Telemetry Simulator (Smart Plug Controlled) ===\n\n// --- Check Smart Plug state ---\nconst plugState = global.get('acState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution when AC plug is off\n}\n\n// --- Environment values ---\nlet envTemp = parseFloat(msg.payload.temperature || 25);\nlet envHumidity = msg.payload.humidity || 50;\n\n// --- Persistent setpoint (holds same for 1 hour) ---\nlet setpoint = flow.get('ac.setpoint');\nlet setpointTimer = flow.get('ac.setpointTimer') || 0;\n\n// Initialize or refresh setpoint every 3600 simulated seconds\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\nsetpointTimer += tickDuration;\n\nif (!setpoint || setpointTimer >= 3600) {\n    setpoint = Math.floor(16 + Math.random() * 15); // 1630C\n    setpointTimer = 0;\n}\n\n// --- Current temperature drift ---\nlet current = flow.get('ac.currentTemp') || envTemp;\ncurrent += (Math.random() - 0.5) * 0.3; // small drift 0.15C\n\n// --- Determine AC mode ---\nlet mode = 'idle';\nlet currentPower = 0; // Watts\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    currentPower = 1200; // cooling\n    current -= 0.5;\n} else if (current < setpoint - 1) {\n    mode = 'heat';\n    currentPower = 2000; // heating\n    current += 0.5;\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.ac') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (currentPower > 0) energy += wattToKwh(currentPower, tickDuration);\n\n// --- Save state ---\nflow.set('ac.setpoint', setpoint);\nflow.set('ac.setpointTimer', setpointTimer);\nflow.set('ac.currentTemp', current);\nflow.set('energy.ac', energy);\n\n// --- Node status feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (mode === 'cool') {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else if (mode === 'heat') {\n    color = \"red\";\n    shape = \"dot\";\n    text = `Heating | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Idle | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"ac\",\n    power: plugState,             // on/off from smart plug\n    temperature: parseFloat(current.toFixed(1)),\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    currentPower: currentPower,   // instantaneous Watts\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\",\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1720,
        "y": 420,
        "wires": [
            [
                "598f2008fafaa0f4"
            ]
        ]
    },
    {
        "id": "598f2008fafaa0f4",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "c99ee48a54796f90",
        "name": "AC AsyncAPI",
        "x": 1970,
        "y": 420,
        "wires": [
            [
                "fc5e972c26387247",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "fc5e972c26387247",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "c99ee48a54796f90",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2170,
        "y": 400,
        "wires": []
    },
    {
        "id": "func_lights",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "lights_group",
        "name": "Lights Telemetry",
        "func": "// === Smart Light Telemetry Simulator (Controlled by Smart Plug) ===\n\n// --- Check Smart Plug state first ---\nconst plugState = global.get('lightState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop simulation when plug is off\n}\n\n// --- Environment info ---\nlet envTemp = parseFloat(msg.payload.temperature || 22);\nlet envHumidity = msg.payload.humidity || 45;\nlet envLight = msg.payload.lightIntensity || 50;\n\n// --- Threshold for turning lights ON/OFF (0100) ---\nconst lightThreshold = 30;\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// --- Light behavior when ON ---\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0; // W\nenergy += (power / 1000) * (tickSeconds / 3600); // convert to kWh\nflow.set('energy.light', parseFloat(energy.toFixed(3)));\n\n// --- Node status for dashboard ---\nlet colorStatus = state === \"ON\" ? \"green\" : \"red\";\nlet shape = state === \"ON\" ? \"dot\" : \"ring\";\nlet text = `${state} | ${power.toFixed(1)} W`;\n\nnode.status({ fill: colorStatus, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"light\",\n    power: plugState, // shows if plug is ON/OFF\n    state: state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    voltage: 230,\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1720,
        "y": 640,
        "wires": [
            [
                "asyncapi_lights"
            ]
        ]
    },
    {
        "id": "asyncapi_lights",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "lights_group",
        "name": "Lights AsyncAPI",
        "x": 1980,
        "y": 640,
        "wires": [
            [
                "debug_lights",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "debug_lights",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "lights_group",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2210,
        "y": 600,
        "wires": []
    },
    {
        "id": "func_fridge",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "fridge_group",
        "name": "Fridge Telemetry",
        "func": "// === Fridge & Freezer Telemetry Simulator (Safe Temperatures) ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;     // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") ?? fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") ?? freezerSet + (Math.random() * 2 - 1);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;  // seconds per tick\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);   // 0.2C\nfreezerTemp += (Math.random() * 0.6 - 0.3);  // 0.3C\n\n// Compressor state logic\nlet compressor = \"OFF\";\nlet currentPower = 5; // idle watts\n\nif (fridgeTemp > fridgeSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3;  // small decrement per tick\n    if (fridgeTemp < fridgeSet) fridgeTemp = fridgeSet; // prevent overcooling\n    currentPower = 150;\n}\n\nif (freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    freezerTemp -= 0.5;\n    if (freezerTemp < freezerSet) freezerTemp = freezerSet; // prevent overcooling\n    currentPower = 150;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\nenergy += wattToKwh(currentPower, tickSeconds);\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// --- Node status visual feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (doorStatus !== \"closed\") {\n    color = \"red\";\n    shape = \"dot\";\n    text = ` Door Open (${doorStatus.replace(\"_\", \" \")}) | ${currentPower} W`;\n} else if (compressor === \"ON\") {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling ON | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Stable | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: currentPower, // instantaneous W\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1730,
        "y": 860,
        "wires": [
            [
                "asyncapi_fridge"
            ]
        ]
    },
    {
        "id": "asyncapi_fridge",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "fridge_group",
        "name": "Fridge AsyncAPI",
        "x": 1980,
        "y": 860,
        "wires": [
            [
                "debug_fridge",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "debug_fridge",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "fridge_group",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2240,
        "y": 880,
        "wires": []
    },
    {
        "id": "asyncapi_launder",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "launder_group",
        "name": "Launder AsyncAPI",
        "x": 1970,
        "y": 1100,
        "wires": [
            [
                "debug_launder",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "debug_launder",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "launder_group",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2220,
        "y": 1120,
        "wires": []
    },
    {
        "id": "func_dehumidifier",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "dehumidifier_group",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator (Auto Stop/Start by Humidity) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickMinutes = 1 * scale; // 1 tick = 1 minute\n\n// --- Persistent state ---\nlet running = flow.get('dehumidifier.running');\nif (running === undefined) running = true;\n\nlet tankLevel = flow.get('dehumidifier.tankLevel') || 0;\nlet elapsedMinutes = flow.get('dehumidifier.elapsedMinutes') || 0;\n\n// Fixed mode and fan speed\nconst mode = \"auto\";\nconst fanSpeed = \"medium\";\n\n// Random environment humidity\nlet environmentHumidity = msg.payload.humidity || 45; // current room humidity\n\n// --- Auto Stop/Start logic ---\nif (environmentHumidity <= 50) {\n    running = false; // stop dehumidifier\n} else if (environmentHumidity > 50) {\n    running = true;  // start dehumidifier\n}\n\n// Power settings\nconst powerWatts = running ? 200 : 0; // instantaneous Watts\n\n// --- Run logic ---\nif (running) {\n    // Increment elapsed time\n    elapsedMinutes += tickMinutes;\n\n    // Gradual tank filling step-by-step (small random increment per minute)\n    const humidityRemoved = parseFloat((Math.random() * 2 + 0.5).toFixed(2)); // 0.52.5% per tick\n    tankLevel = Math.min(100, tankLevel + humidityRemoved);\n\n    // Reset tank if full or after 60 min\n    if (tankLevel >= 100 || elapsedMinutes >= 60) {\n        tankLevel = 0;\n        elapsedMinutes = 0;\n    }\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.dehumidifier') || 0;\nfunction wattToKwh(powerWatts, minutes) {\n    return (powerWatts / 1000) * (minutes / 60);\n}\nif (powerWatts > 0) energy += wattToKwh(powerWatts, tickMinutes);\n\n// --- Save persistent state ---\nflow.set('dehumidifier.running', running);\nflow.set('dehumidifier.tankLevel', tankLevel);\nflow.set('dehumidifier.elapsedMinutes', elapsedMinutes);\nflow.set('energy.dehumidifier', energy);\n\n// --- Node status feedback ---\nlet color = running ? \"blue\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\n\n// Calculate progress as percentage of 60 min run\nconst progressPercent = Math.min(100, Math.round((elapsedMinutes / 60) * 100));\nlet text = running \n    ? `${environmentHumidity}% | ${mode.toUpperCase()} | ${powerWatts} W `\n    : `${environmentHumidity}% | OFF | 0 W `;\n\n// Update node status\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    progressPercent: progressPercent,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: powerWatts,\n    humidity: environmentHumidity,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1740,
        "y": 1360,
        "wires": [
            [
                "asyncapi_dehumidifier"
            ]
        ]
    },
    {
        "id": "asyncapi_dehumidifier",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "dehumidifier_group",
        "name": "Dehumidifier AsyncAPI",
        "x": 1990,
        "y": 1360,
        "wires": [
            [
                "debug_dehumidifier",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "debug_dehumidifier",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "dehumidifier_group",
        "name": "Dehumidifier Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 2300,
        "y": 1340,
        "wires": []
    },
    {
        "id": "func_cooker",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "cooker_group",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator (30 min Standard Mode) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickSeconds = 1 * scale; // 1 tick = 1 real second\n\n// Check Smart Plug state\nconst plugState = global.get('cookerState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null;\n}\n\nlet running = true;\n\n// Standard fixed mode\nconst mode = \"bake\"; // standard mode\n\n// Persistent timer in seconds\nlet remainingSeconds = flow.get('cooker.remainingSeconds');\nif (!remainingSeconds) {\n    remainingSeconds = 30 * 60; // 30 minutes in seconds\n}\n\n// Update timer\nif (running) {\n    remainingSeconds = Math.max(0, remainingSeconds - tickSeconds);\n    if (remainingSeconds === 0) running = false;\n}\n\n// Temperatures\nconst currentTemp = running ? 180 : 25; // standard bake temp\nconst setTemp = running ? 200 : 0;\n\n// Instantaneous power in Watts\nconst powerWatts = running ? 1500 : 0;\n\n// Energy tracking in kWh\nlet energy = flow.get('energy.cooker') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (running) energy += wattToKwh(powerWatts, tickSeconds);\nflow.set('energy.cooker', energy);\n\n// Save persistent timer\nflow.set('cooker.remainingSeconds', remainingSeconds);\n\n// --- Node status feedback ---\nlet color = running ? \"orange\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\nlet minutesLeft = Math.ceil(remainingSeconds / 60); // only minutes, round up\n\nlet text = running \n    ? `${mode.toUpperCase()} | ${currentTemp}C  ${setTemp}C | ${minutesLeft} min left | ${powerWatts} W`\n    : `OFF | Temp: ${currentTemp}C | 0 W`;\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode,\n    setTemp,\n    currentTemp,\n    timerMinutes: minutesLeft,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1730,
        "y": 1580,
        "wires": [
            [
                "asyncapi_cooker"
            ]
        ]
    },
    {
        "id": "asyncapi_cooker",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "cooker_group",
        "name": "Cooker AsyncAPI",
        "x": 2070,
        "y": 1580,
        "wires": [
            [
                "debug_cooker",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "debug_cooker",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "cooker_group",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2320,
        "y": 1580,
        "wires": []
    },
    {
        "id": "1915adae0ac41c37",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "19609f77c4ba5897",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2250,
        "y": 160,
        "wires": []
    },
    {
        "id": "dbd082096676a420",
        "type": "async-api-red",
        "z": "4f4855f52107b72b",
        "g": "19609f77c4ba5897",
        "name": " Thermostat AsyncAPI",
        "x": 2000,
        "y": 220,
        "wires": [
            [
                "1915adae0ac41c37",
                "94935853959483b3"
            ]
        ]
    },
    {
        "id": "577012c85e361b8b",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "6578bf7b191c43b7",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 670,
        "y": 800,
        "wires": [
            [
                "8084d0c60d963452"
            ]
        ]
    },
    {
        "id": "94935853959483b3",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Total Energy Calculator",
        "func": "let devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\nlet hours = flow.get('hours') || 1; // time period in hours\n\n// Sum all device energy values\nlet totalW = devices.reduce((sum, d) => sum + (flow.get(`energy.${d}`) || 0), 0);\nlet totalKWh = totalW * hours / 1000;\n\n// Round and prepare output\nmsg.totalEnergy = `${totalKWh.toFixed(3)} kWh`;\n\n// --- Node status display ---\nlet color = \"green\";\nlet shape = \"dot\";\nlet text = `Total: ${totalKWh.toFixed(3)} kWh`;\n\nif (totalKWh === 0) {\n    color = \"grey\";\n    shape = \"ring\";\n    text = \"No energy recorded\";\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// Output message\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2910,
        "y": 680,
        "wires": [
            [
                "d7982dd2528420ba"
            ]
        ]
    },
    {
        "id": "d7982dd2528420ba",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "Total Energy Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2990,
        "y": 840,
        "wires": []
    },
    {
        "id": "8084d0c60d963452",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "6578bf7b191c43b7",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60); // 1s = 1 minute\n}\n\n// --- Realistic Environment Base ---\nconst baseTemp = 22; // C\nconst baseHumidity = 70; // %\nconst hour = new Date().getHours(); // local time for light simulation\n\n// Get previous state\nlet currentTemp = flow.get('env.temperature') || baseTemp;\nlet currentHumidity = flow.get('env.humidity') || baseHumidity;\nlet currentLight = flow.get('env.lightIntensity') || 50;\n\n// --- Apply small drift ---\ncurrentTemp += (Math.random() * 0.4 - 0.2); // 0.2C\ncurrentHumidity += (Math.random() * 2 - 1);  // 1%\ncurrentHumidity = Math.max(20, Math.min(70, currentHumidity)); // clamp realistic\n// Light based on time of day\nif (hour >= 6 && hour < 18) {\n    currentLight = 70 + Math.floor(Math.random() * 30); // day\n} else {\n    currentLight = 0 + Math.floor(Math.random() * 20);  // night\n}\n\n// Save state for next tick\nflow.set('env.temperature', currentTemp);\nflow.set('env.humidity', currentHumidity);\nflow.set('env.lightIntensity', currentLight);\nflow.set('current_temp', currentTemp);\n\n// --- Output payload ---\nmsg.payload = {\n    environment: true,\n    temperature: currentTemp.toFixed(1),\n    humidity: currentHumidity.toFixed(1),\n    lightIntensity: currentLight,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\")\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 800,
        "wires": [
            [
                "07d92834eb8e47f5",
                "func_lights",
                "func_fridge",
                "func_laundry_telemetry",
                "func_dehumidifier",
                "func_cooker",
                "f8959e1f024fcb3c",
                "7c195bd85b16a570"
            ]
        ]
    },
    {
        "id": "dbcecb9927394929",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "876a8dac7a94efab",
        "name": "SMARTHOME",
        "info": "",
        "x": 160,
        "y": 100,
        "wires": []
    },
    {
        "id": "func_laundry_telemetry",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "launder_group",
        "name": "Laundry Telemetry",
        "func": "// --- Full Washing Machine Cycle Simulator ---\n\n// --- Simulation scale ---\nconst scale = global.get(\"simulationScale\") || 60; // seconds per tick\nconst tickSeconds = 60 * scale; // 1 tick = 1 minute\n\n// --- Check Smart Plug / power ---\nconst plugState = global.get('laundryState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  cycle paused' });\n    return null;\n}\n\n// --- Load persistent state ---\nlet phase = flow.get('laundry.phase') || 'idle';\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || (plugState === 'on' ? true:false);\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\nlet mode = flow.get('laundry.mode') || 'normal';\n\n// --- Phase durations per mode (minutes) ---\nconst modeDurations = {\n    eco: { filling:5, washing:60, rinsing:15, spinning:10, drying:30 },\n    normal: { filling:5, washing:45, rinsing:15, spinning:10, drying:20 },\n    quick: { filling:3, washing:20, rinsing:10, spinning:5, drying:10 },\n    heavy: { filling:5, washing:75, rinsing:20, spinning:15, drying:40 },\n    delicate: { filling:5, washing:30, rinsing:15, spinning:5, drying:10 }\n};\n\n// --- Power per phase (Watts) ---\nconst phasePower = { filling:50, washing:500, rinsing:300, spinning:800, drying:2000, completed:0 };\n\n// --- Start new cycle if idle ---\nif (!running && phase === 'idle') {\n    running = true;\n    const modes = Object.keys(modeDurations);\n    mode = modes[Math.floor(Math.random() * modes.length)];\n    phase = 'filling';\n    remainingTime = modeDurations[mode][phase];\n}\n\n// --- Progress cycle ---\nif (running) {\n    remainingTime -= 1 * scale;\n\n    if (remainingTime <= 0) {\n        const phases = ['filling','washing','rinsing','spinning','drying'];\n        const currentIndex = phases.indexOf(phase);\n\n        if (currentIndex < phases.length - 1) {\n            phase = phases[currentIndex + 1];\n            remainingTime = modeDurations[mode][phase];\n        } else {\n            // Cycle completed\n            phase = 'completed';\n            running = false;\n            remainingTime = 0;\n        }\n    }\n}\n\n// --- Instantaneous power ---\nlet currentPower = running ? phasePower[phase] || 0 : 0;\n\n// --- Energy usage (kWh) ---\nenergy += (currentPower / 1000) * (tickSeconds / 3600);\n\n// --- Water usage ---\nif (['filling','washing','rinsing'].includes(phase)) {\n    waterUsed += Math.random() * 0.5 * scale;\n}\n\n// --- Simulated values ---\nlet waterTemp = (phase === 'washing') ? 40 + Math.random()*10 : 25;\nlet spinSpeed = (phase === 'spinning') ? 800 + Math.floor(Math.random()*400) : 0;\nlet loadWeight = 5 + Math.random()*3;\n\n// --- Door status ---\nlet doorStatus = (running || phase === 'completed') ? 'locked' : 'closed';\n\n// --- Save state ---\nflow.set('laundry.phase', phase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\nflow.set('laundry.mode', mode);\n\n// --- Node status feedback ---\nlet color = \"grey\", shape = \"ring\", text = \"\";\n\nif (!running && phase === 'completed') {\n    color = 'green';\n    shape = 'ring';\n    text = ` Cycle Completed | 0 W`;\n} else if (running) {\n    color = 'blue';\n    shape = 'dot';\n    text = `${phase.toUpperCase()} | ${remainingTime} min left | ${currentPower} W`;\n}\n\nif (doorStatus === 'open') {\n    color = 'red';\n    text = ' Door Open';\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: 'laundry',\n    power: 'ON',\n    running,\n    mode,\n    phase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    currentPower: currentPower, // instantaneous Watts\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1730,
        "y": 1100,
        "wires": [
            [
                "asyncapi_launder"
            ]
        ]
    },
    {
        "id": "7beea3e98437718c",
        "type": "http in",
        "z": "4f4855f52107b72b",
        "g": "50d822b0af5cc61a",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/thermostat/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 300,
        "y": 2220,
        "wires": [
            [
                "4e8d16b83fa2b771"
            ]
        ]
    },
    {
        "id": "4e8d16b83fa2b771",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "50d822b0af5cc61a",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('thermostat_smartplug.state', newState);\nflow.set('thermostat_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 2220,
        "wires": [
            [
                "0dc74f1972d85f33"
            ]
        ]
    },
    {
        "id": "0dc74f1972d85f33",
        "type": "http response",
        "z": "4f4855f52107b72b",
        "g": "50d822b0af5cc61a",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 800,
        "y": 2220,
        "wires": []
    },
    {
        "id": "792d16844e582310",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "50d822b0af5cc61a",
        "name": "webhook endpoint for thermostat",
        "info": "",
        "x": 310,
        "y": 2160,
        "wires": []
    },
    {
        "id": "5e636eef5daa1b5f",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "881db607590cd279",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 510,
        "y": 140,
        "wires": []
    },
    {
        "id": "ddf88dd27e263bd5",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "881db607590cd279",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 510,
        "y": 200,
        "wires": [
            [
                "d19baf00cf51bded"
            ]
        ]
    },
    {
        "id": "0776bc1099a8818c",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "881db607590cd279",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 500,
        "y": 270,
        "wires": [
            [
                "d19baf00cf51bded"
            ]
        ]
    },
    {
        "id": "91dad80f577e2b9f",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "881db607590cd279",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('thermostatState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1100,
        "y": 240,
        "wires": [
            [
                "f8959e1f024fcb3c"
            ]
        ]
    },
    {
        "id": "f8959e1f024fcb3c",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "19609f77c4ba5897",
        "name": "Thermostat Telemetry",
        "func": "// Check Smart Plug state before running\nconst plugState = global.get('thermostatState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution\n}\n\n// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature || 22); // default 22C\nlet envHumidity = msg.payload.humidity || 45;\n\n// Desired temperature\nconst desired = Math.floor(20 + Math.random() * 11);\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nlet currentPower = 0; // W\n\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5;\n    currentPower = 2000; // heater power in W\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5;\n    currentPower = 1200; // AC power in W\n}\n\n// Energy tracking (cumulative kWh)\nlet energy = flow.get('energy.thermostat') || 0;\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\n// Add to cumulative energy\nenergy += wattToKwh(currentPower, tickDuration);\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// --- Node status for visual feedback ---\nlet color = 'grey';\nlet shape = 'ring';\nlet text = 'Idle';\n\nif (mode === 'heat') {\n    color = 'red';\n    shape = 'dot';\n    text = `HEAT | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else if (mode === 'cool') {\n    color = 'blue';\n    shape = 'dot';\n    text = `COOL | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else {\n    text = `IDLE | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    power: plugState,       // instantaneous W\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1740,
        "y": 220,
        "wires": [
            [
                "dbd082096676a420"
            ]
        ]
    },
    {
        "id": "57eefc9f63239b74",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "881db607590cd279",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 160,
        "wires": []
    },
    {
        "id": "d19baf00cf51bded",
        "type": "openApi-red",
        "z": "4f4855f52107b72b",
        "g": "881db607590cd279",
        "name": "Thermostat webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setThermostatPlugState",
            "hasOperationId": true,
            "path": "/home/{id}/smartplug/thermostat/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            },
            "id path": {
                "name": "id",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload.id",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Thermostat plug state changed successfully"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 800,
        "y": 240,
        "wires": [
            [
                "91dad80f577e2b9f",
                "57eefc9f63239b74"
            ],
            []
        ]
    },
    {
        "id": "7b0894f417168af4",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "e2e99964236f8675",
        "name": "Smartplug for cooker",
        "info": "",
        "x": 470,
        "y": 1760,
        "wires": []
    },
    {
        "id": "a3255351da27c4c9",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "e2e99964236f8675",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 490,
        "y": 1820,
        "wires": [
            [
                "14fd1ecf6e17d3c3"
            ]
        ]
    },
    {
        "id": "f3aa31b745aa88b8",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "e2e99964236f8675",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 480,
        "y": 1890,
        "wires": [
            [
                "14fd1ecf6e17d3c3"
            ]
        ]
    },
    {
        "id": "43a4f2d07be30783",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "e2e99964236f8675",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('cookerState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 1860,
        "wires": [
            [
                "func_cooker"
            ]
        ]
    },
    {
        "id": "58d6581bc5500dc9",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "e2e99964236f8675",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 1760,
        "wires": []
    },
    {
        "id": "14fd1ecf6e17d3c3",
        "type": "openApi-red",
        "z": "4f4855f52107b72b",
        "g": "e2e99964236f8675",
        "name": "Cooker webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setCookerPlugState",
            "hasOperationId": true,
            "path": "/smartplug/cooker/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 770,
        "y": 1860,
        "wires": [
            [
                "43a4f2d07be30783",
                "58d6581bc5500dc9"
            ]
        ]
    },
    {
        "id": "ebcda5c59f9a16f1",
        "type": "http in",
        "z": "4f4855f52107b72b",
        "g": "d2748fb7d73cced7",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/cooker/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1140,
        "y": 2220,
        "wires": [
            [
                "c4e7455fb216592d"
            ]
        ]
    },
    {
        "id": "c4e7455fb216592d",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "d2748fb7d73cced7",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('cooker_smartplug.state', newState);\nflow.set('cooker_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1400,
        "y": 2220,
        "wires": [
            [
                "79b596b657bb6429"
            ]
        ]
    },
    {
        "id": "79b596b657bb6429",
        "type": "http response",
        "z": "4f4855f52107b72b",
        "g": "d2748fb7d73cced7",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 1640,
        "y": 2220,
        "wires": []
    },
    {
        "id": "1e8883acb1fd6cae",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "d2748fb7d73cced7",
        "name": "webhook endpoint for cooker",
        "info": "",
        "x": 1140,
        "y": 2160,
        "wires": []
    },
    {
        "id": "f7310e18baa39bd1",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "6578bf7b191c43b7",
        "name": "Enviroment variables",
        "info": "",
        "x": 660,
        "y": 740,
        "wires": []
    },
    {
        "id": "a3b4653f0cf6ae5d",
        "type": "http in",
        "z": "4f4855f52107b72b",
        "g": "fe7c6d62782a61e9",
        "name": "[POST] Smartplug laundry",
        "url": "/home/1/smartplug/laundry/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1970,
        "y": 2220,
        "wires": [
            [
                "e94a1310f11d28ae"
            ]
        ]
    },
    {
        "id": "e94a1310f11d28ae",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "fe7c6d62782a61e9",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('laundry_smartplug.state', newState);\nflow.set('laundry_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2250,
        "y": 2220,
        "wires": [
            [
                "c6af873c12f6835f"
            ]
        ]
    },
    {
        "id": "c6af873c12f6835f",
        "type": "http response",
        "z": "4f4855f52107b72b",
        "g": "fe7c6d62782a61e9",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 2530,
        "y": 2220,
        "wires": []
    },
    {
        "id": "7277ba557dca3273",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "fe7c6d62782a61e9",
        "name": "",
        "info": "",
        "x": 1920,
        "y": 2160,
        "wires": []
    },
    {
        "id": "6028a3ed46cca3d4",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "9be3feeb419a7b53",
        "name": "Webhooks Init",
        "info": "",
        "x": 250,
        "y": 2060,
        "wires": []
    },
    {
        "id": "4003081ec19ca6d6",
        "type": "http in",
        "z": "4f4855f52107b72b",
        "g": "abefde1276346b1c",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/lights/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 300,
        "y": 2440,
        "wires": [
            [
                "4deeabc6a75aae45"
            ]
        ]
    },
    {
        "id": "670d73bf79ea2a0d",
        "type": "http response",
        "z": "4f4855f52107b72b",
        "g": "abefde1276346b1c",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 850,
        "y": 2440,
        "wires": []
    },
    {
        "id": "4deeabc6a75aae45",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "abefde1276346b1c",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smart_lights_smartplug.state', newState);\nflow.set('smart_lights_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 2440,
        "wires": [
            [
                "670d73bf79ea2a0d"
            ]
        ]
    },
    {
        "id": "7cb36fb185a2217e",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "abefde1276346b1c",
        "name": "webhook endpoint for smartlights",
        "info": "",
        "x": 310,
        "y": 2380,
        "wires": []
    },
    {
        "id": "8fe7947781d8abaa",
        "type": "http in",
        "z": "4f4855f52107b72b",
        "g": "0d443770ff71eb54",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/ac/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1220,
        "y": 2440,
        "wires": [
            [
                "883f36bae22e7492"
            ]
        ]
    },
    {
        "id": "e4d27f662a46cc39",
        "type": "http response",
        "z": "4f4855f52107b72b",
        "g": "0d443770ff71eb54",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 1790,
        "y": 2440,
        "wires": []
    },
    {
        "id": "883f36bae22e7492",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "0d443770ff71eb54",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1510,
        "y": 2440,
        "wires": [
            [
                "e4d27f662a46cc39"
            ]
        ]
    },
    {
        "id": "5fcd41c00a481bb9",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "0d443770ff71eb54",
        "name": "webhook endpoint for AC",
        "info": "",
        "x": 1210,
        "y": 2380,
        "wires": []
    },
    {
        "id": "c4d08d0f89251bfb",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "19609f77c4ba5897",
        "name": "Thermostat Device",
        "info": "",
        "x": 1730,
        "y": 160,
        "wires": []
    },
    {
        "id": "c966bb323b7cb3b5",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "c99ee48a54796f90",
        "name": "AC Device",
        "info": "",
        "x": 1700,
        "y": 360,
        "wires": []
    },
    {
        "id": "750e70a11320f07b",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "lights_group",
        "name": "Lights",
        "info": "",
        "x": 1690,
        "y": 580,
        "wires": []
    },
    {
        "id": "047e02ede737fd4b",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "fridge_group",
        "name": "Fridge Device",
        "info": "",
        "x": 1710,
        "y": 800,
        "wires": []
    },
    {
        "id": "7acf5abf8245e211",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "launder_group",
        "name": "Laundry Device",
        "info": "",
        "x": 1720,
        "y": 1040,
        "wires": []
    },
    {
        "id": "f34984d5e6f1804a",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "dehumidifier_group",
        "name": "Dehimidifier Device",
        "info": "",
        "x": 1730,
        "y": 1300,
        "wires": []
    },
    {
        "id": "b8808b578daac992",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "cooker_group",
        "name": "Cooker Device",
        "info": "",
        "x": 1720,
        "y": 1520,
        "wires": []
    },
    {
        "id": "eed1f93db727e728",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "9c58429dd67aded0",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 480,
        "y": 940,
        "wires": []
    },
    {
        "id": "638a5cf47e62722e",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "9c58429dd67aded0",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 490,
        "y": 1000,
        "wires": [
            [
                "42a38b50701f7a16"
            ]
        ]
    },
    {
        "id": "8f8ef71dd8a15893",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "9c58429dd67aded0",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 480,
        "y": 1070,
        "wires": [
            [
                "42a38b50701f7a16"
            ]
        ]
    },
    {
        "id": "e6fe9b42f4d79edf",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "9c58429dd67aded0",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('lightState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 1040,
        "wires": [
            [
                "func_lights"
            ]
        ]
    },
    {
        "id": "4434127a410944ad",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "9c58429dd67aded0",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 940,
        "wires": []
    },
    {
        "id": "42a38b50701f7a16",
        "type": "openApi-red",
        "z": "4f4855f52107b72b",
        "g": "9c58429dd67aded0",
        "name": "",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setLightsPlugState",
            "hasOperationId": true,
            "path": "/home/{id}/smartplug/lights/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            },
            "id path": {
                "name": "id",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload.id",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart lights state changed successfully"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 790,
        "y": 1020,
        "wires": [
            [
                "e6fe9b42f4d79edf",
                "4434127a410944ad"
            ],
            []
        ]
    },
    {
        "id": "e6d51b72905c0448",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "d72e67c06e6e6132",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 490,
        "y": 460,
        "wires": []
    },
    {
        "id": "a7e74769d12738d5",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "d72e67c06e6e6132",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 490,
        "y": 520,
        "wires": [
            [
                "df8beacd24a634c0"
            ]
        ]
    },
    {
        "id": "beea24a1850466d6",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "d72e67c06e6e6132",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 480,
        "y": 590,
        "wires": [
            [
                "df8beacd24a634c0"
            ]
        ]
    },
    {
        "id": "a66a27203f3dea31",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "d72e67c06e6e6132",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('acState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1080,
        "y": 560,
        "wires": [
            [
                "07d92834eb8e47f5"
            ]
        ]
    },
    {
        "id": "4cc30fd54c279296",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "d72e67c06e6e6132",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1150,
        "y": 480,
        "wires": []
    },
    {
        "id": "df8beacd24a634c0",
        "type": "openApi-red",
        "z": "4f4855f52107b72b",
        "g": "d72e67c06e6e6132",
        "name": "",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setACPlugState",
            "hasOperationId": true,
            "path": "/home/{id}/smartplug/ac/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    },
                    "temperature": {
                        "name": "temperature",
                        "activeFilter": ""
                    },
                    "mode": {
                        "name": "mode",
                        "activeFilter": ""
                    }
                },
                "collapsed": false
            },
            "id path": {
                "name": "id",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload.id",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart AC state changed successfully"
            },
            {
                "code": "400",
                "text": "Invalid parameters"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 780,
        "y": 520,
        "wires": [
            [
                "a66a27203f3dea31"
            ],
            [
                "4cc30fd54c279296"
            ]
        ]
    },
    {
        "id": "5567887ea0a363f7",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "2fd9a75bdb7f05d0",
        "name": "Handle webhook state",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2400,
        "y": 2440,
        "wires": [
            [
                "4bdcc2e5def36e60"
            ]
        ]
    },
    {
        "id": "4bdcc2e5def36e60",
        "type": "http response",
        "z": "4f4855f52107b72b",
        "g": "2fd9a75bdb7f05d0",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 2670,
        "y": 2440,
        "wires": []
    },
    {
        "id": "922e9857401b4999",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "2fd9a75bdb7f05d0",
        "name": "webhook endpoint for dehumidifier",
        "info": "",
        "x": 2140,
        "y": 2380,
        "wires": []
    },
    {
        "id": "8a54f719f26ad8aa",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "45e26e30f704ad47",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 460,
        "y": 1180,
        "wires": []
    },
    {
        "id": "67c5da6c604320b8",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "45e26e30f704ad47",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 470,
        "y": 1240,
        "wires": [
            [
                "3c3f82bfebc2ba37"
            ]
        ]
    },
    {
        "id": "11e4fbb90c6f9d1a",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "45e26e30f704ad47",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "1",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 460,
        "y": 1310,
        "wires": [
            [
                "3c3f82bfebc2ba37"
            ]
        ]
    },
    {
        "id": "3474c5bf1ab29ecd",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "45e26e30f704ad47",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('laundryState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1060,
        "y": 1280,
        "wires": [
            [
                "func_laundry_telemetry"
            ]
        ]
    },
    {
        "id": "f2a1daf9ebd965d6",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "45e26e30f704ad47",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1110,
        "y": 1180,
        "wires": []
    },
    {
        "id": "3c3f82bfebc2ba37",
        "type": "openApi-red",
        "z": "4f4855f52107b72b",
        "g": "45e26e30f704ad47",
        "name": "",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "Laundry",
        "keepAuth": false,
        "operationData": {
            "id": "setLaundryState",
            "hasOperationId": true,
            "path": "/home/{id}/smartplug/laundry/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            },
            "id path": {
                "name": "id",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload.id",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Laundry plug state changed successfully"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 720,
        "y": 1240,
        "wires": [
            [
                "3474c5bf1ab29ecd",
                "f2a1daf9ebd965d6"
            ],
            []
        ]
    },
    {
        "id": "ef13bb4d03a55dae",
        "type": "openApi-red",
        "z": "4f4855f52107b72b",
        "g": "f47559f06abd3bf6",
        "name": "Dehumidifier webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setDehumidifierPlugState",
            "hasOperationId": true,
            "path": "/home/{id}/smartplug/dehumidifier/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            },
            "id path": {
                "name": "id",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload.id",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Dehumidifier plug state changed successfully"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 820,
        "y": 1560,
        "wires": [
            [
                "d37116182cd1018f"
            ],
            [
                "6175e10e832537dd"
            ]
        ]
    },
    {
        "id": "7c195bd85b16a570",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "f47559f06abd3bf6",
        "name": "trigger humidifier webhook",
        "func": "// Default values\nlet state = \"off\";\nlet humidity = 0;\n\n// Check if humidity exists in the incoming payload\nif (msg.payload && msg.payload.humidity !== undefined) {\n    humidity = Number(msg.payload.humidity);\n\n    // Determine the state based on humidity\n    state = humidity > 30 ? \"on\" : \"off\";\n}\n\n// Update payload\nmsg.payload = { state: state };\nmsg.payload.id = 1;\n\n// Update Node-RED status bubble\nnode.status({\n    fill: state === \"on\" ? \"green\" : \"red\",\n    shape: \"dot\",\n    text: `Humidity: ${humidity.toFixed(1)}%  ${state.toUpperCase()}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 1580,
        "wires": [
            [
                "ef13bb4d03a55dae"
            ]
        ]
    },
    {
        "id": "d37116182cd1018f",
        "type": "debug",
        "z": "4f4855f52107b72b",
        "g": "f47559f06abd3bf6",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 1480,
        "wires": []
    },
    {
        "id": "6175e10e832537dd",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "f47559f06abd3bf6",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    // Save the current state globally\n    global.set('dehumidifierState', msg.payload.state);\n\n    // Update the node status\n    const stateText = msg.payload.state === 'on' ? 'ON' : 'OFF';\n    const color = msg.payload.state === 'on' ? 'green' : 'red';\n\n    node.status({\n        fill: color,\n        shape: 'dot',\n        text: `Dehumidifier is ${stateText}`\n    });\n}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 1600,
        "wires": [
            [
                "func_dehumidifier"
            ]
        ]
    },
    {
        "id": "d2baa4f8658d3321",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "f47559f06abd3bf6",
        "name": "Dehumidifier smartplug",
        "info": "",
        "x": 460,
        "y": 1480,
        "wires": []
    },
    {
        "id": "3bfda26157dbdd74",
        "type": "http in",
        "z": "4f4855f52107b72b",
        "g": "2fd9a75bdb7f05d0",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/dehumidifier/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 2120,
        "y": 2440,
        "wires": [
            [
                "5567887ea0a363f7"
            ]
        ]
    },
    {
        "id": "3b274ef1ae8f85ee",
        "type": "comment",
        "z": "4f4855f52107b72b",
        "g": "3176681a660261ae",
        "name": "reset simulation",
        "info": "",
        "x": 2740,
        "y": 1100,
        "wires": []
    },
    {
        "id": "e7c13b2b64d3e56a",
        "type": "inject",
        "z": "4f4855f52107b72b",
        "g": "3176681a660261ae",
        "name": " Reset Energy Counters",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2790,
        "y": 1160,
        "wires": [
            [
                "e742fb4a13f8f90e"
            ]
        ]
    },
    {
        "id": "e742fb4a13f8f90e",
        "type": "function",
        "z": "4f4855f52107b72b",
        "g": "3176681a660261ae",
        "name": "Reset Energy Counter",
        "func": "// --- Reset all device energy values ---\nconst devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\n\n// Reset each devices energy to 0\ndevices.forEach(d => flow.set(`energy.${d}`, 0));\n\n// Reset time period\nflow.set('hours', 1);\n\nnode.status({ fill: \"yellow\", shape: \"ring\", text: \"Energy counters reset\" });\n\n// Output a confirmation message\nmsg.payload = {\n    reset: true,\n    message: \"All energy counters have been reset to 0\",\n    devices: devices\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3040,
        "y": 1160,
        "wires": [
            []
        ]
    },
    {
        "id": "home1",
        "type": "subflow:subflow_smarthome",
        "z": "tab_neighborhood",
        "name": "Home 1",
        "env": [
            {
                "name": "homeId",
                "value": "1",
                "type": "num"
            }
        ],
        "x": 180,
        "y": 100,
        "wires": []
    },
    {
        "id": "home2",
        "type": "subflow:subflow_smarthome",
        "z": "tab_neighborhood",
        "name": "Home 2",
        "env": [
            {
                "name": "homeId",
                "value": 2,
                "type": "num"
            }
        ],
        "x": 180,
        "y": 160,
        "wires": []
    },
    {
        "id": "home3",
        "type": "subflow:subflow_smarthome",
        "z": "tab_neighborhood",
        "name": "Home 3",
        "env": [
            {
                "name": "homeId",
                "value": 3,
                "type": "num"
            }
        ],
        "x": 180,
        "y": 220,
        "wires": []
    },
    {
        "id": "home4",
        "type": "subflow:subflow_smarthome",
        "z": "tab_neighborhood",
        "name": "Home 4",
        "env": [
            {
                "name": "homeId",
                "value": 4,
                "type": "num"
            }
        ],
        "x": 180,
        "y": 280,
        "wires": []
    },
    {
        "id": "home5",
        "type": "subflow:subflow_smarthome",
        "z": "tab_neighborhood",
        "name": "Home 5",
        "env": [
            {
                "name": "homeId",
                "value": 5,
                "type": "num"
            }
        ],
        "x": 180,
        "y": 340,
        "wires": []
    },
    {
        "id": "join_energy",
        "type": "join",
        "z": "tab_neighborhood",
        "name": "Join All Homes",
        "mode": "auto",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "useparts": true,
        "x": 420,
        "y": 220,
        "wires": [
            [
                "func_sum_energy"
            ]
        ]
    },
    {
        "id": "func_sum_energy",
        "type": "function",
        "z": "tab_neighborhood",
        "name": "Sum Neighborhood Energy",
        "func": "let total = 0;\nmsg.payload.forEach(h => total += h.energy);\nmsg.payload = {\n    totalEnergy: parseFloat(total.toFixed(2)),\n    homes: msg.payload\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 660,
        "y": 220,
        "wires": [
            [
                "ui_gauge_total",
                "ui_chart_total",
                "debug_total"
            ]
        ]
    },
    {
        "id": "ui_gauge_total",
        "type": "ui_gauge",
        "z": "tab_neighborhood",
        "name": "Total Neighborhood Energy",
        "group": "ui_group_neighborhood",
        "order": 1,
        "width": 6,
        "height": 3,
        "gtype": "gage",
        "title": "Neighborhood Energy",
        "label": "kWh",
        "format": "{{value}}",
        "min": 0,
        "max": 100,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 960,
        "y": 180,
        "wires": []
    },
    {
        "id": "ui_chart_total",
        "type": "ui_chart",
        "z": "tab_neighborhood",
        "name": "Energy Chart",
        "group": "ui_group_neighborhood",
        "order": 2,
        "width": 6,
        "height": 4,
        "label": "Total Energy Consumption",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "",
        "removeOlder": "60",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4"
        ],
        "outputs": 1,
        "x": 960,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "debug_total",
        "type": "debug",
        "z": "tab_neighborhood",
        "name": "Neighborhood Energy Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 960,
        "y": 320,
        "wires": []
    },
    {
        "id": "29ecc1fac3a4320e",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 320,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "107645194616a8ca",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 640,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "0d2c1663f6e31596",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 500,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "5af42ad4f7fd0f05",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 400,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "bc0701a833b10095",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 720,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "a9fa148e12057d4e",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 800,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "f37ee414653fa21c",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 880,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "34a56f4dd3d55128",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1060,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "e2e5188838e6c473",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1160,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "b5e04b5106c6ae5c",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 960,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "7d9087f020742686",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 580,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "8fd741c30903017a",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 260,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "0a250920574c3fae",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 160,
        "wires": [
            [
                "d3452e860595db6a",
                "a8f2a848ead5120c"
            ]
        ]
    },
    {
        "id": "04c71f28755de573",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1240,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "458bbb78eb180ebe",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1320,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "d69b0ae9bc7827a7",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1400,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "d94641d871bd96cc",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1480,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "8f3c72f622ea929e",
        "type": "subflow:7ecc82fdd5fcacdb",
        "z": "240e9c78e5c49674",
        "name": "",
        "x": 710,
        "y": 1560,
        "wires": [
            [
                "d3452e860595db6a"
            ]
        ]
    },
    {
        "id": "d3452e860595db6a",
        "type": "function",
        "z": "240e9c78e5c49674",
        "name": "function 1",
        "func": "\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 600,
        "wires": [
            [
                "3dcebda3e55c1f61"
            ]
        ]
    },
    {
        "id": "3dcebda3e55c1f61",
        "type": "debug",
        "z": "240e9c78e5c49674",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1540,
        "y": 600,
        "wires": []
    },
    {
        "id": "a8f2a848ead5120c",
        "type": "debug",
        "z": "240e9c78e5c49674",
        "name": "debug 5",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1090,
        "y": 120,
        "wires": []
    },
    {
        "id": "6a4174cd4b9e3acb",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "642bdcd7a497cdf6",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/cooker/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1520,
        "y": 5060,
        "wires": [
            [
                "52829c313e4494f1"
            ]
        ]
    },
    {
        "id": "52829c313e4494f1",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "642bdcd7a497cdf6",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('cooker_smartplug.state', newState);\nflow.set('cooker_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1780,
        "y": 5060,
        "wires": [
            [
                "995c44c3cc87eb9c"
            ]
        ]
    },
    {
        "id": "995c44c3cc87eb9c",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "642bdcd7a497cdf6",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 2020,
        "y": 5060,
        "wires": []
    },
    {
        "id": "bb63a520e48386da",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "642bdcd7a497cdf6",
        "name": "webhook endpoint for cooker",
        "info": "",
        "x": 1520,
        "y": 5000,
        "wires": []
    },
    {
        "id": "fc4dbad09b9ab186",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "a4bf18d97f23db93",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/thermostat/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 680,
        "y": 5060,
        "wires": [
            [
                "4f3d3a453eef62f1"
            ]
        ]
    },
    {
        "id": "4f3d3a453eef62f1",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "a4bf18d97f23db93",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('thermostat_smartplug.state', newState);\nflow.set('thermostat_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 5060,
        "wires": [
            [
                "867de9d19386c3f9"
            ]
        ]
    },
    {
        "id": "867de9d19386c3f9",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "a4bf18d97f23db93",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 1180,
        "y": 5060,
        "wires": []
    },
    {
        "id": "098373f7db0a30ef",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "a4bf18d97f23db93",
        "name": "webhook endpoint for thermostat",
        "info": "",
        "x": 690,
        "y": 5000,
        "wires": []
    },
    {
        "id": "e3c9caf99f3947a0",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "e93baf4c775db1c8",
        "name": "[POST] Smartplug laundry",
        "url": "/home/1/smartplug/laundry/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 2350,
        "y": 5060,
        "wires": [
            [
                "87ce893e6476a95e"
            ]
        ]
    },
    {
        "id": "87ce893e6476a95e",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "e93baf4c775db1c8",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('laundry_smartplug.state', newState);\nflow.set('laundry_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2630,
        "y": 5060,
        "wires": [
            [
                "474a35aba342067e"
            ]
        ]
    },
    {
        "id": "474a35aba342067e",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "e93baf4c775db1c8",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 2910,
        "y": 5060,
        "wires": []
    },
    {
        "id": "454f1f35f73e1353",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "e93baf4c775db1c8",
        "name": "",
        "info": "",
        "x": 2300,
        "y": 5000,
        "wires": []
    },
    {
        "id": "881d213998fa6ef6",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "35bdc95fd4cb9f93",
        "name": "Webhooks Init",
        "info": "",
        "x": 630,
        "y": 4900,
        "wires": []
    },
    {
        "id": "98dcddedcff92b22",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "f58af42ff1414e91",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/lights/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 680,
        "y": 5280,
        "wires": [
            [
                "61621021cebab314"
            ]
        ]
    },
    {
        "id": "0679ed655a5bd1e9",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "f58af42ff1414e91",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 1230,
        "y": 5280,
        "wires": []
    },
    {
        "id": "61621021cebab314",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "f58af42ff1414e91",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smart_lights_smartplug.state', newState);\nflow.set('smart_lights_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 970,
        "y": 5280,
        "wires": [
            [
                "0679ed655a5bd1e9"
            ]
        ]
    },
    {
        "id": "f47c238c6fad3dc5",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "f58af42ff1414e91",
        "name": "webhook endpoint for smartlights",
        "info": "",
        "x": 690,
        "y": 5220,
        "wires": []
    },
    {
        "id": "4762d134b369c283",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "49fdf93c9cf5b077",
        "name": "[POST] Smartplug Webhook",
        "url": "home/1/smartplug/ac/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1600,
        "y": 5280,
        "wires": [
            [
                "4a312499b3618828"
            ]
        ]
    },
    {
        "id": "bdc3df59db8e772c",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "49fdf93c9cf5b077",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 2170,
        "y": 5280,
        "wires": []
    },
    {
        "id": "4a312499b3618828",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "49fdf93c9cf5b077",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1890,
        "y": 5280,
        "wires": [
            [
                "bdc3df59db8e772c"
            ]
        ]
    },
    {
        "id": "d3aa7a99a762cc0b",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "49fdf93c9cf5b077",
        "name": "webhook endpoint for AC",
        "info": "",
        "x": 1590,
        "y": 5220,
        "wires": []
    },
    {
        "id": "42edc2bd9a812b11",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "972914b7e4b5ae7b",
        "name": "Handle webhook state",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2780,
        "y": 5280,
        "wires": [
            [
                "dd16030f7650e7bf"
            ]
        ]
    },
    {
        "id": "dd16030f7650e7bf",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "972914b7e4b5ae7b",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 3050,
        "y": 5280,
        "wires": []
    },
    {
        "id": "50a6020a172ed08e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "972914b7e4b5ae7b",
        "name": "webhook endpoint for dehumidifier",
        "info": "",
        "x": 2520,
        "y": 5220,
        "wires": []
    },
    {
        "id": "d04493879af518db",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "972914b7e4b5ae7b",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/1/smartplug/dehumidifier/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 2500,
        "y": 5280,
        "wires": [
            [
                "42edc2bd9a812b11"
            ]
        ]
    },
    {
        "id": "4ec3b84d91efdfa1",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "a1e2ae6405173e77",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/2/smartplug/cooker/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1520,
        "y": 5640,
        "wires": [
            [
                "44b4f3eeb0fd8991"
            ]
        ]
    },
    {
        "id": "44b4f3eeb0fd8991",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "a1e2ae6405173e77",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('cooker_smartplug.state', newState);\nflow.set('cooker_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1780,
        "y": 5640,
        "wires": [
            [
                "2830d15e6f0b06d6"
            ]
        ]
    },
    {
        "id": "2830d15e6f0b06d6",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "a1e2ae6405173e77",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 2020,
        "y": 5640,
        "wires": []
    },
    {
        "id": "c5eda7a957571c47",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "a1e2ae6405173e77",
        "name": "webhook endpoint for cooker",
        "info": "",
        "x": 1520,
        "y": 5580,
        "wires": []
    },
    {
        "id": "cfdbe07da53dc764",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "982b3547b8fb9afd",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/2/smartplug/thermostat/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 680,
        "y": 5640,
        "wires": [
            [
                "a3485a49b709aa57"
            ]
        ]
    },
    {
        "id": "a3485a49b709aa57",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "982b3547b8fb9afd",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('thermostat_smartplug.state', newState);\nflow.set('thermostat_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 5640,
        "wires": [
            [
                "1620537b0c6c0be3"
            ]
        ]
    },
    {
        "id": "1620537b0c6c0be3",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "982b3547b8fb9afd",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 1180,
        "y": 5640,
        "wires": []
    },
    {
        "id": "6939265e9d8c682b",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "982b3547b8fb9afd",
        "name": "webhook endpoint for thermostat",
        "info": "",
        "x": 690,
        "y": 5580,
        "wires": []
    },
    {
        "id": "c83af6cadf64cac9",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "3eaaf78597f01e4f",
        "name": "[POST] Smartplug laundry",
        "url": "/home/2/smartplug/laundry/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 2350,
        "y": 5640,
        "wires": [
            [
                "64a2c3904b37e282"
            ]
        ]
    },
    {
        "id": "64a2c3904b37e282",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "3eaaf78597f01e4f",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('laundry_smartplug.state', newState);\nflow.set('laundry_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2630,
        "y": 5640,
        "wires": [
            [
                "44841ee7fcec441a"
            ]
        ]
    },
    {
        "id": "44841ee7fcec441a",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "3eaaf78597f01e4f",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 2910,
        "y": 5640,
        "wires": []
    },
    {
        "id": "909650fa993b1869",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "3eaaf78597f01e4f",
        "name": "",
        "info": "",
        "x": 2300,
        "y": 5580,
        "wires": []
    },
    {
        "id": "5a84b0fe36b56f84",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "ddf6fcec6341cd57",
        "name": "Webhooks Init",
        "info": "",
        "x": 630,
        "y": 5480,
        "wires": []
    },
    {
        "id": "eedddda6a3d17944",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "d65619283ad53f59",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/2/smartplug/lights/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 680,
        "y": 5860,
        "wires": [
            [
                "5a5a9ce3040d8699"
            ]
        ]
    },
    {
        "id": "6301a181be35c4c9",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "d65619283ad53f59",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 1230,
        "y": 5860,
        "wires": []
    },
    {
        "id": "5a5a9ce3040d8699",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "d65619283ad53f59",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smart_lights_smartplug.state', newState);\nflow.set('smart_lights_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 970,
        "y": 5860,
        "wires": [
            [
                "6301a181be35c4c9"
            ]
        ]
    },
    {
        "id": "8e95f35d0436ea16",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "d65619283ad53f59",
        "name": "webhook endpoint for smartlights",
        "info": "",
        "x": 690,
        "y": 5800,
        "wires": []
    },
    {
        "id": "1cedb53bb0354879",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "7f10d8530156d37a",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/2/smartplug/ac/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 1600,
        "y": 5860,
        "wires": [
            [
                "0f04c3723b67d042"
            ]
        ]
    },
    {
        "id": "d043fc5627a0780a",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "7f10d8530156d37a",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 2170,
        "y": 5860,
        "wires": []
    },
    {
        "id": "0f04c3723b67d042",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "7f10d8530156d37a",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1890,
        "y": 5860,
        "wires": [
            [
                "d043fc5627a0780a"
            ]
        ]
    },
    {
        "id": "a8d84f78ea0b6cf9",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "7f10d8530156d37a",
        "name": "webhook endpoint for AC",
        "info": "",
        "x": 1590,
        "y": 5800,
        "wires": []
    },
    {
        "id": "09d5f9fb24bb348a",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "c83e83af9bfc71a9",
        "name": "Handle webhook state",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2780,
        "y": 5860,
        "wires": [
            [
                "49c8235493e7fbd5"
            ]
        ]
    },
    {
        "id": "49c8235493e7fbd5",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "c83e83af9bfc71a9",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 3050,
        "y": 5860,
        "wires": []
    },
    {
        "id": "75e0402921d75ea7",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "c83e83af9bfc71a9",
        "name": "webhook endpoint for dehumidifier",
        "info": "",
        "x": 2520,
        "y": 5800,
        "wires": []
    },
    {
        "id": "c7afb14084bd80fc",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "c83e83af9bfc71a9",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/2/smartplug/dehumidifier/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 2500,
        "y": 5860,
        "wires": [
            [
                "09d5f9fb24bb348a"
            ]
        ]
    },
    {
        "id": "17f218a897f77e4f",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "cfaf2d1ab4ed592e",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/3/smartplug/cooker/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 4400,
        "y": 5060,
        "wires": [
            [
                "161fcdeaf77184c0"
            ]
        ]
    },
    {
        "id": "161fcdeaf77184c0",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "cfaf2d1ab4ed592e",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('cooker_smartplug.state', newState);\nflow.set('cooker_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4660,
        "y": 5060,
        "wires": [
            [
                "84e40799bf763f92"
            ]
        ]
    },
    {
        "id": "84e40799bf763f92",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "cfaf2d1ab4ed592e",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 4900,
        "y": 5060,
        "wires": []
    },
    {
        "id": "bee54f67d03b6608",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "cfaf2d1ab4ed592e",
        "name": "webhook endpoint for cooker",
        "info": "",
        "x": 4400,
        "y": 5000,
        "wires": []
    },
    {
        "id": "759f6cb9d8bb72ba",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "1a58d6157f9adf88",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/3/smartplug/thermostat/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 3560,
        "y": 5060,
        "wires": [
            [
                "95a488b5be5cf27e"
            ]
        ]
    },
    {
        "id": "95a488b5be5cf27e",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "1a58d6157f9adf88",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('thermostat_smartplug.state', newState);\nflow.set('thermostat_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3820,
        "y": 5060,
        "wires": [
            [
                "5acc1b766c0cc841"
            ]
        ]
    },
    {
        "id": "5acc1b766c0cc841",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "1a58d6157f9adf88",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 4060,
        "y": 5060,
        "wires": []
    },
    {
        "id": "a668221ade4bdf96",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "1a58d6157f9adf88",
        "name": "webhook endpoint for thermostat",
        "info": "",
        "x": 3570,
        "y": 5000,
        "wires": []
    },
    {
        "id": "1a76f2b4cf89eb44",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "705258e36df270ef",
        "name": "[POST] Smartplug laundry",
        "url": "/home/3/smartplug/laundry/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 5230,
        "y": 5060,
        "wires": [
            [
                "9ad1f6496323450b"
            ]
        ]
    },
    {
        "id": "9ad1f6496323450b",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "705258e36df270ef",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('laundry_smartplug.state', newState);\nflow.set('laundry_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5510,
        "y": 5060,
        "wires": [
            [
                "6de2d25bb2efdf97"
            ]
        ]
    },
    {
        "id": "6de2d25bb2efdf97",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "705258e36df270ef",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 5790,
        "y": 5060,
        "wires": []
    },
    {
        "id": "0f43654b38248f93",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "705258e36df270ef",
        "name": "",
        "info": "",
        "x": 5180,
        "y": 5000,
        "wires": []
    },
    {
        "id": "808258ff93241f1c",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "4cdaba113baf505c",
        "name": "Webhooks Init",
        "info": "",
        "x": 3510,
        "y": 4900,
        "wires": []
    },
    {
        "id": "2b9e58857ebc7959",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "0be1f07c52dc1360",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/3/smartplug/lights/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 3560,
        "y": 5280,
        "wires": [
            [
                "1f27fef1b7b6ef25"
            ]
        ]
    },
    {
        "id": "5f85b37753537a41",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "0be1f07c52dc1360",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 4110,
        "y": 5280,
        "wires": []
    },
    {
        "id": "1f27fef1b7b6ef25",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "0be1f07c52dc1360",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smart_lights_smartplug.state', newState);\nflow.set('smart_lights_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3850,
        "y": 5280,
        "wires": [
            [
                "5f85b37753537a41"
            ]
        ]
    },
    {
        "id": "2c471b1c7ac53748",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "0be1f07c52dc1360",
        "name": "webhook endpoint for smartlights",
        "info": "",
        "x": 3570,
        "y": 5220,
        "wires": []
    },
    {
        "id": "8e1aefb81c508c7c",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "b7be9ec65621baf7",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/3/smartplug/ac/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 4480,
        "y": 5280,
        "wires": [
            [
                "0dbcde175aafd49e"
            ]
        ]
    },
    {
        "id": "e7d95675e409bdea",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "b7be9ec65621baf7",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 5050,
        "y": 5280,
        "wires": []
    },
    {
        "id": "0dbcde175aafd49e",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "b7be9ec65621baf7",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4770,
        "y": 5280,
        "wires": [
            [
                "e7d95675e409bdea"
            ]
        ]
    },
    {
        "id": "7a9f05c84e0ab90d",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "b7be9ec65621baf7",
        "name": "webhook endpoint for AC",
        "info": "",
        "x": 4470,
        "y": 5220,
        "wires": []
    },
    {
        "id": "cb0aee241e435de7",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "fbc690740f474539",
        "name": "Handle webhook state",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5660,
        "y": 5280,
        "wires": [
            [
                "a366c37c17aa525f"
            ]
        ]
    },
    {
        "id": "a366c37c17aa525f",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "fbc690740f474539",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 5930,
        "y": 5280,
        "wires": []
    },
    {
        "id": "3408f95de3559d99",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "fbc690740f474539",
        "name": "webhook endpoint for dehumidifier",
        "info": "",
        "x": 5400,
        "y": 5220,
        "wires": []
    },
    {
        "id": "b2a3a37ff77ff2e2",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "fbc690740f474539",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/3/smartplug/dehumidifier/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 5380,
        "y": 5280,
        "wires": [
            [
                "cb0aee241e435de7"
            ]
        ]
    },
    {
        "id": "93052a3c407a8c1a",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "40bb858891246b0b",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/4/smartplug/cooker/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 4380,
        "y": 5660,
        "wires": [
            [
                "077b712be3471530"
            ]
        ]
    },
    {
        "id": "077b712be3471530",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "40bb858891246b0b",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('cooker_smartplug.state', newState);\nflow.set('cooker_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4640,
        "y": 5660,
        "wires": [
            [
                "492c428ea3853a0b"
            ]
        ]
    },
    {
        "id": "492c428ea3853a0b",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "40bb858891246b0b",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 4880,
        "y": 5660,
        "wires": []
    },
    {
        "id": "95a31e17647f25d6",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "40bb858891246b0b",
        "name": "webhook endpoint for cooker",
        "info": "",
        "x": 4380,
        "y": 5600,
        "wires": []
    },
    {
        "id": "6fb920fa5977b541",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "08e3cc829ae88798",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/4/smartplug/thermostat/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 3540,
        "y": 5660,
        "wires": [
            [
                "8e9e6d3883076acb"
            ]
        ]
    },
    {
        "id": "8e9e6d3883076acb",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "08e3cc829ae88798",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('thermostat_smartplug.state', newState);\nflow.set('thermostat_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3800,
        "y": 5660,
        "wires": [
            [
                "585f5f73ceb7251f"
            ]
        ]
    },
    {
        "id": "585f5f73ceb7251f",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "08e3cc829ae88798",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 4040,
        "y": 5660,
        "wires": []
    },
    {
        "id": "f5bd8a41702acc12",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "08e3cc829ae88798",
        "name": "webhook endpoint for thermostat",
        "info": "",
        "x": 3550,
        "y": 5600,
        "wires": []
    },
    {
        "id": "0712e81e13a0e86f",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "e5c02bc1f2c77821",
        "name": "[POST] Smartplug laundry",
        "url": "/home/4/smartplug/laundry/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 5210,
        "y": 5660,
        "wires": [
            [
                "2f9d4e3236742937"
            ]
        ]
    },
    {
        "id": "2f9d4e3236742937",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "e5c02bc1f2c77821",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('laundry_smartplug.state', newState);\nflow.set('laundry_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5490,
        "y": 5660,
        "wires": [
            [
                "e9290239fee4f7ae"
            ]
        ]
    },
    {
        "id": "e9290239fee4f7ae",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "e5c02bc1f2c77821",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 5770,
        "y": 5660,
        "wires": []
    },
    {
        "id": "d5de36b14ab7d47e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "e5c02bc1f2c77821",
        "name": "",
        "info": "",
        "x": 5160,
        "y": 5600,
        "wires": []
    },
    {
        "id": "5a86b945d935ae80",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "3c9b727746d70288",
        "name": "Webhooks Init",
        "info": "",
        "x": 3490,
        "y": 5500,
        "wires": []
    },
    {
        "id": "227a6a9e6b8a1df1",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "a8cab455c13d5f12",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/4/smartplug/lights/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 3540,
        "y": 5880,
        "wires": [
            [
                "47f9a99caa49d461"
            ]
        ]
    },
    {
        "id": "2598a7ed9ff7e1b8",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "a8cab455c13d5f12",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 4090,
        "y": 5880,
        "wires": []
    },
    {
        "id": "47f9a99caa49d461",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "a8cab455c13d5f12",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smart_lights_smartplug.state', newState);\nflow.set('smart_lights_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3830,
        "y": 5880,
        "wires": [
            [
                "2598a7ed9ff7e1b8"
            ]
        ]
    },
    {
        "id": "d1513398d607369e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "a8cab455c13d5f12",
        "name": "webhook endpoint for smartlights",
        "info": "",
        "x": 3550,
        "y": 5820,
        "wires": []
    },
    {
        "id": "5a0d7892cba76fdd",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "a2807e7892796e75",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/4/smartplug/ac/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 4460,
        "y": 5880,
        "wires": [
            [
                "4ac58ffe08d4cc7c"
            ]
        ]
    },
    {
        "id": "a64cacd9f63cef3c",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "a2807e7892796e75",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 5030,
        "y": 5880,
        "wires": []
    },
    {
        "id": "4ac58ffe08d4cc7c",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "a2807e7892796e75",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4750,
        "y": 5880,
        "wires": [
            [
                "a64cacd9f63cef3c"
            ]
        ]
    },
    {
        "id": "3238b39247b1385a",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "a2807e7892796e75",
        "name": "webhook endpoint for AC",
        "info": "",
        "x": 4450,
        "y": 5820,
        "wires": []
    },
    {
        "id": "f106ef98e4c6237c",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "cdaf6e3a19441667",
        "name": "Handle webhook state",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('ac_smartplug.state', newState);\nflow.set('ac_smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5640,
        "y": 5880,
        "wires": [
            [
                "28eef0dd6c1a6686"
            ]
        ]
    },
    {
        "id": "28eef0dd6c1a6686",
        "type": "http response",
        "z": "2a4e2856b37c3f19",
        "g": "cdaf6e3a19441667",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {},
        "x": 5910,
        "y": 5880,
        "wires": []
    },
    {
        "id": "bb7f0ce563a224b4",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "cdaf6e3a19441667",
        "name": "webhook endpoint for dehumidifier",
        "info": "",
        "x": 5380,
        "y": 5820,
        "wires": []
    },
    {
        "id": "23bd70206db5b309",
        "type": "http in",
        "z": "2a4e2856b37c3f19",
        "g": "cdaf6e3a19441667",
        "name": "[POST] Smartplug Webhook",
        "url": "/home/4/smartplug/dehumidifier/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 5360,
        "y": 5880,
        "wires": [
            [
                "f106ef98e4c6237c"
            ]
        ]
    },
    {
        "id": "4d1e2166731b930e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "f9977bae9b3b4e4c",
        "name": "Webhooks",
        "info": "",
        "x": 520,
        "y": 4740,
        "wires": []
    },
    {
        "id": "9ca34d0fa78dc4e6",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Total Energy Calculator",
        "func": "let devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\nlet hours = flow.get('hours') || 1; // time period in hours\n\n// Sum all device energy values\nlet totalW = devices.reduce((sum, d) => sum + (flow.get(`energy.${d}`) || 0), 0);\nlet totalKWh = totalW * hours / 1000;\n\n// Round and prepare output\nmsg.totalEnergy = `${totalKWh.toFixed(3)} kWh`;\n\n// --- Node status display ---\nlet color = \"green\";\nlet shape = \"dot\";\nlet text = `Total: ${totalKWh.toFixed(3)} kWh`;\n\nif (totalKWh === 0) {\n    color = \"grey\";\n    shape = \"ring\";\n    text = \"No energy recorded\";\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// Output message\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3290,
        "y": 820,
        "wires": [
            [
                "871d0abcb01cdc68",
                "05153a2d3b6cdfe4"
            ]
        ]
    },
    {
        "id": "871d0abcb01cdc68",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "Total Energy Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 3430,
        "y": 980,
        "wires": []
    },
    {
        "id": "5c9a4c2cea348b1c",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "35c69ea124d4d0e1",
        "name": "AC Telemetry",
        "func": "// === Air Conditioner Telemetry Simulator (Smart Plug Controlled) ===\n\n// --- Check Smart Plug state ---\nconst plugState = global.get('acState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution when AC plug is off\n}\n\n// --- Environment values ---\nlet envTemp = parseFloat(msg.payload.temperature || 25);\nlet envHumidity = msg.payload.humidity || 50;\n\n// --- Persistent setpoint (holds same for 1 hour) ---\nlet setpoint = flow.get('ac.setpoint');\nlet setpointTimer = flow.get('ac.setpointTimer') || 0;\n\n// Initialize or refresh setpoint every 3600 simulated seconds\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\nsetpointTimer += tickDuration;\n\nif (!setpoint || setpointTimer >= 3600) {\n    setpoint = Math.floor(16 + Math.random() * 15); // 1630C\n    setpointTimer = 0;\n}\n\n// --- Current temperature drift ---\nlet current = flow.get('ac.currentTemp') || envTemp;\ncurrent += (Math.random() - 0.5) * 0.3; // small drift 0.15C\n\n// --- Determine AC mode ---\nlet mode = 'idle';\nlet currentPower = 0; // Watts\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    currentPower = 1200; // cooling\n    current -= 0.5;\n} else if (current < setpoint - 1) {\n    mode = 'heat';\n    currentPower = 2000; // heating\n    current += 0.5;\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.ac') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (currentPower > 0) energy += wattToKwh(currentPower, tickDuration);\n\n// --- Save state ---\nflow.set('ac.setpoint', setpoint);\nflow.set('ac.setpointTimer', setpointTimer);\nflow.set('ac.currentTemp', current);\nflow.set('energy.ac', energy);\n\n// --- Node status feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (mode === 'cool') {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else if (mode === 'heat') {\n    color = \"red\";\n    shape = \"dot\";\n    text = `Heating | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Idle | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"ac\",\n    power: plugState,             // on/off from smart plug\n    temperature: parseFloat(current.toFixed(1)),\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    currentPower: currentPower,   // instantaneous Watts\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\",\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2160,
        "y": 560,
        "wires": [
            [
                "b40c2ba16a9e0b97"
            ]
        ]
    },
    {
        "id": "b40c2ba16a9e0b97",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "35c69ea124d4d0e1",
        "name": "AC AsyncAPI",
        "x": 2410,
        "y": 560,
        "wires": [
            [
                "537c143553dbf431",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "537c143553dbf431",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "35c69ea124d4d0e1",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2610,
        "y": 540,
        "wires": []
    },
    {
        "id": "a3e425c9de103f33",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "35c69ea124d4d0e1",
        "name": "AC Device",
        "info": "",
        "x": 2140,
        "y": 500,
        "wires": []
    },
    {
        "id": "c95c0493b1cf1564",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "eb32d2deafc74169",
        "name": "Lights Telemetry",
        "func": "// === Smart Light Telemetry Simulator (Controlled by Smart Plug) ===\n\n// --- Check Smart Plug state first ---\nconst plugState = global.get('lightState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop simulation when plug is off\n}\n\n// --- Environment info ---\nlet envTemp = parseFloat(msg.payload.temperature || 22);\nlet envHumidity = msg.payload.humidity || 45;\nlet envLight = msg.payload.lightIntensity || 50;\n\n// --- Threshold for turning lights ON/OFF (0100) ---\nconst lightThreshold = 30;\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// --- Light behavior when ON ---\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0; // W\nenergy += (power / 1000) * (tickSeconds / 3600); // convert to kWh\nflow.set('energy.light', parseFloat(energy.toFixed(3)));\n\n// --- Node status for dashboard ---\nlet colorStatus = state === \"ON\" ? \"green\" : \"red\";\nlet shape = state === \"ON\" ? \"dot\" : \"ring\";\nlet text = `${state} | ${power.toFixed(1)} W`;\n\nnode.status({ fill: colorStatus, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"light\",\n    power: plugState, // shows if plug is ON/OFF\n    state: state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    voltage: 230,\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2160,
        "y": 780,
        "wires": [
            [
                "3adc24d8a0a778e0"
            ]
        ]
    },
    {
        "id": "3adc24d8a0a778e0",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "eb32d2deafc74169",
        "name": "Lights AsyncAPI",
        "x": 2420,
        "y": 780,
        "wires": [
            [
                "d9792bbed9e9637c",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "d9792bbed9e9637c",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "eb32d2deafc74169",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2650,
        "y": 740,
        "wires": []
    },
    {
        "id": "c7d47440a9c4d1f0",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "eb32d2deafc74169",
        "name": "Lights",
        "info": "",
        "x": 2130,
        "y": 720,
        "wires": []
    },
    {
        "id": "a6a9daf27ee3ffec",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "f1b6a5525b0fd9d0",
        "name": "Fridge Telemetry",
        "func": "// === Fridge & Freezer Telemetry Simulator (Safe Temperatures) ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;     // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") ?? fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") ?? freezerSet + (Math.random() * 2 - 1);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;  // seconds per tick\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);   // 0.2C\nfreezerTemp += (Math.random() * 0.6 - 0.3);  // 0.3C\n\n// Compressor state logic\nlet compressor = \"OFF\";\nlet currentPower = 5; // idle watts\n\nif (fridgeTemp > fridgeSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3;  // small decrement per tick\n    if (fridgeTemp < fridgeSet) fridgeTemp = fridgeSet; // prevent overcooling\n    currentPower = 150;\n}\n\nif (freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    freezerTemp -= 0.5;\n    if (freezerTemp < freezerSet) freezerTemp = freezerSet; // prevent overcooling\n    currentPower = 150;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\nenergy += wattToKwh(currentPower, tickSeconds);\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// --- Node status visual feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (doorStatus !== \"closed\") {\n    color = \"red\";\n    shape = \"dot\";\n    text = ` Door Open (${doorStatus.replace(\"_\", \" \")}) | ${currentPower} W`;\n} else if (compressor === \"ON\") {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling ON | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Stable | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: currentPower, // instantaneous W\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2170,
        "y": 1000,
        "wires": [
            [
                "d91b91e8f5862d84"
            ]
        ]
    },
    {
        "id": "d91b91e8f5862d84",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "f1b6a5525b0fd9d0",
        "name": "Fridge AsyncAPI",
        "x": 2420,
        "y": 1000,
        "wires": [
            [
                "ad2e9a97f7bbfb84",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "ad2e9a97f7bbfb84",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "f1b6a5525b0fd9d0",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2680,
        "y": 1020,
        "wires": []
    },
    {
        "id": "03b6edb096f17e19",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "f1b6a5525b0fd9d0",
        "name": "Fridge Device",
        "info": "",
        "x": 2150,
        "y": 940,
        "wires": []
    },
    {
        "id": "180a9cb7fc690201",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "add8e9250cbeec27",
        "name": "Launder AsyncAPI",
        "x": 2410,
        "y": 1240,
        "wires": [
            [
                "2015e080f5172133",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "2015e080f5172133",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "add8e9250cbeec27",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2660,
        "y": 1260,
        "wires": []
    },
    {
        "id": "92d40a75ccfec573",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "add8e9250cbeec27",
        "name": "Laundry Telemetry",
        "func": "// --- Full Washing Machine Cycle Simulator ---\n\n// --- Simulation scale ---\nconst scale = global.get(\"simulationScale\") || 60; // seconds per tick\nconst tickSeconds = 60 * scale; // 1 tick = 1 minute\n\n// --- Check Smart Plug / power ---\nconst plugState = global.get('laundryState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  cycle paused' });\n    return null;\n}\n\n// --- Load persistent state ---\nlet phase = flow.get('laundry.phase') || 'idle';\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || (plugState === 'on' ? true:false);\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\nlet mode = flow.get('laundry.mode') || 'normal';\n\n// --- Phase durations per mode (minutes) ---\nconst modeDurations = {\n    eco: { filling:5, washing:60, rinsing:15, spinning:10, drying:30 },\n    normal: { filling:5, washing:45, rinsing:15, spinning:10, drying:20 },\n    quick: { filling:3, washing:20, rinsing:10, spinning:5, drying:10 },\n    heavy: { filling:5, washing:75, rinsing:20, spinning:15, drying:40 },\n    delicate: { filling:5, washing:30, rinsing:15, spinning:5, drying:10 }\n};\n\n// --- Power per phase (Watts) ---\nconst phasePower = { filling:50, washing:500, rinsing:300, spinning:800, drying:2000, completed:0 };\n\n// --- Start new cycle if idle ---\nif (!running && phase === 'idle') {\n    running = true;\n    const modes = Object.keys(modeDurations);\n    mode = modes[Math.floor(Math.random() * modes.length)];\n    phase = 'filling';\n    remainingTime = modeDurations[mode][phase];\n}\n\n// --- Progress cycle ---\nif (running) {\n    remainingTime -= 1 * scale;\n\n    if (remainingTime <= 0) {\n        const phases = ['filling','washing','rinsing','spinning','drying'];\n        const currentIndex = phases.indexOf(phase);\n\n        if (currentIndex < phases.length - 1) {\n            phase = phases[currentIndex + 1];\n            remainingTime = modeDurations[mode][phase];\n        } else {\n            // Cycle completed\n            phase = 'completed';\n            running = false;\n            remainingTime = 0;\n        }\n    }\n}\n\n// --- Instantaneous power ---\nlet currentPower = running ? phasePower[phase] || 0 : 0;\n\n// --- Energy usage (kWh) ---\nenergy += (currentPower / 1000) * (tickSeconds / 3600);\n\n// --- Water usage ---\nif (['filling','washing','rinsing'].includes(phase)) {\n    waterUsed += Math.random() * 0.5 * scale;\n}\n\n// --- Simulated values ---\nlet waterTemp = (phase === 'washing') ? 40 + Math.random()*10 : 25;\nlet spinSpeed = (phase === 'spinning') ? 800 + Math.floor(Math.random()*400) : 0;\nlet loadWeight = 5 + Math.random()*3;\n\n// --- Door status ---\nlet doorStatus = (running || phase === 'completed') ? 'locked' : 'closed';\n\n// --- Save state ---\nflow.set('laundry.phase', phase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\nflow.set('laundry.mode', mode);\n\n// --- Node status feedback ---\nlet color = \"grey\", shape = \"ring\", text = \"\";\n\nif (!running && phase === 'completed') {\n    color = 'green';\n    shape = 'ring';\n    text = ` Cycle Completed | 0 W`;\n} else if (running) {\n    color = 'blue';\n    shape = 'dot';\n    text = `${phase.toUpperCase()} | ${remainingTime} min left | ${currentPower} W`;\n}\n\nif (doorStatus === 'open') {\n    color = 'red';\n    text = ' Door Open';\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: 'laundry',\n    power: 'ON',\n    running,\n    mode,\n    phase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    currentPower: currentPower, // instantaneous Watts\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2170,
        "y": 1240,
        "wires": [
            [
                "180a9cb7fc690201"
            ]
        ]
    },
    {
        "id": "45c8466203b752fa",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "add8e9250cbeec27",
        "name": "Laundry Device",
        "info": "",
        "x": 2160,
        "y": 1180,
        "wires": []
    },
    {
        "id": "f8643f33040aff1a",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "766e712ef6fc6ed8",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator (Auto Stop/Start by Humidity) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickMinutes = 1 * scale; // 1 tick = 1 minute\n\n// --- Persistent state ---\nlet running = flow.get('dehumidifier.running');\nif (running === undefined) running = true;\n\nlet tankLevel = flow.get('dehumidifier.tankLevel') || 0;\nlet elapsedMinutes = flow.get('dehumidifier.elapsedMinutes') || 0;\n\n// Fixed mode and fan speed\nconst mode = \"auto\";\nconst fanSpeed = \"medium\";\n\n// Random environment humidity\nlet environmentHumidity = msg.payload.humidity || 45; // current room humidity\n\n// --- Auto Stop/Start logic ---\nif (environmentHumidity <= 50) {\n    running = false; // stop dehumidifier\n} else if (environmentHumidity > 50) {\n    running = true;  // start dehumidifier\n}\n\n// Power settings\nconst powerWatts = running ? 200 : 0; // instantaneous Watts\n\n// --- Run logic ---\nif (running) {\n    // Increment elapsed time\n    elapsedMinutes += tickMinutes;\n\n    // Gradual tank filling step-by-step (small random increment per minute)\n    const humidityRemoved = parseFloat((Math.random() * 2 + 0.5).toFixed(2)); // 0.52.5% per tick\n    tankLevel = Math.min(100, tankLevel + humidityRemoved);\n\n    // Reset tank if full or after 60 min\n    if (tankLevel >= 100 || elapsedMinutes >= 60) {\n        tankLevel = 0;\n        elapsedMinutes = 0;\n    }\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.dehumidifier') || 0;\nfunction wattToKwh(powerWatts, minutes) {\n    return (powerWatts / 1000) * (minutes / 60);\n}\nif (powerWatts > 0) energy += wattToKwh(powerWatts, tickMinutes);\n\n// --- Save persistent state ---\nflow.set('dehumidifier.running', running);\nflow.set('dehumidifier.tankLevel', tankLevel);\nflow.set('dehumidifier.elapsedMinutes', elapsedMinutes);\nflow.set('energy.dehumidifier', energy);\n\n// --- Node status feedback ---\nlet color = running ? \"blue\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\n\n// Calculate progress as percentage of 60 min run\nconst progressPercent = Math.min(100, Math.round((elapsedMinutes / 60) * 100));\nlet text = running \n    ? `${environmentHumidity}% | ${mode.toUpperCase()} | ${powerWatts} W `\n    : `${environmentHumidity}% | OFF | 0 W `;\n\n// Update node status\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    progressPercent: progressPercent,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: powerWatts,\n    humidity: environmentHumidity,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2180,
        "y": 1500,
        "wires": [
            [
                "d092ae53c0de247d"
            ]
        ]
    },
    {
        "id": "d092ae53c0de247d",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "766e712ef6fc6ed8",
        "name": "Dehumidifier AsyncAPI",
        "x": 2430,
        "y": 1500,
        "wires": [
            [
                "fa6b8af412bfc71c",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "fa6b8af412bfc71c",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "766e712ef6fc6ed8",
        "name": "Dehumidifier Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 2740,
        "y": 1480,
        "wires": []
    },
    {
        "id": "1acac3b9836401a6",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "766e712ef6fc6ed8",
        "name": "Dehimidifier Device",
        "info": "",
        "x": 2170,
        "y": 1440,
        "wires": []
    },
    {
        "id": "77c16da5581cc176",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "2cc7b89db7db8ed8",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator (30 min Standard Mode) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickSeconds = 1 * scale; // 1 tick = 1 real second\n\n// Check Smart Plug state\nconst plugState = global.get('cookerState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null;\n}\n\nlet running = true;\n\n// Standard fixed mode\nconst mode = \"bake\"; // standard mode\n\n// Persistent timer in seconds\nlet remainingSeconds = flow.get('cooker.remainingSeconds');\nif (!remainingSeconds) {\n    remainingSeconds = 30 * 60; // 30 minutes in seconds\n}\n\n// Update timer\nif (running) {\n    remainingSeconds = Math.max(0, remainingSeconds - tickSeconds);\n    if (remainingSeconds === 0) running = false;\n}\n\n// Temperatures\nconst currentTemp = running ? 180 : 25; // standard bake temp\nconst setTemp = running ? 200 : 0;\n\n// Instantaneous power in Watts\nconst powerWatts = running ? 1500 : 0;\n\n// Energy tracking in kWh\nlet energy = flow.get('energy.cooker') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (running) energy += wattToKwh(powerWatts, tickSeconds);\nflow.set('energy.cooker', energy);\n\n// Save persistent timer\nflow.set('cooker.remainingSeconds', remainingSeconds);\n\n// --- Node status feedback ---\nlet color = running ? \"orange\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\nlet minutesLeft = Math.ceil(remainingSeconds / 60); // only minutes, round up\n\nlet text = running \n    ? `${mode.toUpperCase()} | ${currentTemp}C  ${setTemp}C | ${minutesLeft} min left | ${powerWatts} W`\n    : `OFF | Temp: ${currentTemp}C | 0 W`;\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode,\n    setTemp,\n    currentTemp,\n    timerMinutes: minutesLeft,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2170,
        "y": 1720,
        "wires": [
            [
                "85fbb0fb9fc06d9d"
            ]
        ]
    },
    {
        "id": "85fbb0fb9fc06d9d",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "2cc7b89db7db8ed8",
        "name": "Cooker AsyncAPI",
        "x": 2510,
        "y": 1720,
        "wires": [
            [
                "8bd9eb5e71a649da",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "8bd9eb5e71a649da",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "2cc7b89db7db8ed8",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2760,
        "y": 1720,
        "wires": []
    },
    {
        "id": "8f0eaecd1551e0eb",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "2cc7b89db7db8ed8",
        "name": "Cooker Device",
        "info": "",
        "x": 2160,
        "y": 1660,
        "wires": []
    },
    {
        "id": "a299eab618e51d01",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "13ffcd31cb74f7a5",
        "name": "Thermostat Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2690,
        "y": 300,
        "wires": []
    },
    {
        "id": "f57f26837163c20f",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "13ffcd31cb74f7a5",
        "name": " Thermostat AsyncAPI",
        "x": 2440,
        "y": 360,
        "wires": [
            [
                "a299eab618e51d01",
                "9ca34d0fa78dc4e6"
            ]
        ]
    },
    {
        "id": "80b5856b8b44a209",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "13ffcd31cb74f7a5",
        "name": "Thermostat Telemetry",
        "func": "// Check Smart Plug state before running\nconst plugState = global.get('thermostatState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution\n}\n\n// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature || 22); // default 22C\nlet envHumidity = msg.payload.humidity || 45;\n\n// Desired temperature\nconst desired = Math.floor(20 + Math.random() * 11);\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nlet currentPower = 0; // W\n\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5;\n    currentPower = 2000; // heater power in W\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5;\n    currentPower = 1200; // AC power in W\n}\n\n// Energy tracking (cumulative kWh)\nlet energy = flow.get('energy.thermostat') || 0;\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\n// Add to cumulative energy\nenergy += wattToKwh(currentPower, tickDuration);\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// --- Node status for visual feedback ---\nlet color = 'grey';\nlet shape = 'ring';\nlet text = 'Idle';\n\nif (mode === 'heat') {\n    color = 'red';\n    shape = 'dot';\n    text = `HEAT | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else if (mode === 'cool') {\n    color = 'blue';\n    shape = 'dot';\n    text = `COOL | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else {\n    text = `IDLE | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    power: plugState,       // instantaneous W\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2180,
        "y": 360,
        "wires": [
            [
                "f57f26837163c20f"
            ]
        ]
    },
    {
        "id": "c508d61844094fd0",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "13ffcd31cb74f7a5",
        "name": "Thermostat Device",
        "info": "",
        "x": 2170,
        "y": 300,
        "wires": []
    },
    {
        "id": "ca4e2bae263dda8c",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "e549cfd9ad9549fa",
        "name": "SMARTHOME",
        "info": "",
        "x": 600,
        "y": 240,
        "wires": []
    },
    {
        "id": "52ca2a0dfa6037cd",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "28937a91c747bf27",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 950,
        "y": 280,
        "wires": []
    },
    {
        "id": "f0231521a927886e",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "28937a91c747bf27",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 950,
        "y": 340,
        "wires": [
            [
                "f9883bc397869284"
            ]
        ]
    },
    {
        "id": "d7fdef9ed5ae9dcc",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "28937a91c747bf27",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 940,
        "y": 410,
        "wires": [
            [
                "f9883bc397869284"
            ]
        ]
    },
    {
        "id": "a42bc0a8398047ed",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "28937a91c747bf27",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('thermostatState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 380,
        "wires": [
            [
                "80b5856b8b44a209"
            ]
        ]
    },
    {
        "id": "ba651d29ec6ead77",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "28937a91c747bf27",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1610,
        "y": 300,
        "wires": []
    },
    {
        "id": "f9883bc397869284",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "28937a91c747bf27",
        "name": "Thermostat webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setSmartPlugState",
            "hasOperationId": true,
            "path": "/smartplug/thermostat/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1240,
        "y": 380,
        "wires": [
            [
                "a42bc0a8398047ed",
                "ba651d29ec6ead77"
            ]
        ]
    },
    {
        "id": "e6d9f6fdd459b22a",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "3b54f4b88201ae9f",
        "name": "Smartplug for cooker",
        "info": "",
        "x": 910,
        "y": 1900,
        "wires": []
    },
    {
        "id": "500117f04bce8a47",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "3b54f4b88201ae9f",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 930,
        "y": 1960,
        "wires": [
            [
                "2b407dc7fe34c8b2"
            ]
        ]
    },
    {
        "id": "fbe79471c0614fb4",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "3b54f4b88201ae9f",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 920,
        "y": 2030,
        "wires": [
            [
                "2b407dc7fe34c8b2"
            ]
        ]
    },
    {
        "id": "2e3aca0c108ecd82",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "3b54f4b88201ae9f",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('cookerState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 2000,
        "wires": [
            [
                "77c16da5581cc176"
            ]
        ]
    },
    {
        "id": "0493104c020576f0",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "3b54f4b88201ae9f",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 1900,
        "wires": []
    },
    {
        "id": "2b407dc7fe34c8b2",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "3b54f4b88201ae9f",
        "name": "Cooker webhook",
        "configUrlNode": "742282c109ee77de",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setCookerPlugState",
            "hasOperationId": true,
            "path": "/smartplug/cooker/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1210,
        "y": 2000,
        "wires": [
            [
                "2e3aca0c108ecd82",
                "0493104c020576f0"
            ]
        ]
    },
    {
        "id": "b1fa08026e078a18",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "eab15c939712e89b",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 1110,
        "y": 940,
        "wires": [
            [
                "87cb19cfec07ba9a"
            ]
        ]
    },
    {
        "id": "87cb19cfec07ba9a",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "eab15c939712e89b",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60); // 1s = 1 minute\n}\n\n// --- Realistic Environment Base ---\nconst baseTemp = 22; // C\nconst baseHumidity = 70; // %\nconst hour = new Date().getHours(); // local time for light simulation\n\n// Get previous state\nlet currentTemp = flow.get('env.temperature') || baseTemp;\nlet currentHumidity = flow.get('env.humidity') || baseHumidity;\nlet currentLight = flow.get('env.lightIntensity') || 50;\n\n// --- Apply small drift ---\ncurrentTemp += (Math.random() * 0.4 - 0.2); // 0.2C\ncurrentHumidity += (Math.random() * 2 - 1);  // 1%\ncurrentHumidity = Math.max(20, Math.min(70, currentHumidity)); // clamp realistic\n// Light based on time of day\nif (hour >= 6 && hour < 18) {\n    currentLight = 70 + Math.floor(Math.random() * 30); // day\n} else {\n    currentLight = 0 + Math.floor(Math.random() * 20);  // night\n}\n\n// Save state for next tick\nflow.set('env.temperature', currentTemp);\nflow.set('env.humidity', currentHumidity);\nflow.set('env.lightIntensity', currentLight);\nflow.set('current_temp', currentTemp);\n\n// --- Output payload ---\nmsg.payload = {\n    environment: true,\n    temperature: currentTemp.toFixed(1),\n    humidity: currentHumidity.toFixed(1),\n    lightIntensity: currentLight,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\")\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1450,
        "y": 940,
        "wires": [
            [
                "5c9a4c2cea348b1c",
                "c95c0493b1cf1564",
                "a6a9daf27ee3ffec",
                "92d40a75ccfec573",
                "f8643f33040aff1a",
                "77c16da5581cc176",
                "80b5856b8b44a209",
                "0a9a43c67d298449"
            ]
        ]
    },
    {
        "id": "960ac81e8df06d55",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "eab15c939712e89b",
        "name": "Enviroment variables",
        "info": "",
        "x": 1100,
        "y": 880,
        "wires": []
    },
    {
        "id": "3d5921b2e8df14cc",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "9881ad96b9bcf2b7",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 920,
        "y": 1080,
        "wires": []
    },
    {
        "id": "4cac8f143c853724",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9881ad96b9bcf2b7",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 930,
        "y": 1140,
        "wires": [
            [
                "cd33060a7b4578bb"
            ]
        ]
    },
    {
        "id": "209e103485d9c873",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9881ad96b9bcf2b7",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 920,
        "y": 1210,
        "wires": [
            [
                "cd33060a7b4578bb"
            ]
        ]
    },
    {
        "id": "74162f6d16b97849",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "9881ad96b9bcf2b7",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('lightState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 1180,
        "wires": [
            [
                "c95c0493b1cf1564"
            ]
        ]
    },
    {
        "id": "91bdb99f8c62d5c7",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "9881ad96b9bcf2b7",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 1080,
        "wires": []
    },
    {
        "id": "cd33060a7b4578bb",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "9881ad96b9bcf2b7",
        "name": "",
        "configUrlNode": "f63fb066d1c65936",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setLightsPlugState",
            "hasOperationId": true,
            "path": "/smartplug/lights/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart Lights plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1230,
        "y": 1160,
        "wires": [
            [
                "74162f6d16b97849",
                "91bdb99f8c62d5c7"
            ],
            []
        ]
    },
    {
        "id": "e9be5ab258103312",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "95e834be6abfd0af",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 930,
        "y": 600,
        "wires": []
    },
    {
        "id": "f3c99bf9615369f6",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "95e834be6abfd0af",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 930,
        "y": 660,
        "wires": [
            [
                "696b0b010fbafce2"
            ]
        ]
    },
    {
        "id": "f8815c7583d75cb1",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "95e834be6abfd0af",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 920,
        "y": 730,
        "wires": [
            [
                "696b0b010fbafce2"
            ]
        ]
    },
    {
        "id": "9af1f16f7dea7e75",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "95e834be6abfd0af",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('acState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 700,
        "wires": [
            [
                "5c9a4c2cea348b1c"
            ]
        ]
    },
    {
        "id": "fa2213ec132bd4e0",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "95e834be6abfd0af",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 620,
        "wires": []
    },
    {
        "id": "696b0b010fbafce2",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "95e834be6abfd0af",
        "name": "",
        "configUrlNode": "d7b4d9ce6378ec33",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setACPlugState",
            "hasOperationId": true,
            "path": "/smartplug/ac/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    },
                    "temperature": {
                        "name": "temperature",
                        "activeFilter": ""
                    },
                    "mode": {
                        "name": "mode",
                        "activeFilter": ""
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart AC plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid parameters specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1220,
        "y": 660,
        "wires": [
            [
                "9af1f16f7dea7e75"
            ],
            [
                "fa2213ec132bd4e0"
            ]
        ]
    },
    {
        "id": "49322c719098076f",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "849f455c90b8193e",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 900,
        "y": 1320,
        "wires": []
    },
    {
        "id": "bff04f5fa84948f3",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "849f455c90b8193e",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 910,
        "y": 1380,
        "wires": [
            [
                "9828e7499122b338"
            ]
        ]
    },
    {
        "id": "1163ae440ff08857",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "849f455c90b8193e",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 900,
        "y": 1450,
        "wires": [
            [
                "9828e7499122b338"
            ]
        ]
    },
    {
        "id": "ccd4008bb9133664",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "849f455c90b8193e",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('laundryState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 1420,
        "wires": [
            [
                "92d40a75ccfec573"
            ]
        ]
    },
    {
        "id": "949eb1e7c251ce0e",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "849f455c90b8193e",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1550,
        "y": 1320,
        "wires": []
    },
    {
        "id": "9828e7499122b338",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "849f455c90b8193e",
        "name": "",
        "configUrlNode": "a33f75c91933dc08",
        "apiTag": "Laundry",
        "keepAuth": false,
        "operationData": {
            "id": "setLaundryState",
            "hasOperationId": true,
            "path": "/smartplug/laundry/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Laundry plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1160,
        "y": 1380,
        "wires": [
            [
                "ccd4008bb9133664",
                "949eb1e7c251ce0e"
            ],
            []
        ]
    },
    {
        "id": "220e1df26c776749",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "36d214c8ee683881",
        "name": "Dehumidifier webhook",
        "configUrlNode": "7b3a2e9531bb364e",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setDehumidifierPlugState",
            "hasOperationId": true,
            "path": "/smartplug/dehumidifier/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Dehumidifier Smart Plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1260,
        "y": 1700,
        "wires": [
            [
                "c94794a0f94c1913"
            ],
            [
                "214149b980a58a52"
            ]
        ]
    },
    {
        "id": "0a9a43c67d298449",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "36d214c8ee683881",
        "name": "trigger humidifier webhook",
        "func": "// Default values\nlet state = \"off\";\nlet humidity = 0;\n\n// Check if humidity exists in the incoming payload\nif (msg.payload && msg.payload.humidity !== undefined) {\n    humidity = Number(msg.payload.humidity);\n\n    // Determine the state based on humidity\n    state = humidity > 30 ? \"on\" : \"off\";\n}\n\n// Update payload\nmsg.payload = { state: state };\n\n// Update Node-RED status bubble\nnode.status({\n    fill: state === \"on\" ? \"green\" : \"red\",\n    shape: \"dot\",\n    text: `Humidity: ${humidity.toFixed(1)}%  ${state.toUpperCase()}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 1720,
        "wires": [
            [
                "220e1df26c776749"
            ]
        ]
    },
    {
        "id": "c94794a0f94c1913",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "36d214c8ee683881",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1530,
        "y": 1620,
        "wires": []
    },
    {
        "id": "214149b980a58a52",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "36d214c8ee683881",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    // Save the current state globally\n    global.set('dehumidifierState', msg.payload.state);\n\n    // Update the node status\n    const stateText = msg.payload.state === 'on' ? 'ON' : 'OFF';\n    const color = msg.payload.state === 'on' ? 'green' : 'red';\n\n    node.status({\n        fill: color,\n        shape: 'dot',\n        text: `Dehumidifier is ${stateText}`\n    });\n}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1560,
        "y": 1740,
        "wires": [
            [
                "f8643f33040aff1a"
            ]
        ]
    },
    {
        "id": "481033abce76ccd5",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "36d214c8ee683881",
        "name": "Dehumidifier smartplug",
        "info": "",
        "x": 900,
        "y": 1620,
        "wires": []
    },
    {
        "id": "17946e976372f036",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "f76e5e035e6a0475",
        "name": "reset simulation",
        "info": "",
        "x": 3180,
        "y": 1240,
        "wires": []
    },
    {
        "id": "0575f3be4169e6d4",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "f76e5e035e6a0475",
        "name": "Reset Energy Counter",
        "func": "// --- Reset all device energy values ---\nconst devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\n\n// Reset each devices energy to 0\ndevices.forEach(d => flow.set(`energy.${d}`, 0));\n\n// Reset time period\nflow.set('hours', 1);\n\nnode.status({ fill: \"yellow\", shape: \"ring\", text: \"Energy counters reset\" });\n\n// Output a confirmation message\nmsg.payload = {\n    reset: true,\n    message: \"All energy counters have been reset to 0\",\n    devices: devices\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3480,
        "y": 1300,
        "wires": [
            []
        ]
    },
    {
        "id": "343ceb6d448ae2cc",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "f76e5e035e6a0475",
        "name": " Reset Energy Counters",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 3230,
        "y": 1300,
        "wires": [
            [
                "0575f3be4169e6d4"
            ]
        ]
    },
    {
        "id": "ce425eea2d991746",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Total Energy Calculator",
        "func": "let devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\nlet hours = flow.get('hours') || 1; // time period in hours\n\n// Sum all device energy values\nlet totalW = devices.reduce((sum, d) => sum + (flow.get(`energy.${d}`) || 0), 0);\nlet totalKWh = totalW * hours / 1000;\n\n// Round and prepare output\nmsg.totalEnergy = `${totalKWh.toFixed(3)} kWh`;\n\n// --- Node status display ---\nlet color = \"green\";\nlet shape = \"dot\";\nlet text = `Total: ${totalKWh.toFixed(3)} kWh`;\n\nif (totalKWh === 0) {\n    color = \"grey\";\n    shape = \"ring\";\n    text = \"No energy recorded\";\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// Output message\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3350,
        "y": 2900,
        "wires": [
            [
                "efcdf63cfcc1dd48",
                "05153a2d3b6cdfe4"
            ]
        ]
    },
    {
        "id": "efcdf63cfcc1dd48",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "Total Energy Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 3430,
        "y": 3060,
        "wires": []
    },
    {
        "id": "49711a16b33ceb4e",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "2dd4501966039026",
        "name": "AC Telemetry",
        "func": "// === Air Conditioner Telemetry Simulator (Smart Plug Controlled) ===\n\n// --- Check Smart Plug state ---\nconst plugState = global.get('acState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution when AC plug is off\n}\n\n// --- Environment values ---\nlet envTemp = parseFloat(msg.payload.temperature || 25);\nlet envHumidity = msg.payload.humidity || 50;\n\n// --- Persistent setpoint (holds same for 1 hour) ---\nlet setpoint = flow.get('ac.setpoint');\nlet setpointTimer = flow.get('ac.setpointTimer') || 0;\n\n// Initialize or refresh setpoint every 3600 simulated seconds\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\nsetpointTimer += tickDuration;\n\nif (!setpoint || setpointTimer >= 3600) {\n    setpoint = Math.floor(16 + Math.random() * 15); // 1630C\n    setpointTimer = 0;\n}\n\n// --- Current temperature drift ---\nlet current = flow.get('ac.currentTemp') || envTemp;\ncurrent += (Math.random() - 0.5) * 0.3; // small drift 0.15C\n\n// --- Determine AC mode ---\nlet mode = 'idle';\nlet currentPower = 0; // Watts\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    currentPower = 1200; // cooling\n    current -= 0.5;\n} else if (current < setpoint - 1) {\n    mode = 'heat';\n    currentPower = 2000; // heating\n    current += 0.5;\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.ac') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (currentPower > 0) energy += wattToKwh(currentPower, tickDuration);\n\n// --- Save state ---\nflow.set('ac.setpoint', setpoint);\nflow.set('ac.setpointTimer', setpointTimer);\nflow.set('ac.currentTemp', current);\nflow.set('energy.ac', energy);\n\n// --- Node status feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (mode === 'cool') {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else if (mode === 'heat') {\n    color = \"red\";\n    shape = \"dot\";\n    text = `Heating | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Idle | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"ac\",\n    power: plugState,             // on/off from smart plug\n    temperature: parseFloat(current.toFixed(1)),\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    currentPower: currentPower,   // instantaneous Watts\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\",\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2160,
        "y": 2640,
        "wires": [
            [
                "4c331a7506ea7cc2"
            ]
        ]
    },
    {
        "id": "4c331a7506ea7cc2",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "2dd4501966039026",
        "name": "AC AsyncAPI",
        "x": 2410,
        "y": 2640,
        "wires": [
            [
                "71d453dc9f7ebbcb",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "71d453dc9f7ebbcb",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "2dd4501966039026",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2610,
        "y": 2620,
        "wires": []
    },
    {
        "id": "bd9db37aea1bbf6e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "2dd4501966039026",
        "name": "AC Device",
        "info": "",
        "x": 2140,
        "y": 2580,
        "wires": []
    },
    {
        "id": "263589e71b03026a",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "1007ee2791e026f6",
        "name": "Lights Telemetry",
        "func": "// === Smart Light Telemetry Simulator (Controlled by Smart Plug) ===\n\n// --- Check Smart Plug state first ---\nconst plugState = global.get('lightState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop simulation when plug is off\n}\n\n// --- Environment info ---\nlet envTemp = parseFloat(msg.payload.temperature || 22);\nlet envHumidity = msg.payload.humidity || 45;\nlet envLight = msg.payload.lightIntensity || 50;\n\n// --- Threshold for turning lights ON/OFF (0100) ---\nconst lightThreshold = 30;\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// --- Light behavior when ON ---\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0; // W\nenergy += (power / 1000) * (tickSeconds / 3600); // convert to kWh\nflow.set('energy.light', parseFloat(energy.toFixed(3)));\n\n// --- Node status for dashboard ---\nlet colorStatus = state === \"ON\" ? \"green\" : \"red\";\nlet shape = state === \"ON\" ? \"dot\" : \"ring\";\nlet text = `${state} | ${power.toFixed(1)} W`;\n\nnode.status({ fill: colorStatus, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"light\",\n    power: plugState, // shows if plug is ON/OFF\n    state: state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    voltage: 230,\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2160,
        "y": 2860,
        "wires": [
            [
                "30204b977518c192"
            ]
        ]
    },
    {
        "id": "30204b977518c192",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "1007ee2791e026f6",
        "name": "Lights AsyncAPI",
        "x": 2420,
        "y": 2860,
        "wires": [
            [
                "928970bf36b05c09",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "928970bf36b05c09",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "1007ee2791e026f6",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2650,
        "y": 2820,
        "wires": []
    },
    {
        "id": "20bb8b0c688a7670",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "1007ee2791e026f6",
        "name": "Lights",
        "info": "",
        "x": 2130,
        "y": 2800,
        "wires": []
    },
    {
        "id": "f971ec1536c3f4e1",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "7831a62e791b5d1d",
        "name": "Fridge Telemetry",
        "func": "// === Fridge & Freezer Telemetry Simulator (Safe Temperatures) ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;     // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") ?? fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") ?? freezerSet + (Math.random() * 2 - 1);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;  // seconds per tick\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);   // 0.2C\nfreezerTemp += (Math.random() * 0.6 - 0.3);  // 0.3C\n\n// Compressor state logic\nlet compressor = \"OFF\";\nlet currentPower = 5; // idle watts\n\nif (fridgeTemp > fridgeSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3;  // small decrement per tick\n    if (fridgeTemp < fridgeSet) fridgeTemp = fridgeSet; // prevent overcooling\n    currentPower = 150;\n}\n\nif (freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    freezerTemp -= 0.5;\n    if (freezerTemp < freezerSet) freezerTemp = freezerSet; // prevent overcooling\n    currentPower = 150;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\nenergy += wattToKwh(currentPower, tickSeconds);\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// --- Node status visual feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (doorStatus !== \"closed\") {\n    color = \"red\";\n    shape = \"dot\";\n    text = ` Door Open (${doorStatus.replace(\"_\", \" \")}) | ${currentPower} W`;\n} else if (compressor === \"ON\") {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling ON | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Stable | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: currentPower, // instantaneous W\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2170,
        "y": 3080,
        "wires": [
            [
                "f0afbd720a48a9cc"
            ]
        ]
    },
    {
        "id": "f0afbd720a48a9cc",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "7831a62e791b5d1d",
        "name": "Fridge AsyncAPI",
        "x": 2420,
        "y": 3080,
        "wires": [
            [
                "8b0220606ede3813",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "8b0220606ede3813",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "7831a62e791b5d1d",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2680,
        "y": 3100,
        "wires": []
    },
    {
        "id": "8b66f3ad3f9fad59",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "7831a62e791b5d1d",
        "name": "Fridge Device",
        "info": "",
        "x": 2150,
        "y": 3020,
        "wires": []
    },
    {
        "id": "e0aac8f85b7b7ada",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "a93877d13c210358",
        "name": "Launder AsyncAPI",
        "x": 2410,
        "y": 3320,
        "wires": [
            [
                "d79a487c0d7ef393",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "d79a487c0d7ef393",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "a93877d13c210358",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2660,
        "y": 3340,
        "wires": []
    },
    {
        "id": "87d8ed2bf9066f21",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "a93877d13c210358",
        "name": "Laundry Telemetry",
        "func": "// --- Full Washing Machine Cycle Simulator ---\n\n// --- Simulation scale ---\nconst scale = global.get(\"simulationScale\") || 60; // seconds per tick\nconst tickSeconds = 60 * scale; // 1 tick = 1 minute\n\n// --- Check Smart Plug / power ---\nconst plugState = global.get('laundryState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  cycle paused' });\n    return null;\n}\n\n// --- Load persistent state ---\nlet phase = flow.get('laundry.phase') || 'idle';\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || (plugState === 'on' ? true:false);\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\nlet mode = flow.get('laundry.mode') || 'normal';\n\n// --- Phase durations per mode (minutes) ---\nconst modeDurations = {\n    eco: { filling:5, washing:60, rinsing:15, spinning:10, drying:30 },\n    normal: { filling:5, washing:45, rinsing:15, spinning:10, drying:20 },\n    quick: { filling:3, washing:20, rinsing:10, spinning:5, drying:10 },\n    heavy: { filling:5, washing:75, rinsing:20, spinning:15, drying:40 },\n    delicate: { filling:5, washing:30, rinsing:15, spinning:5, drying:10 }\n};\n\n// --- Power per phase (Watts) ---\nconst phasePower = { filling:50, washing:500, rinsing:300, spinning:800, drying:2000, completed:0 };\n\n// --- Start new cycle if idle ---\nif (!running && phase === 'idle') {\n    running = true;\n    const modes = Object.keys(modeDurations);\n    mode = modes[Math.floor(Math.random() * modes.length)];\n    phase = 'filling';\n    remainingTime = modeDurations[mode][phase];\n}\n\n// --- Progress cycle ---\nif (running) {\n    remainingTime -= 1 * scale;\n\n    if (remainingTime <= 0) {\n        const phases = ['filling','washing','rinsing','spinning','drying'];\n        const currentIndex = phases.indexOf(phase);\n\n        if (currentIndex < phases.length - 1) {\n            phase = phases[currentIndex + 1];\n            remainingTime = modeDurations[mode][phase];\n        } else {\n            // Cycle completed\n            phase = 'completed';\n            running = false;\n            remainingTime = 0;\n        }\n    }\n}\n\n// --- Instantaneous power ---\nlet currentPower = running ? phasePower[phase] || 0 : 0;\n\n// --- Energy usage (kWh) ---\nenergy += (currentPower / 1000) * (tickSeconds / 3600);\n\n// --- Water usage ---\nif (['filling','washing','rinsing'].includes(phase)) {\n    waterUsed += Math.random() * 0.5 * scale;\n}\n\n// --- Simulated values ---\nlet waterTemp = (phase === 'washing') ? 40 + Math.random()*10 : 25;\nlet spinSpeed = (phase === 'spinning') ? 800 + Math.floor(Math.random()*400) : 0;\nlet loadWeight = 5 + Math.random()*3;\n\n// --- Door status ---\nlet doorStatus = (running || phase === 'completed') ? 'locked' : 'closed';\n\n// --- Save state ---\nflow.set('laundry.phase', phase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\nflow.set('laundry.mode', mode);\n\n// --- Node status feedback ---\nlet color = \"grey\", shape = \"ring\", text = \"\";\n\nif (!running && phase === 'completed') {\n    color = 'green';\n    shape = 'ring';\n    text = ` Cycle Completed | 0 W`;\n} else if (running) {\n    color = 'blue';\n    shape = 'dot';\n    text = `${phase.toUpperCase()} | ${remainingTime} min left | ${currentPower} W`;\n}\n\nif (doorStatus === 'open') {\n    color = 'red';\n    text = ' Door Open';\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: 'laundry',\n    power: 'ON',\n    running,\n    mode,\n    phase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    currentPower: currentPower, // instantaneous Watts\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2170,
        "y": 3320,
        "wires": [
            [
                "e0aac8f85b7b7ada"
            ]
        ]
    },
    {
        "id": "cf286c112be3eb71",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "a93877d13c210358",
        "name": "Laundry Device",
        "info": "",
        "x": 2160,
        "y": 3260,
        "wires": []
    },
    {
        "id": "209ccda251fb314c",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "5a107c630ab6ea2a",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator (Auto Stop/Start by Humidity) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickMinutes = 1 * scale; // 1 tick = 1 minute\n\n// --- Persistent state ---\nlet running = flow.get('dehumidifier.running');\nif (running === undefined) running = true;\n\nlet tankLevel = flow.get('dehumidifier.tankLevel') || 0;\nlet elapsedMinutes = flow.get('dehumidifier.elapsedMinutes') || 0;\n\n// Fixed mode and fan speed\nconst mode = \"auto\";\nconst fanSpeed = \"medium\";\n\n// Random environment humidity\nlet environmentHumidity = msg.payload.humidity || 45; // current room humidity\n\n// --- Auto Stop/Start logic ---\nif (environmentHumidity <= 50) {\n    running = false; // stop dehumidifier\n} else if (environmentHumidity > 50) {\n    running = true;  // start dehumidifier\n}\n\n// Power settings\nconst powerWatts = running ? 200 : 0; // instantaneous Watts\n\n// --- Run logic ---\nif (running) {\n    // Increment elapsed time\n    elapsedMinutes += tickMinutes;\n\n    // Gradual tank filling step-by-step (small random increment per minute)\n    const humidityRemoved = parseFloat((Math.random() * 2 + 0.5).toFixed(2)); // 0.52.5% per tick\n    tankLevel = Math.min(100, tankLevel + humidityRemoved);\n\n    // Reset tank if full or after 60 min\n    if (tankLevel >= 100 || elapsedMinutes >= 60) {\n        tankLevel = 0;\n        elapsedMinutes = 0;\n    }\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.dehumidifier') || 0;\nfunction wattToKwh(powerWatts, minutes) {\n    return (powerWatts / 1000) * (minutes / 60);\n}\nif (powerWatts > 0) energy += wattToKwh(powerWatts, tickMinutes);\n\n// --- Save persistent state ---\nflow.set('dehumidifier.running', running);\nflow.set('dehumidifier.tankLevel', tankLevel);\nflow.set('dehumidifier.elapsedMinutes', elapsedMinutes);\nflow.set('energy.dehumidifier', energy);\n\n// --- Node status feedback ---\nlet color = running ? \"blue\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\n\n// Calculate progress as percentage of 60 min run\nconst progressPercent = Math.min(100, Math.round((elapsedMinutes / 60) * 100));\nlet text = running \n    ? `${environmentHumidity}% | ${mode.toUpperCase()} | ${powerWatts} W `\n    : `${environmentHumidity}% | OFF | 0 W `;\n\n// Update node status\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    progressPercent: progressPercent,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: powerWatts,\n    humidity: environmentHumidity,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2180,
        "y": 3580,
        "wires": [
            [
                "92912e7f835ed2d8"
            ]
        ]
    },
    {
        "id": "92912e7f835ed2d8",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "5a107c630ab6ea2a",
        "name": "Dehumidifier AsyncAPI",
        "x": 2430,
        "y": 3580,
        "wires": [
            [
                "61581de9796c6e68",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "61581de9796c6e68",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "5a107c630ab6ea2a",
        "name": "Dehumidifier Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 2740,
        "y": 3560,
        "wires": []
    },
    {
        "id": "0ea4b576160ebf66",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "5a107c630ab6ea2a",
        "name": "Dehimidifier Device",
        "info": "",
        "x": 2170,
        "y": 3520,
        "wires": []
    },
    {
        "id": "86ecb8527df80e86",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "5fa6601368fe9e2c",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator (30 min Standard Mode) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickSeconds = 1 * scale; // 1 tick = 1 real second\n\n// Check Smart Plug state\nconst plugState = global.get('cookerState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null;\n}\n\nlet running = true;\n\n// Standard fixed mode\nconst mode = \"bake\"; // standard mode\n\n// Persistent timer in seconds\nlet remainingSeconds = flow.get('cooker.remainingSeconds');\nif (!remainingSeconds) {\n    remainingSeconds = 30 * 60; // 30 minutes in seconds\n}\n\n// Update timer\nif (running) {\n    remainingSeconds = Math.max(0, remainingSeconds - tickSeconds);\n    if (remainingSeconds === 0) running = false;\n}\n\n// Temperatures\nconst currentTemp = running ? 180 : 25; // standard bake temp\nconst setTemp = running ? 200 : 0;\n\n// Instantaneous power in Watts\nconst powerWatts = running ? 1500 : 0;\n\n// Energy tracking in kWh\nlet energy = flow.get('energy.cooker') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (running) energy += wattToKwh(powerWatts, tickSeconds);\nflow.set('energy.cooker', energy);\n\n// Save persistent timer\nflow.set('cooker.remainingSeconds', remainingSeconds);\n\n// --- Node status feedback ---\nlet color = running ? \"orange\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\nlet minutesLeft = Math.ceil(remainingSeconds / 60); // only minutes, round up\n\nlet text = running \n    ? `${mode.toUpperCase()} | ${currentTemp}C  ${setTemp}C | ${minutesLeft} min left | ${powerWatts} W`\n    : `OFF | Temp: ${currentTemp}C | 0 W`;\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode,\n    setTemp,\n    currentTemp,\n    timerMinutes: minutesLeft,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2170,
        "y": 3800,
        "wires": [
            [
                "b2fec3d8cb269771"
            ]
        ]
    },
    {
        "id": "b2fec3d8cb269771",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "5fa6601368fe9e2c",
        "name": "Cooker AsyncAPI",
        "x": 2510,
        "y": 3800,
        "wires": [
            [
                "4781f74daf9b3bd1",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "4781f74daf9b3bd1",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "5fa6601368fe9e2c",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 2760,
        "y": 3800,
        "wires": []
    },
    {
        "id": "af817b2fdf746df6",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "5fa6601368fe9e2c",
        "name": "Cooker Device",
        "info": "",
        "x": 2160,
        "y": 3740,
        "wires": []
    },
    {
        "id": "ede8203690c3314a",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "fec5dcecdaa3c889",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2690,
        "y": 2380,
        "wires": []
    },
    {
        "id": "c685fa992e3f171a",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "fec5dcecdaa3c889",
        "name": " Thermostat AsyncAPI",
        "x": 2440,
        "y": 2440,
        "wires": [
            [
                "ede8203690c3314a",
                "ce425eea2d991746"
            ]
        ]
    },
    {
        "id": "dda7f9b5e09aca38",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "fec5dcecdaa3c889",
        "name": "Thermostat Telemetry",
        "func": "// Check Smart Plug state before running\nconst plugState = global.get('thermostatState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution\n}\n\n// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature || 22); // default 22C\nlet envHumidity = msg.payload.humidity || 45;\n\n// Desired temperature\nconst desired = Math.floor(20 + Math.random() * 11);\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nlet currentPower = 0; // W\n\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5;\n    currentPower = 2000; // heater power in W\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5;\n    currentPower = 1200; // AC power in W\n}\n\n// Energy tracking (cumulative kWh)\nlet energy = flow.get('energy.thermostat') || 0;\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\n// Add to cumulative energy\nenergy += wattToKwh(currentPower, tickDuration);\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// --- Node status for visual feedback ---\nlet color = 'grey';\nlet shape = 'ring';\nlet text = 'Idle';\n\nif (mode === 'heat') {\n    color = 'red';\n    shape = 'dot';\n    text = `HEAT | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else if (mode === 'cool') {\n    color = 'blue';\n    shape = 'dot';\n    text = `COOL | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else {\n    text = `IDLE | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    power: plugState,       // instantaneous W\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2180,
        "y": 2440,
        "wires": [
            [
                "c685fa992e3f171a"
            ]
        ]
    },
    {
        "id": "810e7649f79c53ac",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "fec5dcecdaa3c889",
        "name": "Thermostat Device",
        "info": "",
        "x": 2170,
        "y": 2380,
        "wires": []
    },
    {
        "id": "575535f60d95ed0e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "e7e61c882634a6de",
        "name": "SMARTHOME",
        "info": "",
        "x": 600,
        "y": 2320,
        "wires": []
    },
    {
        "id": "67e2072ce47be7a8",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "428180dd82e49c18",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 950,
        "y": 2360,
        "wires": []
    },
    {
        "id": "b26e1204c81ac63c",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "428180dd82e49c18",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload.id",
                "v": "2",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 950,
        "y": 2420,
        "wires": [
            [
                "928de0acefcabb73"
            ]
        ]
    },
    {
        "id": "1ec8895889219d92",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "428180dd82e49c18",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"off\", \"id\":2}",
        "payloadType": "json",
        "x": 940,
        "y": 2490,
        "wires": [
            [
                "928de0acefcabb73"
            ]
        ]
    },
    {
        "id": "1771c02e28b323ba",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "428180dd82e49c18",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('thermostatState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1540,
        "y": 2460,
        "wires": [
            [
                "dda7f9b5e09aca38"
            ]
        ]
    },
    {
        "id": "26577696b63f7a81",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "428180dd82e49c18",
        "name": "Smartplug debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1610,
        "y": 2380,
        "wires": []
    },
    {
        "id": "928de0acefcabb73",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "428180dd82e49c18",
        "name": "Thermostat webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setThermostatPlugState",
            "hasOperationId": true,
            "path": "/home/{id}/smartplug/thermostat/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            },
            "id path": {
                "name": "id",
                "isActive": true,
                "activeFilter": "",
                "required": true,
                "type": "msg",
                "value": "payload.id",
                "in": "path"
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Thermostat plug state changed successfully"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1240,
        "y": 2460,
        "wires": [
            [
                "1771c02e28b323ba",
                "26577696b63f7a81"
            ],
            []
        ]
    },
    {
        "id": "422cf5e5672cd744",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "d50ad12694f17cd1",
        "name": "Smartplug for cooker",
        "info": "",
        "x": 910,
        "y": 3980,
        "wires": []
    },
    {
        "id": "51ab2ba2188305b1",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "d50ad12694f17cd1",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 930,
        "y": 4040,
        "wires": [
            [
                "5af9e7e4f35cfd49"
            ]
        ]
    },
    {
        "id": "aafd72bb516d01b2",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "d50ad12694f17cd1",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 920,
        "y": 4110,
        "wires": [
            [
                "5af9e7e4f35cfd49"
            ]
        ]
    },
    {
        "id": "2311ab5e8cf7acf7",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "d50ad12694f17cd1",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('cookerState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 4080,
        "wires": [
            [
                "86ecb8527df80e86"
            ]
        ]
    },
    {
        "id": "373596c9ee98004b",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "d50ad12694f17cd1",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 3980,
        "wires": []
    },
    {
        "id": "5af9e7e4f35cfd49",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "d50ad12694f17cd1",
        "name": "Cooker webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setCookerPlugState",
            "hasOperationId": true,
            "path": "/smartplug/cooker/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Cooker Smart Plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1210,
        "y": 4080,
        "wires": [
            [
                "2311ab5e8cf7acf7",
                "373596c9ee98004b"
            ],
            []
        ]
    },
    {
        "id": "3704fa590849c948",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "b9ea0c25f0b04076",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 1110,
        "y": 3020,
        "wires": [
            [
                "b7d4d6d21f2d3633"
            ]
        ]
    },
    {
        "id": "b7d4d6d21f2d3633",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "b9ea0c25f0b04076",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60); // 1s = 1 minute\n}\n\n// --- Realistic Environment Base ---\nconst baseTemp = 22; // C\nconst baseHumidity = 70; // %\nconst hour = new Date().getHours(); // local time for light simulation\n\n// Get previous state\nlet currentTemp = flow.get('env.temperature') || baseTemp;\nlet currentHumidity = flow.get('env.humidity') || baseHumidity;\nlet currentLight = flow.get('env.lightIntensity') || 50;\n\n// --- Apply small drift ---\ncurrentTemp += (Math.random() * 0.4 - 0.2); // 0.2C\ncurrentHumidity += (Math.random() * 2 - 1);  // 1%\ncurrentHumidity = Math.max(20, Math.min(70, currentHumidity)); // clamp realistic\n// Light based on time of day\nif (hour >= 6 && hour < 18) {\n    currentLight = 70 + Math.floor(Math.random() * 30); // day\n} else {\n    currentLight = 0 + Math.floor(Math.random() * 20);  // night\n}\n\n// Save state for next tick\nflow.set('env.temperature', currentTemp);\nflow.set('env.humidity', currentHumidity);\nflow.set('env.lightIntensity', currentLight);\nflow.set('current_temp', currentTemp);\n\n// --- Output payload ---\nmsg.payload = {\n    environment: true,\n    temperature: currentTemp.toFixed(1),\n    humidity: currentHumidity.toFixed(1),\n    lightIntensity: currentLight,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\")\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1450,
        "y": 3020,
        "wires": [
            [
                "49711a16b33ceb4e",
                "263589e71b03026a",
                "f971ec1536c3f4e1",
                "87d8ed2bf9066f21",
                "209ccda251fb314c",
                "86ecb8527df80e86",
                "dda7f9b5e09aca38",
                "e55b8c61fff5f9d2"
            ]
        ]
    },
    {
        "id": "c89090cf29151f45",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "b9ea0c25f0b04076",
        "name": "Enviroment variables",
        "info": "",
        "x": 1100,
        "y": 2960,
        "wires": []
    },
    {
        "id": "0f4f337023a45302",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "73f3eb149c908946",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 920,
        "y": 3160,
        "wires": []
    },
    {
        "id": "8e4f89117a68860f",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "73f3eb149c908946",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 930,
        "y": 3220,
        "wires": [
            [
                "5a7e0f5bc59a79f6"
            ]
        ]
    },
    {
        "id": "492d7616d6f85075",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "73f3eb149c908946",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 920,
        "y": 3290,
        "wires": [
            [
                "5a7e0f5bc59a79f6"
            ]
        ]
    },
    {
        "id": "90851a370f06ae7c",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "73f3eb149c908946",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('lightState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 3260,
        "wires": [
            [
                "263589e71b03026a"
            ]
        ]
    },
    {
        "id": "f243cec0fdf22df0",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "73f3eb149c908946",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1570,
        "y": 3160,
        "wires": []
    },
    {
        "id": "5a7e0f5bc59a79f6",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "73f3eb149c908946",
        "name": "",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setLightsPlugState",
            "hasOperationId": true,
            "path": "/smartplug/lights/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart Lights plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1230,
        "y": 3240,
        "wires": [
            [
                "90851a370f06ae7c",
                "f243cec0fdf22df0"
            ],
            []
        ]
    },
    {
        "id": "e3483d2becdf5de6",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "b65cd0c520e407f4",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 930,
        "y": 2680,
        "wires": []
    },
    {
        "id": "d69454f7552fc63e",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "b65cd0c520e407f4",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 930,
        "y": 2740,
        "wires": [
            [
                "95432ccfc5c65052"
            ]
        ]
    },
    {
        "id": "c174acf839525902",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "b65cd0c520e407f4",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 920,
        "y": 2810,
        "wires": [
            [
                "95432ccfc5c65052"
            ]
        ]
    },
    {
        "id": "c84ce72905bcc4dc",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "b65cd0c520e407f4",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('acState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 2780,
        "wires": [
            [
                "49711a16b33ceb4e"
            ]
        ]
    },
    {
        "id": "297092b1e2293f49",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "b65cd0c520e407f4",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1590,
        "y": 2700,
        "wires": []
    },
    {
        "id": "95432ccfc5c65052",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "b65cd0c520e407f4",
        "name": "",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setACPlugState",
            "hasOperationId": true,
            "path": "/smartplug/ac/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    },
                    "temperature": {
                        "name": "temperature",
                        "activeFilter": ""
                    },
                    "mode": {
                        "name": "mode",
                        "activeFilter": ""
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart AC plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid parameters specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1220,
        "y": 2740,
        "wires": [
            [
                "c84ce72905bcc4dc"
            ],
            [
                "297092b1e2293f49"
            ]
        ]
    },
    {
        "id": "4b1c838931c1b16e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "28b4c86d1a067d3b",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 900,
        "y": 3400,
        "wires": []
    },
    {
        "id": "18e7484779e7db75",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "28b4c86d1a067d3b",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 910,
        "y": 3460,
        "wires": [
            [
                "64779bcc785bea09"
            ]
        ]
    },
    {
        "id": "3c6113922443086e",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "28b4c86d1a067d3b",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 900,
        "y": 3530,
        "wires": [
            [
                "64779bcc785bea09"
            ]
        ]
    },
    {
        "id": "1677a84585c739cd",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "28b4c86d1a067d3b",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('laundryState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 3500,
        "wires": [
            [
                "87d8ed2bf9066f21"
            ]
        ]
    },
    {
        "id": "3601a3c55527ada6",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "28b4c86d1a067d3b",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1550,
        "y": 3400,
        "wires": []
    },
    {
        "id": "64779bcc785bea09",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "28b4c86d1a067d3b",
        "name": "",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "Laundry",
        "keepAuth": false,
        "operationData": {
            "id": "setLaundryState",
            "hasOperationId": true,
            "path": "/smartplug/laundry/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Laundry plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1160,
        "y": 3460,
        "wires": [
            [
                "1677a84585c739cd",
                "3601a3c55527ada6"
            ],
            []
        ]
    },
    {
        "id": "538f64e46b18b2cf",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "6fb2c52901fa6564",
        "name": "Dehumidifier webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setDehumidifierPlugState",
            "hasOperationId": true,
            "path": "/smartplug/dehumidifier/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Dehumidifier Smart Plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 1260,
        "y": 3780,
        "wires": [
            [
                "df38fe4d3db0b544"
            ],
            [
                "161afa0aab30006e"
            ]
        ]
    },
    {
        "id": "e55b8c61fff5f9d2",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "6fb2c52901fa6564",
        "name": "trigger humidifier webhook",
        "func": "// Default values\nlet state = \"off\";\nlet humidity = 0;\n\n// Check if humidity exists in the incoming payload\nif (msg.payload && msg.payload.humidity !== undefined) {\n    humidity = Number(msg.payload.humidity);\n\n    // Determine the state based on humidity\n    state = humidity > 30 ? \"on\" : \"off\";\n}\n\n// Update payload\nmsg.payload = { state: state };\n\n// Update Node-RED status bubble\nnode.status({\n    fill: state === \"on\" ? \"green\" : \"red\",\n    shape: \"dot\",\n    text: `Humidity: ${humidity.toFixed(1)}%  ${state.toUpperCase()}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 3800,
        "wires": [
            [
                "538f64e46b18b2cf"
            ]
        ]
    },
    {
        "id": "df38fe4d3db0b544",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "6fb2c52901fa6564",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1530,
        "y": 3700,
        "wires": []
    },
    {
        "id": "161afa0aab30006e",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "6fb2c52901fa6564",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    // Save the current state globally\n    global.set('dehumidifierState', msg.payload.state);\n\n    // Update the node status\n    const stateText = msg.payload.state === 'on' ? 'ON' : 'OFF';\n    const color = msg.payload.state === 'on' ? 'green' : 'red';\n\n    node.status({\n        fill: color,\n        shape: 'dot',\n        text: `Dehumidifier is ${stateText}`\n    });\n}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1560,
        "y": 3820,
        "wires": [
            [
                "209ccda251fb314c"
            ]
        ]
    },
    {
        "id": "ea7a8a798a314876",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "6fb2c52901fa6564",
        "name": "Dehumidifier smartplug",
        "info": "",
        "x": 900,
        "y": 3700,
        "wires": []
    },
    {
        "id": "78727073430e6654",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "dd1077e8cd7a0f41",
        "name": "reset simulation",
        "info": "",
        "x": 3180,
        "y": 3320,
        "wires": []
    },
    {
        "id": "b33bdafa4acf33f0",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "dd1077e8cd7a0f41",
        "name": "Reset Energy Counter",
        "func": "// --- Reset all device energy values ---\nconst devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\n\n// Reset each devices energy to 0\ndevices.forEach(d => flow.set(`energy.${d}`, 0));\n\n// Reset time period\nflow.set('hours', 1);\n\nnode.status({ fill: \"yellow\", shape: \"ring\", text: \"Energy counters reset\" });\n\n// Output a confirmation message\nmsg.payload = {\n    reset: true,\n    message: \"All energy counters have been reset to 0\",\n    devices: devices\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 3480,
        "y": 3380,
        "wires": [
            []
        ]
    },
    {
        "id": "83b4dcdd05607602",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "dd1077e8cd7a0f41",
        "name": " Reset Energy Counters",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 3230,
        "y": 3380,
        "wires": [
            [
                "b33bdafa4acf33f0"
            ]
        ]
    },
    {
        "id": "4bea898bf80beb2a",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Total Energy Calculator",
        "func": "let devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\nlet hours = flow.get('hours') || 1; // time period in hours\n\n// Sum all device energy values\nlet totalW = devices.reduce((sum, d) => sum + (flow.get(`energy.${d}`) || 0), 0);\nlet totalKWh = totalW * hours / 1000;\n\n// Round and prepare output\nmsg.totalEnergy = `${totalKWh.toFixed(3)} kWh`;\n\n// --- Node status display ---\nlet color = \"green\";\nlet shape = \"dot\";\nlet text = `Total: ${totalKWh.toFixed(3)} kWh`;\n\nif (totalKWh === 0) {\n    color = \"grey\";\n    shape = \"ring\";\n    text = \"No energy recorded\";\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// Output message\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 7210,
        "y": 820,
        "wires": [
            [
                "00cd4bf75f088c52",
                "0f7c797c6e5f1852"
            ]
        ]
    },
    {
        "id": "00cd4bf75f088c52",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "Total Energy Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 7290,
        "y": 980,
        "wires": []
    },
    {
        "id": "4f73941073be689a",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "be056a72e9275c15",
        "name": "AC Telemetry",
        "func": "// === Air Conditioner Telemetry Simulator (Smart Plug Controlled) ===\n\n// --- Check Smart Plug state ---\nconst plugState = global.get('acState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution when AC plug is off\n}\n\n// --- Environment values ---\nlet envTemp = parseFloat(msg.payload.temperature || 25);\nlet envHumidity = msg.payload.humidity || 50;\n\n// --- Persistent setpoint (holds same for 1 hour) ---\nlet setpoint = flow.get('ac.setpoint');\nlet setpointTimer = flow.get('ac.setpointTimer') || 0;\n\n// Initialize or refresh setpoint every 3600 simulated seconds\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\nsetpointTimer += tickDuration;\n\nif (!setpoint || setpointTimer >= 3600) {\n    setpoint = Math.floor(16 + Math.random() * 15); // 1630C\n    setpointTimer = 0;\n}\n\n// --- Current temperature drift ---\nlet current = flow.get('ac.currentTemp') || envTemp;\ncurrent += (Math.random() - 0.5) * 0.3; // small drift 0.15C\n\n// --- Determine AC mode ---\nlet mode = 'idle';\nlet currentPower = 0; // Watts\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    currentPower = 1200; // cooling\n    current -= 0.5;\n} else if (current < setpoint - 1) {\n    mode = 'heat';\n    currentPower = 2000; // heating\n    current += 0.5;\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.ac') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (currentPower > 0) energy += wattToKwh(currentPower, tickDuration);\n\n// --- Save state ---\nflow.set('ac.setpoint', setpoint);\nflow.set('ac.setpointTimer', setpointTimer);\nflow.set('ac.currentTemp', current);\nflow.set('energy.ac', energy);\n\n// --- Node status feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (mode === 'cool') {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else if (mode === 'heat') {\n    color = \"red\";\n    shape = \"dot\";\n    text = `Heating | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Idle | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"ac\",\n    power: plugState,             // on/off from smart plug\n    temperature: parseFloat(current.toFixed(1)),\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    currentPower: currentPower,   // instantaneous Watts\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\",\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6020,
        "y": 560,
        "wires": [
            [
                "dae0c498e0736ef0"
            ]
        ]
    },
    {
        "id": "dae0c498e0736ef0",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "be056a72e9275c15",
        "name": "AC AsyncAPI",
        "x": 6270,
        "y": 560,
        "wires": [
            [
                "36e744d456a0e955",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "36e744d456a0e955",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "be056a72e9275c15",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6470,
        "y": 540,
        "wires": []
    },
    {
        "id": "b2b73bfd3a727288",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "be056a72e9275c15",
        "name": "AC Device",
        "info": "",
        "x": 6000,
        "y": 500,
        "wires": []
    },
    {
        "id": "fcb20853039afb06",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "3fb223172ed07613",
        "name": "Lights Telemetry",
        "func": "// === Smart Light Telemetry Simulator (Controlled by Smart Plug) ===\n\n// --- Check Smart Plug state first ---\nconst plugState = global.get('lightState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop simulation when plug is off\n}\n\n// --- Environment info ---\nlet envTemp = parseFloat(msg.payload.temperature || 22);\nlet envHumidity = msg.payload.humidity || 45;\nlet envLight = msg.payload.lightIntensity || 50;\n\n// --- Threshold for turning lights ON/OFF (0100) ---\nconst lightThreshold = 30;\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// --- Light behavior when ON ---\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0; // W\nenergy += (power / 1000) * (tickSeconds / 3600); // convert to kWh\nflow.set('energy.light', parseFloat(energy.toFixed(3)));\n\n// --- Node status for dashboard ---\nlet colorStatus = state === \"ON\" ? \"green\" : \"red\";\nlet shape = state === \"ON\" ? \"dot\" : \"ring\";\nlet text = `${state} | ${power.toFixed(1)} W`;\n\nnode.status({ fill: colorStatus, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"light\",\n    power: plugState, // shows if plug is ON/OFF\n    state: state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    voltage: 230,\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6020,
        "y": 780,
        "wires": [
            [
                "c506cb9fdbd315c0"
            ]
        ]
    },
    {
        "id": "c506cb9fdbd315c0",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "3fb223172ed07613",
        "name": "Lights AsyncAPI",
        "x": 6280,
        "y": 780,
        "wires": [
            [
                "c70fc12d39c4efc7",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "c70fc12d39c4efc7",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "3fb223172ed07613",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6510,
        "y": 740,
        "wires": []
    },
    {
        "id": "682fcf14a6ae490e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "3fb223172ed07613",
        "name": "Lights",
        "info": "",
        "x": 5990,
        "y": 720,
        "wires": []
    },
    {
        "id": "d6229089f43403c5",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "e3d80939c7253d94",
        "name": "Fridge Telemetry",
        "func": "// === Fridge & Freezer Telemetry Simulator (Safe Temperatures) ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;     // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") ?? fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") ?? freezerSet + (Math.random() * 2 - 1);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;  // seconds per tick\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);   // 0.2C\nfreezerTemp += (Math.random() * 0.6 - 0.3);  // 0.3C\n\n// Compressor state logic\nlet compressor = \"OFF\";\nlet currentPower = 5; // idle watts\n\nif (fridgeTemp > fridgeSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3;  // small decrement per tick\n    if (fridgeTemp < fridgeSet) fridgeTemp = fridgeSet; // prevent overcooling\n    currentPower = 150;\n}\n\nif (freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    freezerTemp -= 0.5;\n    if (freezerTemp < freezerSet) freezerTemp = freezerSet; // prevent overcooling\n    currentPower = 150;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\nenergy += wattToKwh(currentPower, tickSeconds);\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// --- Node status visual feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (doorStatus !== \"closed\") {\n    color = \"red\";\n    shape = \"dot\";\n    text = ` Door Open (${doorStatus.replace(\"_\", \" \")}) | ${currentPower} W`;\n} else if (compressor === \"ON\") {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling ON | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Stable | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: currentPower, // instantaneous W\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6030,
        "y": 1000,
        "wires": [
            [
                "156a7e5e3bd529de"
            ]
        ]
    },
    {
        "id": "156a7e5e3bd529de",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "e3d80939c7253d94",
        "name": "Fridge AsyncAPI",
        "x": 6280,
        "y": 1000,
        "wires": [
            [
                "a5ac1e8cbfb91a9a",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "a5ac1e8cbfb91a9a",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "e3d80939c7253d94",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6540,
        "y": 1020,
        "wires": []
    },
    {
        "id": "3b7c4af51a783630",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "e3d80939c7253d94",
        "name": "Fridge Device",
        "info": "",
        "x": 6010,
        "y": 940,
        "wires": []
    },
    {
        "id": "a4fc2573a28ef76a",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "aae6bf515142caa9",
        "name": "Launder AsyncAPI",
        "x": 6270,
        "y": 1240,
        "wires": [
            [
                "a048623cd06f2e38",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "a048623cd06f2e38",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "aae6bf515142caa9",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6520,
        "y": 1260,
        "wires": []
    },
    {
        "id": "f26375516505b82f",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "aae6bf515142caa9",
        "name": "Laundry Telemetry",
        "func": "// --- Full Washing Machine Cycle Simulator ---\n\n// --- Simulation scale ---\nconst scale = global.get(\"simulationScale\") || 60; // seconds per tick\nconst tickSeconds = 60 * scale; // 1 tick = 1 minute\n\n// --- Check Smart Plug / power ---\nconst plugState = global.get('laundryState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  cycle paused' });\n    return null;\n}\n\n// --- Load persistent state ---\nlet phase = flow.get('laundry.phase') || 'idle';\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || (plugState === 'on' ? true:false);\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\nlet mode = flow.get('laundry.mode') || 'normal';\n\n// --- Phase durations per mode (minutes) ---\nconst modeDurations = {\n    eco: { filling:5, washing:60, rinsing:15, spinning:10, drying:30 },\n    normal: { filling:5, washing:45, rinsing:15, spinning:10, drying:20 },\n    quick: { filling:3, washing:20, rinsing:10, spinning:5, drying:10 },\n    heavy: { filling:5, washing:75, rinsing:20, spinning:15, drying:40 },\n    delicate: { filling:5, washing:30, rinsing:15, spinning:5, drying:10 }\n};\n\n// --- Power per phase (Watts) ---\nconst phasePower = { filling:50, washing:500, rinsing:300, spinning:800, drying:2000, completed:0 };\n\n// --- Start new cycle if idle ---\nif (!running && phase === 'idle') {\n    running = true;\n    const modes = Object.keys(modeDurations);\n    mode = modes[Math.floor(Math.random() * modes.length)];\n    phase = 'filling';\n    remainingTime = modeDurations[mode][phase];\n}\n\n// --- Progress cycle ---\nif (running) {\n    remainingTime -= 1 * scale;\n\n    if (remainingTime <= 0) {\n        const phases = ['filling','washing','rinsing','spinning','drying'];\n        const currentIndex = phases.indexOf(phase);\n\n        if (currentIndex < phases.length - 1) {\n            phase = phases[currentIndex + 1];\n            remainingTime = modeDurations[mode][phase];\n        } else {\n            // Cycle completed\n            phase = 'completed';\n            running = false;\n            remainingTime = 0;\n        }\n    }\n}\n\n// --- Instantaneous power ---\nlet currentPower = running ? phasePower[phase] || 0 : 0;\n\n// --- Energy usage (kWh) ---\nenergy += (currentPower / 1000) * (tickSeconds / 3600);\n\n// --- Water usage ---\nif (['filling','washing','rinsing'].includes(phase)) {\n    waterUsed += Math.random() * 0.5 * scale;\n}\n\n// --- Simulated values ---\nlet waterTemp = (phase === 'washing') ? 40 + Math.random()*10 : 25;\nlet spinSpeed = (phase === 'spinning') ? 800 + Math.floor(Math.random()*400) : 0;\nlet loadWeight = 5 + Math.random()*3;\n\n// --- Door status ---\nlet doorStatus = (running || phase === 'completed') ? 'locked' : 'closed';\n\n// --- Save state ---\nflow.set('laundry.phase', phase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\nflow.set('laundry.mode', mode);\n\n// --- Node status feedback ---\nlet color = \"grey\", shape = \"ring\", text = \"\";\n\nif (!running && phase === 'completed') {\n    color = 'green';\n    shape = 'ring';\n    text = ` Cycle Completed | 0 W`;\n} else if (running) {\n    color = 'blue';\n    shape = 'dot';\n    text = `${phase.toUpperCase()} | ${remainingTime} min left | ${currentPower} W`;\n}\n\nif (doorStatus === 'open') {\n    color = 'red';\n    text = ' Door Open';\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: 'laundry',\n    power: 'ON',\n    running,\n    mode,\n    phase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    currentPower: currentPower, // instantaneous Watts\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6030,
        "y": 1240,
        "wires": [
            [
                "a4fc2573a28ef76a"
            ]
        ]
    },
    {
        "id": "e098b7eba34255a8",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "aae6bf515142caa9",
        "name": "Laundry Device",
        "info": "",
        "x": 6020,
        "y": 1180,
        "wires": []
    },
    {
        "id": "91734d7fb3aa6d33",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "8a08412bbf9f11a0",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator (Auto Stop/Start by Humidity) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickMinutes = 1 * scale; // 1 tick = 1 minute\n\n// --- Persistent state ---\nlet running = flow.get('dehumidifier.running');\nif (running === undefined) running = true;\n\nlet tankLevel = flow.get('dehumidifier.tankLevel') || 0;\nlet elapsedMinutes = flow.get('dehumidifier.elapsedMinutes') || 0;\n\n// Fixed mode and fan speed\nconst mode = \"auto\";\nconst fanSpeed = \"medium\";\n\n// Random environment humidity\nlet environmentHumidity = msg.payload.humidity || 45; // current room humidity\n\n// --- Auto Stop/Start logic ---\nif (environmentHumidity <= 50) {\n    running = false; // stop dehumidifier\n} else if (environmentHumidity > 50) {\n    running = true;  // start dehumidifier\n}\n\n// Power settings\nconst powerWatts = running ? 200 : 0; // instantaneous Watts\n\n// --- Run logic ---\nif (running) {\n    // Increment elapsed time\n    elapsedMinutes += tickMinutes;\n\n    // Gradual tank filling step-by-step (small random increment per minute)\n    const humidityRemoved = parseFloat((Math.random() * 2 + 0.5).toFixed(2)); // 0.52.5% per tick\n    tankLevel = Math.min(100, tankLevel + humidityRemoved);\n\n    // Reset tank if full or after 60 min\n    if (tankLevel >= 100 || elapsedMinutes >= 60) {\n        tankLevel = 0;\n        elapsedMinutes = 0;\n    }\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.dehumidifier') || 0;\nfunction wattToKwh(powerWatts, minutes) {\n    return (powerWatts / 1000) * (minutes / 60);\n}\nif (powerWatts > 0) energy += wattToKwh(powerWatts, tickMinutes);\n\n// --- Save persistent state ---\nflow.set('dehumidifier.running', running);\nflow.set('dehumidifier.tankLevel', tankLevel);\nflow.set('dehumidifier.elapsedMinutes', elapsedMinutes);\nflow.set('energy.dehumidifier', energy);\n\n// --- Node status feedback ---\nlet color = running ? \"blue\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\n\n// Calculate progress as percentage of 60 min run\nconst progressPercent = Math.min(100, Math.round((elapsedMinutes / 60) * 100));\nlet text = running \n    ? `${environmentHumidity}% | ${mode.toUpperCase()} | ${powerWatts} W `\n    : `${environmentHumidity}% | OFF | 0 W `;\n\n// Update node status\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    progressPercent: progressPercent,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: powerWatts,\n    humidity: environmentHumidity,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6040,
        "y": 1500,
        "wires": [
            [
                "231b1ccb76880334"
            ]
        ]
    },
    {
        "id": "231b1ccb76880334",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "8a08412bbf9f11a0",
        "name": "Dehumidifier AsyncAPI",
        "x": 6290,
        "y": 1500,
        "wires": [
            [
                "a8adbd77b3a00cbc",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "a8adbd77b3a00cbc",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "8a08412bbf9f11a0",
        "name": "Dehumidifier Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 6600,
        "y": 1480,
        "wires": []
    },
    {
        "id": "8dbd13d9a8b8a91c",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "8a08412bbf9f11a0",
        "name": "Dehimidifier Device",
        "info": "",
        "x": 6030,
        "y": 1440,
        "wires": []
    },
    {
        "id": "f3b1d4be95deac6f",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "e6db06e9dcfcc16d",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator (30 min Standard Mode) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickSeconds = 1 * scale; // 1 tick = 1 real second\n\n// Check Smart Plug state\nconst plugState = global.get('cookerState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null;\n}\n\nlet running = true;\n\n// Standard fixed mode\nconst mode = \"bake\"; // standard mode\n\n// Persistent timer in seconds\nlet remainingSeconds = flow.get('cooker.remainingSeconds');\nif (!remainingSeconds) {\n    remainingSeconds = 30 * 60; // 30 minutes in seconds\n}\n\n// Update timer\nif (running) {\n    remainingSeconds = Math.max(0, remainingSeconds - tickSeconds);\n    if (remainingSeconds === 0) running = false;\n}\n\n// Temperatures\nconst currentTemp = running ? 180 : 25; // standard bake temp\nconst setTemp = running ? 200 : 0;\n\n// Instantaneous power in Watts\nconst powerWatts = running ? 1500 : 0;\n\n// Energy tracking in kWh\nlet energy = flow.get('energy.cooker') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (running) energy += wattToKwh(powerWatts, tickSeconds);\nflow.set('energy.cooker', energy);\n\n// Save persistent timer\nflow.set('cooker.remainingSeconds', remainingSeconds);\n\n// --- Node status feedback ---\nlet color = running ? \"orange\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\nlet minutesLeft = Math.ceil(remainingSeconds / 60); // only minutes, round up\n\nlet text = running \n    ? `${mode.toUpperCase()} | ${currentTemp}C  ${setTemp}C | ${minutesLeft} min left | ${powerWatts} W`\n    : `OFF | Temp: ${currentTemp}C | 0 W`;\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode,\n    setTemp,\n    currentTemp,\n    timerMinutes: minutesLeft,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6030,
        "y": 1720,
        "wires": [
            [
                "0d381f2e4d645fa1"
            ]
        ]
    },
    {
        "id": "0d381f2e4d645fa1",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "e6db06e9dcfcc16d",
        "name": "Cooker AsyncAPI",
        "x": 6370,
        "y": 1720,
        "wires": [
            [
                "65602439d6a37035",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "65602439d6a37035",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "e6db06e9dcfcc16d",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6620,
        "y": 1720,
        "wires": []
    },
    {
        "id": "87d7ba53f5d7f466",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "e6db06e9dcfcc16d",
        "name": "Cooker Device",
        "info": "",
        "x": 6020,
        "y": 1660,
        "wires": []
    },
    {
        "id": "c78fe1590a256aef",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "dfefcb553a63afda",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 6550,
        "y": 300,
        "wires": []
    },
    {
        "id": "8ef77f992f883d4b",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "dfefcb553a63afda",
        "name": " Thermostat AsyncAPI",
        "x": 6300,
        "y": 360,
        "wires": [
            [
                "c78fe1590a256aef",
                "4bea898bf80beb2a"
            ]
        ]
    },
    {
        "id": "01acf8c4306f1c99",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "dfefcb553a63afda",
        "name": "Thermostat Telemetry",
        "func": "// Check Smart Plug state before running\nconst plugState = global.get('thermostatState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution\n}\n\n// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature || 22); // default 22C\nlet envHumidity = msg.payload.humidity || 45;\n\n// Desired temperature\nconst desired = Math.floor(20 + Math.random() * 11);\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nlet currentPower = 0; // W\n\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5;\n    currentPower = 2000; // heater power in W\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5;\n    currentPower = 1200; // AC power in W\n}\n\n// Energy tracking (cumulative kWh)\nlet energy = flow.get('energy.thermostat') || 0;\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\n// Add to cumulative energy\nenergy += wattToKwh(currentPower, tickDuration);\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// --- Node status for visual feedback ---\nlet color = 'grey';\nlet shape = 'ring';\nlet text = 'Idle';\n\nif (mode === 'heat') {\n    color = 'red';\n    shape = 'dot';\n    text = `HEAT | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else if (mode === 'cool') {\n    color = 'blue';\n    shape = 'dot';\n    text = `COOL | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else {\n    text = `IDLE | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    power: plugState,       // instantaneous W\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6040,
        "y": 360,
        "wires": [
            [
                "8ef77f992f883d4b"
            ]
        ]
    },
    {
        "id": "90e49ef027cfac89",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "dfefcb553a63afda",
        "name": "Thermostat Device",
        "info": "",
        "x": 6030,
        "y": 300,
        "wires": []
    },
    {
        "id": "34f502e92c073b72",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "9e1acfb34c8e68b0",
        "name": "SMARTHOME",
        "info": "",
        "x": 4460,
        "y": 240,
        "wires": []
    },
    {
        "id": "14bba24040d29845",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "9b1896d497f9ecb4",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 4810,
        "y": 280,
        "wires": []
    },
    {
        "id": "665a75501870567d",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9b1896d497f9ecb4",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4810,
        "y": 340,
        "wires": [
            [
                "5fd4c653e7ae7bc8"
            ]
        ]
    },
    {
        "id": "c35948e46e2ee075",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9b1896d497f9ecb4",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4800,
        "y": 410,
        "wires": [
            [
                "5fd4c653e7ae7bc8"
            ]
        ]
    },
    {
        "id": "af801dbd2796e767",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "9b1896d497f9ecb4",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('thermostatState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5400,
        "y": 380,
        "wires": [
            [
                "01acf8c4306f1c99"
            ]
        ]
    },
    {
        "id": "8b2763acd1d04bde",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "9b1896d497f9ecb4",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5470,
        "y": 300,
        "wires": []
    },
    {
        "id": "5fd4c653e7ae7bc8",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "9b1896d497f9ecb4",
        "name": "Thermostat webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setSmartPlugState",
            "hasOperationId": true,
            "path": "/smartplug/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5100,
        "y": 380,
        "wires": [
            [
                "af801dbd2796e767",
                "8b2763acd1d04bde"
            ]
        ]
    },
    {
        "id": "96457fe4615cdd80",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "042892b32870381c",
        "name": "Smartplug for cooker",
        "info": "",
        "x": 4770,
        "y": 1900,
        "wires": []
    },
    {
        "id": "1ff1e823ddd61546",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "042892b32870381c",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4790,
        "y": 1960,
        "wires": [
            [
                "4d782da3786fedf9"
            ]
        ]
    },
    {
        "id": "db5067e6b47571b4",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "042892b32870381c",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4780,
        "y": 2030,
        "wires": [
            [
                "4d782da3786fedf9"
            ]
        ]
    },
    {
        "id": "90fb6bf0c347c7c3",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "042892b32870381c",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('cookerState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5380,
        "y": 2000,
        "wires": [
            [
                "f3b1d4be95deac6f"
            ]
        ]
    },
    {
        "id": "88bae9d88638aa93",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "042892b32870381c",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5430,
        "y": 1900,
        "wires": []
    },
    {
        "id": "4d782da3786fedf9",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "042892b32870381c",
        "name": "Cooker webhook",
        "configUrlNode": "742282c109ee77de",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setCookerPlugState",
            "hasOperationId": true,
            "path": "/smartplug/cooker/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5070,
        "y": 2000,
        "wires": [
            [
                "90fb6bf0c347c7c3",
                "88bae9d88638aa93"
            ]
        ]
    },
    {
        "id": "386905f3b034dacf",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "a12ae159f8cb4da2",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 4970,
        "y": 940,
        "wires": [
            [
                "12408e7815a3888d"
            ]
        ]
    },
    {
        "id": "12408e7815a3888d",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "a12ae159f8cb4da2",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60); // 1s = 1 minute\n}\n\n// --- Realistic Environment Base ---\nconst baseTemp = 22; // C\nconst baseHumidity = 70; // %\nconst hour = new Date().getHours(); // local time for light simulation\n\n// Get previous state\nlet currentTemp = flow.get('env.temperature') || baseTemp;\nlet currentHumidity = flow.get('env.humidity') || baseHumidity;\nlet currentLight = flow.get('env.lightIntensity') || 50;\n\n// --- Apply small drift ---\ncurrentTemp += (Math.random() * 0.4 - 0.2); // 0.2C\ncurrentHumidity += (Math.random() * 2 - 1);  // 1%\ncurrentHumidity = Math.max(20, Math.min(70, currentHumidity)); // clamp realistic\n// Light based on time of day\nif (hour >= 6 && hour < 18) {\n    currentLight = 70 + Math.floor(Math.random() * 30); // day\n} else {\n    currentLight = 0 + Math.floor(Math.random() * 20);  // night\n}\n\n// Save state for next tick\nflow.set('env.temperature', currentTemp);\nflow.set('env.humidity', currentHumidity);\nflow.set('env.lightIntensity', currentLight);\nflow.set('current_temp', currentTemp);\n\n// --- Output payload ---\nmsg.payload = {\n    environment: true,\n    temperature: currentTemp.toFixed(1),\n    humidity: currentHumidity.toFixed(1),\n    lightIntensity: currentLight,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\")\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5310,
        "y": 940,
        "wires": [
            [
                "4f73941073be689a",
                "fcb20853039afb06",
                "d6229089f43403c5",
                "f26375516505b82f",
                "91734d7fb3aa6d33",
                "f3b1d4be95deac6f",
                "01acf8c4306f1c99",
                "17d18fe4136d511c"
            ]
        ]
    },
    {
        "id": "a829aaff56842c56",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "a12ae159f8cb4da2",
        "name": "Enviroment variables",
        "info": "",
        "x": 4960,
        "y": 880,
        "wires": []
    },
    {
        "id": "129f87b50ac43168",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "9977b3406dec1a0a",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 4780,
        "y": 1080,
        "wires": []
    },
    {
        "id": "90f81d4103b0fb08",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9977b3406dec1a0a",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4790,
        "y": 1140,
        "wires": [
            [
                "1dca671babce81b3"
            ]
        ]
    },
    {
        "id": "7f2390bbf67fd161",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9977b3406dec1a0a",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4780,
        "y": 1210,
        "wires": [
            [
                "1dca671babce81b3"
            ]
        ]
    },
    {
        "id": "5424d92c20fe97aa",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "9977b3406dec1a0a",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('lightState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5380,
        "y": 1180,
        "wires": [
            [
                "fcb20853039afb06"
            ]
        ]
    },
    {
        "id": "1926e50ad77a4e7f",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "9977b3406dec1a0a",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5430,
        "y": 1080,
        "wires": []
    },
    {
        "id": "1dca671babce81b3",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "9977b3406dec1a0a",
        "name": "",
        "configUrlNode": "f63fb066d1c65936",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setLightsPlugState",
            "hasOperationId": true,
            "path": "/smartplug/lights/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart Lights plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5090,
        "y": 1160,
        "wires": [
            [
                "5424d92c20fe97aa",
                "1926e50ad77a4e7f"
            ],
            []
        ]
    },
    {
        "id": "c32b85c113f66e59",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "c45d7f2673c9633a",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 4790,
        "y": 600,
        "wires": []
    },
    {
        "id": "41aecbcae0c8167a",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "c45d7f2673c9633a",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4790,
        "y": 660,
        "wires": [
            [
                "510e274d5690b428"
            ]
        ]
    },
    {
        "id": "b237b47e91c6e6bd",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "c45d7f2673c9633a",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4780,
        "y": 730,
        "wires": [
            [
                "510e274d5690b428"
            ]
        ]
    },
    {
        "id": "4718f5db45ffeec2",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "c45d7f2673c9633a",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('acState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5380,
        "y": 700,
        "wires": [
            [
                "4f73941073be689a"
            ]
        ]
    },
    {
        "id": "454bc96d7f652be3",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "c45d7f2673c9633a",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5450,
        "y": 620,
        "wires": []
    },
    {
        "id": "510e274d5690b428",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "c45d7f2673c9633a",
        "name": "",
        "configUrlNode": "d7b4d9ce6378ec33",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setACPlugState",
            "hasOperationId": true,
            "path": "/smartplug/ac/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    },
                    "temperature": {
                        "name": "temperature",
                        "activeFilter": ""
                    },
                    "mode": {
                        "name": "mode",
                        "activeFilter": ""
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart AC plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid parameters specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5080,
        "y": 660,
        "wires": [
            [
                "4718f5db45ffeec2"
            ],
            [
                "454bc96d7f652be3"
            ]
        ]
    },
    {
        "id": "14015576079c66b1",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "0c808411f05c1ea6",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 4760,
        "y": 1320,
        "wires": []
    },
    {
        "id": "61303bf79d8aa7fd",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "0c808411f05c1ea6",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4770,
        "y": 1380,
        "wires": [
            [
                "11747bc89babe05c"
            ]
        ]
    },
    {
        "id": "5dbf4ea61e01a2f8",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "0c808411f05c1ea6",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4760,
        "y": 1450,
        "wires": [
            [
                "11747bc89babe05c"
            ]
        ]
    },
    {
        "id": "e53c4a76ace25844",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "0c808411f05c1ea6",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('laundryState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5360,
        "y": 1420,
        "wires": [
            [
                "f26375516505b82f"
            ]
        ]
    },
    {
        "id": "13bb5a423f014606",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "0c808411f05c1ea6",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5410,
        "y": 1320,
        "wires": []
    },
    {
        "id": "11747bc89babe05c",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "0c808411f05c1ea6",
        "name": "",
        "configUrlNode": "a33f75c91933dc08",
        "apiTag": "Laundry",
        "keepAuth": false,
        "operationData": {
            "id": "setLaundryState",
            "hasOperationId": true,
            "path": "/smartplug/laundry/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Laundry plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5020,
        "y": 1380,
        "wires": [
            [
                "e53c4a76ace25844",
                "13bb5a423f014606"
            ],
            []
        ]
    },
    {
        "id": "e748ae4d00d9d870",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "421452f3a4703c8e",
        "name": "Dehumidifier webhook",
        "configUrlNode": "7b3a2e9531bb364e",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setDehumidifierPlugState",
            "hasOperationId": true,
            "path": "/smartplug/dehumidifier/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Dehumidifier Smart Plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5120,
        "y": 1700,
        "wires": [
            [
                "aa0f049af23273a0"
            ],
            [
                "a99d8953d79ecfad"
            ]
        ]
    },
    {
        "id": "17d18fe4136d511c",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "421452f3a4703c8e",
        "name": "trigger humidifier webhook",
        "func": "// Default values\nlet state = \"off\";\nlet humidity = 0;\n\n// Check if humidity exists in the incoming payload\nif (msg.payload && msg.payload.humidity !== undefined) {\n    humidity = Number(msg.payload.humidity);\n\n    // Determine the state based on humidity\n    state = humidity > 30 ? \"on\" : \"off\";\n}\n\n// Update payload\nmsg.payload = { state: state };\n\n// Update Node-RED status bubble\nnode.status({\n    fill: state === \"on\" ? \"green\" : \"red\",\n    shape: \"dot\",\n    text: `Humidity: ${humidity.toFixed(1)}%  ${state.toUpperCase()}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4820,
        "y": 1720,
        "wires": [
            [
                "e748ae4d00d9d870"
            ]
        ]
    },
    {
        "id": "aa0f049af23273a0",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "421452f3a4703c8e",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5390,
        "y": 1620,
        "wires": []
    },
    {
        "id": "a99d8953d79ecfad",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "421452f3a4703c8e",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    // Save the current state globally\n    global.set('dehumidifierState', msg.payload.state);\n\n    // Update the node status\n    const stateText = msg.payload.state === 'on' ? 'ON' : 'OFF';\n    const color = msg.payload.state === 'on' ? 'green' : 'red';\n\n    node.status({\n        fill: color,\n        shape: 'dot',\n        text: `Dehumidifier is ${stateText}`\n    });\n}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5420,
        "y": 1740,
        "wires": [
            [
                "91734d7fb3aa6d33"
            ]
        ]
    },
    {
        "id": "6b4487e8d3d02732",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "421452f3a4703c8e",
        "name": "Dehumidifier smartplug",
        "info": "",
        "x": 4760,
        "y": 1620,
        "wires": []
    },
    {
        "id": "2cf65e113c2b4a7b",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "43e9cdc67bd872b9",
        "name": "reset simulation",
        "info": "",
        "x": 7040,
        "y": 1240,
        "wires": []
    },
    {
        "id": "ac82794adfa37acc",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "43e9cdc67bd872b9",
        "name": "Reset Energy Counter",
        "func": "// --- Reset all device energy values ---\nconst devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\n\n// Reset each devices energy to 0\ndevices.forEach(d => flow.set(`energy.${d}`, 0));\n\n// Reset time period\nflow.set('hours', 1);\n\nnode.status({ fill: \"yellow\", shape: \"ring\", text: \"Energy counters reset\" });\n\n// Output a confirmation message\nmsg.payload = {\n    reset: true,\n    message: \"All energy counters have been reset to 0\",\n    devices: devices\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 7340,
        "y": 1300,
        "wires": [
            []
        ]
    },
    {
        "id": "b389bcd9c3b36626",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "43e9cdc67bd872b9",
        "name": " Reset Energy Counters",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 7090,
        "y": 1300,
        "wires": [
            [
                "ac82794adfa37acc"
            ]
        ]
    },
    {
        "id": "6392dd4d3971d9f8",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Total Energy Calculator",
        "func": "let devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\nlet hours = flow.get('hours') || 1; // time period in hours\n\n// Sum all device energy values\nlet totalW = devices.reduce((sum, d) => sum + (flow.get(`energy.${d}`) || 0), 0);\nlet totalKWh = totalW * hours / 1000;\n\n// Round and prepare output\nmsg.totalEnergy = `${totalKWh.toFixed(3)} kWh`;\n\n// --- Node status display ---\nlet color = \"green\";\nlet shape = \"dot\";\nlet text = `Total: ${totalKWh.toFixed(3)} kWh`;\n\nif (totalKWh === 0) {\n    color = \"grey\";\n    shape = \"ring\";\n    text = \"No energy recorded\";\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// Output message\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 7170,
        "y": 3140,
        "wires": [
            [
                "5273dd8568cb4dcb",
                "0f7c797c6e5f1852"
            ]
        ]
    },
    {
        "id": "5273dd8568cb4dcb",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "Total Energy Debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "totalEnergy",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 7250,
        "y": 3300,
        "wires": []
    },
    {
        "id": "07c1d2a55222992e",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "916e0cc111af8d8b",
        "name": "AC Telemetry",
        "func": "// === Air Conditioner Telemetry Simulator (Smart Plug Controlled) ===\n\n// --- Check Smart Plug state ---\nconst plugState = global.get('acState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution when AC plug is off\n}\n\n// --- Environment values ---\nlet envTemp = parseFloat(msg.payload.temperature || 25);\nlet envHumidity = msg.payload.humidity || 50;\n\n// --- Persistent setpoint (holds same for 1 hour) ---\nlet setpoint = flow.get('ac.setpoint');\nlet setpointTimer = flow.get('ac.setpointTimer') || 0;\n\n// Initialize or refresh setpoint every 3600 simulated seconds\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\nsetpointTimer += tickDuration;\n\nif (!setpoint || setpointTimer >= 3600) {\n    setpoint = Math.floor(16 + Math.random() * 15); // 1630C\n    setpointTimer = 0;\n}\n\n// --- Current temperature drift ---\nlet current = flow.get('ac.currentTemp') || envTemp;\ncurrent += (Math.random() - 0.5) * 0.3; // small drift 0.15C\n\n// --- Determine AC mode ---\nlet mode = 'idle';\nlet currentPower = 0; // Watts\n\nif (current > setpoint + 1) {\n    mode = 'cool';\n    currentPower = 1200; // cooling\n    current -= 0.5;\n} else if (current < setpoint - 1) {\n    mode = 'heat';\n    currentPower = 2000; // heating\n    current += 0.5;\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.ac') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (currentPower > 0) energy += wattToKwh(currentPower, tickDuration);\n\n// --- Save state ---\nflow.set('ac.setpoint', setpoint);\nflow.set('ac.setpointTimer', setpointTimer);\nflow.set('ac.currentTemp', current);\nflow.set('energy.ac', energy);\n\n// --- Node status feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (mode === 'cool') {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else if (mode === 'heat') {\n    color = \"red\";\n    shape = \"dot\";\n    text = `Heating | ${current.toFixed(1)}C  ${setpoint}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Idle | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"ac\",\n    power: plugState,             // on/off from smart plug\n    temperature: parseFloat(current.toFixed(1)),\n    humidity: envHumidity,\n    setpoint: setpoint,\n    mode: mode,\n    currentPower: currentPower,   // instantaneous Watts\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\",\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5980,
        "y": 2880,
        "wires": [
            [
                "b1999fa9dcfcd989"
            ]
        ]
    },
    {
        "id": "b1999fa9dcfcd989",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "916e0cc111af8d8b",
        "name": "AC AsyncAPI",
        "x": 6230,
        "y": 2880,
        "wires": [
            [
                "5a440a8c68ad0010",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "5a440a8c68ad0010",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "916e0cc111af8d8b",
        "name": "AC Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6430,
        "y": 2860,
        "wires": []
    },
    {
        "id": "b83c9fc65863257f",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "916e0cc111af8d8b",
        "name": "AC Device",
        "info": "",
        "x": 5960,
        "y": 2820,
        "wires": []
    },
    {
        "id": "6436ee0649f1e4a5",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "b647d0210ac8b2db",
        "name": "Lights Telemetry",
        "func": "// === Smart Light Telemetry Simulator (Controlled by Smart Plug) ===\n\n// --- Check Smart Plug state first ---\nconst plugState = global.get('lightState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop simulation when plug is off\n}\n\n// --- Environment info ---\nlet envTemp = parseFloat(msg.payload.temperature || 22);\nlet envHumidity = msg.payload.humidity || 45;\nlet envLight = msg.payload.lightIntensity || 50;\n\n// --- Threshold for turning lights ON/OFF (0100) ---\nconst lightThreshold = 30;\nlet state = envLight < lightThreshold ? \"ON\" : \"OFF\";\n\n// --- Light behavior when ON ---\nlet brightness = state === \"ON\" ? Math.floor(50 + Math.random() * 51) : 0; // 50100%\nconst colors = [\"#FFFFFF\", \"#FFAA00\", \"#00FFAA\", \"#AA00FF\"];\nlet color = colors[Math.floor(Math.random() * colors.length)];\nlet colorTemperature = Math.floor(2700 + Math.random() * (6500 - 2700));\nconst modes = [\"normal\", \"reading\", \"nightlight\", \"ambient\", \"effect\"];\nlet mode = modes[Math.floor(Math.random() * modes.length)];\nlet effect = mode === \"effect\" ? [\"rainbow\", \"pulse\", \"candle\"][Math.floor(Math.random() * 3)] : \"\";\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.light') || 0;\nconst power = state === \"ON\" ? 8 + Math.random() * 2 : 0; // W\nenergy += (power / 1000) * (tickSeconds / 3600); // convert to kWh\nflow.set('energy.light', parseFloat(energy.toFixed(3)));\n\n// --- Node status for dashboard ---\nlet colorStatus = state === \"ON\" ? \"green\" : \"red\";\nlet shape = state === \"ON\" ? \"dot\" : \"ring\";\nlet text = `${state} | ${power.toFixed(1)} W`;\n\nnode.status({ fill: colorStatus, shape: shape, text: text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"light\",\n    power: plugState, // shows if plug is ON/OFF\n    state: state,\n    brightness,\n    color,\n    colorTemperature,\n    mode,\n    effect,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    voltage: 230,\n    environmentTemp: envTemp,\n    environmentHumidity: envHumidity,\n    environmentLight: envLight,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5980,
        "y": 3100,
        "wires": [
            [
                "732692525fc05f58"
            ]
        ]
    },
    {
        "id": "732692525fc05f58",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "b647d0210ac8b2db",
        "name": "Lights AsyncAPI",
        "x": 6240,
        "y": 3100,
        "wires": [
            [
                "ee91f8cb140a5675",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "ee91f8cb140a5675",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "b647d0210ac8b2db",
        "name": "Lights Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6470,
        "y": 3060,
        "wires": []
    },
    {
        "id": "7c0f155687cb104e",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "b647d0210ac8b2db",
        "name": "Lights",
        "info": "",
        "x": 5950,
        "y": 3040,
        "wires": []
    },
    {
        "id": "130b1881150a300d",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "72c6c9f087ddb6ec",
        "name": "Fridge Telemetry",
        "func": "// === Fridge & Freezer Telemetry Simulator (Safe Temperatures) ===\n\n// Desired temps (user setpoints)\nconst fridgeSet = flow.get(\"fridge.setTemp\") || 4;     // C\nconst freezerSet = flow.get(\"freezer.setTemp\") || -18; // C\n\n// Current temps (with drift around setpoint)\nlet fridgeTemp = flow.get(\"fridge.currentTemp\") ?? fridgeSet + (Math.random() * 2 - 1);\nlet freezerTemp = flow.get(\"freezer.currentTemp\") ?? freezerSet + (Math.random() * 2 - 1);\n\n// --- Simulation scaling ---\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickSeconds = 1 * scale;  // seconds per tick\n\n// Random drift\nfridgeTemp += (Math.random() * 0.4 - 0.2);   // 0.2C\nfreezerTemp += (Math.random() * 0.6 - 0.3);  // 0.3C\n\n// Compressor state logic\nlet compressor = \"OFF\";\nlet currentPower = 5; // idle watts\n\nif (fridgeTemp > fridgeSet + 1) {\n    compressor = \"ON\";\n    fridgeTemp -= 0.3;  // small decrement per tick\n    if (fridgeTemp < fridgeSet) fridgeTemp = fridgeSet; // prevent overcooling\n    currentPower = 150;\n}\n\nif (freezerTemp > freezerSet + 1) {\n    compressor = \"ON\";\n    freezerTemp -= 0.5;\n    if (freezerTemp < freezerSet) freezerTemp = freezerSet; // prevent overcooling\n    currentPower = 150;\n}\n\n// Energy usage tracking\nlet energy = flow.get(\"energy.fridge\") || 0;\nfunction wattToKwh(power, sec) {\n    return (power / 1000) * (sec / 3600);\n}\nenergy += wattToKwh(currentPower, tickSeconds);\nflow.set(\"energy.fridge\", energy);\n\n// Door status simulation (10% chance door is open)\nlet doorStatus = \"closed\";\nif (Math.random() < 0.1) {\n    doorStatus = Math.random() > 0.5 ? \"fridge_open\" : \"freezer_open\";\n}\n\n// Save temps for next tick\nflow.set(\"fridge.currentTemp\", fridgeTemp);\nflow.set(\"freezer.currentTemp\", freezerTemp);\n\n// --- Node status visual feedback ---\nlet color = \"grey\";\nlet shape = \"ring\";\nlet text = \"\";\n\nif (doorStatus !== \"closed\") {\n    color = \"red\";\n    shape = \"dot\";\n    text = ` Door Open (${doorStatus.replace(\"_\", \" \")}) | ${currentPower} W`;\n} else if (compressor === \"ON\") {\n    color = \"blue\";\n    shape = \"dot\";\n    text = `Cooling ON | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n} else {\n    color = \"green\";\n    shape = \"ring\";\n    text = `Stable | ${fridgeTemp.toFixed(1)}C / ${freezerTemp.toFixed(1)}C | ${currentPower} W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"fridge\",\n    power: compressor,\n    mode: \"normal\",\n    fridgeTemp: parseFloat(fridgeTemp.toFixed(1)),\n    freezerTemp: parseFloat(freezerTemp.toFixed(1)),\n    doorStatus: doorStatus,\n    humidityControl: [\"low\", \"medium\", \"high\"][Math.floor(Math.random() * 3)],\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: currentPower, // instantaneous W\n    alarms: doorStatus !== \"closed\" ? [\"door_open\"] : [],\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5990,
        "y": 3320,
        "wires": [
            [
                "83d4f6b673ca3c70"
            ]
        ]
    },
    {
        "id": "83d4f6b673ca3c70",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "72c6c9f087ddb6ec",
        "name": "Fridge AsyncAPI",
        "x": 6240,
        "y": 3320,
        "wires": [
            [
                "9553a07e0712330f",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "9553a07e0712330f",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "72c6c9f087ddb6ec",
        "name": "Fridge Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6500,
        "y": 3340,
        "wires": []
    },
    {
        "id": "6ba095eefd51829f",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "72c6c9f087ddb6ec",
        "name": "Fridge Device",
        "info": "",
        "x": 5970,
        "y": 3260,
        "wires": []
    },
    {
        "id": "c507d6daf4ca49a3",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "6950d3876bef51db",
        "name": "Launder AsyncAPI",
        "x": 6230,
        "y": 3560,
        "wires": [
            [
                "80858ceb9dc58940",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "80858ceb9dc58940",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "6950d3876bef51db",
        "name": "Launder Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6480,
        "y": 3580,
        "wires": []
    },
    {
        "id": "f12856963450124f",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "6950d3876bef51db",
        "name": "Laundry Telemetry",
        "func": "// --- Full Washing Machine Cycle Simulator ---\n\n// --- Simulation scale ---\nconst scale = global.get(\"simulationScale\") || 60; // seconds per tick\nconst tickSeconds = 60 * scale; // 1 tick = 1 minute\n\n// --- Check Smart Plug / power ---\nconst plugState = global.get('laundryState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  cycle paused' });\n    return null;\n}\n\n// --- Load persistent state ---\nlet phase = flow.get('laundry.phase') || 'idle';\nlet remainingTime = flow.get('laundry.remainingTime') || 0;\nlet running = flow.get('laundry.running') || (plugState === 'on' ? true:false);\nlet energy = flow.get('laundry.energy') || 0;\nlet waterUsed = flow.get('laundry.waterUsed') || 0;\nlet mode = flow.get('laundry.mode') || 'normal';\n\n// --- Phase durations per mode (minutes) ---\nconst modeDurations = {\n    eco: { filling:5, washing:60, rinsing:15, spinning:10, drying:30 },\n    normal: { filling:5, washing:45, rinsing:15, spinning:10, drying:20 },\n    quick: { filling:3, washing:20, rinsing:10, spinning:5, drying:10 },\n    heavy: { filling:5, washing:75, rinsing:20, spinning:15, drying:40 },\n    delicate: { filling:5, washing:30, rinsing:15, spinning:5, drying:10 }\n};\n\n// --- Power per phase (Watts) ---\nconst phasePower = { filling:50, washing:500, rinsing:300, spinning:800, drying:2000, completed:0 };\n\n// --- Start new cycle if idle ---\nif (!running && phase === 'idle') {\n    running = true;\n    const modes = Object.keys(modeDurations);\n    mode = modes[Math.floor(Math.random() * modes.length)];\n    phase = 'filling';\n    remainingTime = modeDurations[mode][phase];\n}\n\n// --- Progress cycle ---\nif (running) {\n    remainingTime -= 1 * scale;\n\n    if (remainingTime <= 0) {\n        const phases = ['filling','washing','rinsing','spinning','drying'];\n        const currentIndex = phases.indexOf(phase);\n\n        if (currentIndex < phases.length - 1) {\n            phase = phases[currentIndex + 1];\n            remainingTime = modeDurations[mode][phase];\n        } else {\n            // Cycle completed\n            phase = 'completed';\n            running = false;\n            remainingTime = 0;\n        }\n    }\n}\n\n// --- Instantaneous power ---\nlet currentPower = running ? phasePower[phase] || 0 : 0;\n\n// --- Energy usage (kWh) ---\nenergy += (currentPower / 1000) * (tickSeconds / 3600);\n\n// --- Water usage ---\nif (['filling','washing','rinsing'].includes(phase)) {\n    waterUsed += Math.random() * 0.5 * scale;\n}\n\n// --- Simulated values ---\nlet waterTemp = (phase === 'washing') ? 40 + Math.random()*10 : 25;\nlet spinSpeed = (phase === 'spinning') ? 800 + Math.floor(Math.random()*400) : 0;\nlet loadWeight = 5 + Math.random()*3;\n\n// --- Door status ---\nlet doorStatus = (running || phase === 'completed') ? 'locked' : 'closed';\n\n// --- Save state ---\nflow.set('laundry.phase', phase);\nflow.set('laundry.remainingTime', remainingTime);\nflow.set('laundry.running', running);\nflow.set('laundry.energy', energy);\nflow.set('laundry.waterUsed', waterUsed);\nflow.set('laundry.mode', mode);\n\n// --- Node status feedback ---\nlet color = \"grey\", shape = \"ring\", text = \"\";\n\nif (!running && phase === 'completed') {\n    color = 'green';\n    shape = 'ring';\n    text = ` Cycle Completed | 0 W`;\n} else if (running) {\n    color = 'blue';\n    shape = 'dot';\n    text = `${phase.toUpperCase()} | ${remainingTime} min left | ${currentPower} W`;\n}\n\nif (doorStatus === 'open') {\n    color = 'red';\n    text = ' Door Open';\n}\n\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: 'laundry',\n    power: 'ON',\n    running,\n    mode,\n    phase,\n    waterTemp: parseFloat(waterTemp.toFixed(1)),\n    spinSpeed,\n    remainingTime,\n    loadWeight: parseFloat(loadWeight.toFixed(1)),\n    waterUsed: parseFloat(waterUsed.toFixed(2)),\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    currentPower: currentPower, // instantaneous Watts\n    doorStatus\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5990,
        "y": 3560,
        "wires": [
            [
                "c507d6daf4ca49a3"
            ]
        ]
    },
    {
        "id": "347fe92e7f29c6cd",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "6950d3876bef51db",
        "name": "Laundry Device",
        "info": "",
        "x": 5980,
        "y": 3500,
        "wires": []
    },
    {
        "id": "d7e52f146c39a21d",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "4cd08abf60f35b98",
        "name": "Dehumidifier Telemetry",
        "func": "// --- Dehumidifier Telemetry Simulator (Auto Stop/Start by Humidity) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickMinutes = 1 * scale; // 1 tick = 1 minute\n\n// --- Persistent state ---\nlet running = flow.get('dehumidifier.running');\nif (running === undefined) running = true;\n\nlet tankLevel = flow.get('dehumidifier.tankLevel') || 0;\nlet elapsedMinutes = flow.get('dehumidifier.elapsedMinutes') || 0;\n\n// Fixed mode and fan speed\nconst mode = \"auto\";\nconst fanSpeed = \"medium\";\n\n// Random environment humidity\nlet environmentHumidity = msg.payload.humidity || 45; // current room humidity\n\n// --- Auto Stop/Start logic ---\nif (environmentHumidity <= 50) {\n    running = false; // stop dehumidifier\n} else if (environmentHumidity > 50) {\n    running = true;  // start dehumidifier\n}\n\n// Power settings\nconst powerWatts = running ? 200 : 0; // instantaneous Watts\n\n// --- Run logic ---\nif (running) {\n    // Increment elapsed time\n    elapsedMinutes += tickMinutes;\n\n    // Gradual tank filling step-by-step (small random increment per minute)\n    const humidityRemoved = parseFloat((Math.random() * 2 + 0.5).toFixed(2)); // 0.52.5% per tick\n    tankLevel = Math.min(100, tankLevel + humidityRemoved);\n\n    // Reset tank if full or after 60 min\n    if (tankLevel >= 100 || elapsedMinutes >= 60) {\n        tankLevel = 0;\n        elapsedMinutes = 0;\n    }\n}\n\n// --- Energy tracking (kWh) ---\nlet energy = flow.get('energy.dehumidifier') || 0;\nfunction wattToKwh(powerWatts, minutes) {\n    return (powerWatts / 1000) * (minutes / 60);\n}\nif (powerWatts > 0) energy += wattToKwh(powerWatts, tickMinutes);\n\n// --- Save persistent state ---\nflow.set('dehumidifier.running', running);\nflow.set('dehumidifier.tankLevel', tankLevel);\nflow.set('dehumidifier.elapsedMinutes', elapsedMinutes);\nflow.set('energy.dehumidifier', energy);\n\n// --- Node status feedback ---\nlet color = running ? \"blue\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\n\n// Calculate progress as percentage of 60 min run\nconst progressPercent = Math.min(100, Math.round((elapsedMinutes / 60) * 100));\nlet text = running \n    ? `${environmentHumidity}% | ${mode.toUpperCase()} | ${powerWatts} W `\n    : `${environmentHumidity}% | OFF | 0 W `;\n\n// Update node status\nnode.status({ fill: color, shape: shape, text: text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"dehumidifier\",\n    power: running ? \"ON\" : \"OFF\",\n    mode: mode,\n    fanSpeed: fanSpeed,\n    tankLevel: parseFloat(tankLevel.toFixed(1)),\n    progressPercent: progressPercent,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    currentPower: powerWatts,\n    humidity: environmentHumidity,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6000,
        "y": 3820,
        "wires": [
            [
                "885cd4eed1d3e4fd"
            ]
        ]
    },
    {
        "id": "885cd4eed1d3e4fd",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "4cd08abf60f35b98",
        "name": "Dehumidifier AsyncAPI",
        "x": 6250,
        "y": 3820,
        "wires": [
            [
                "559a6eaac8bfcb75",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "559a6eaac8bfcb75",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "4cd08abf60f35b98",
        "name": "Dehumidifier Debug",
        "active": true,
        "tosidebar": true,
        "complete": "payload",
        "x": 6560,
        "y": 3800,
        "wires": []
    },
    {
        "id": "e1f573577c5bec87",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "4cd08abf60f35b98",
        "name": "Dehimidifier Device",
        "info": "",
        "x": 5990,
        "y": 3760,
        "wires": []
    },
    {
        "id": "aa270da6fd47e4bd",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "48cc597ddf9d2a0b",
        "name": "Cooker Telemetry",
        "func": "// --- Cooker/Oven Telemetry Simulator (30 min Standard Mode) ---\n\n// Simulation scale factor\nconst scale = global.get(\"simulationScale\") || 1; // seconds per tick\nconst tickSeconds = 1 * scale; // 1 tick = 1 real second\n\n// Check Smart Plug state\nconst plugState = global.get('cookerState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null;\n}\n\nlet running = true;\n\n// Standard fixed mode\nconst mode = \"bake\"; // standard mode\n\n// Persistent timer in seconds\nlet remainingSeconds = flow.get('cooker.remainingSeconds');\nif (!remainingSeconds) {\n    remainingSeconds = 30 * 60; // 30 minutes in seconds\n}\n\n// Update timer\nif (running) {\n    remainingSeconds = Math.max(0, remainingSeconds - tickSeconds);\n    if (remainingSeconds === 0) running = false;\n}\n\n// Temperatures\nconst currentTemp = running ? 180 : 25; // standard bake temp\nconst setTemp = running ? 200 : 0;\n\n// Instantaneous power in Watts\nconst powerWatts = running ? 1500 : 0;\n\n// Energy tracking in kWh\nlet energy = flow.get('energy.cooker') || 0;\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\nif (running) energy += wattToKwh(powerWatts, tickSeconds);\nflow.set('energy.cooker', energy);\n\n// Save persistent timer\nflow.set('cooker.remainingSeconds', remainingSeconds);\n\n// --- Node status feedback ---\nlet color = running ? \"orange\" : \"grey\";\nlet shape = running ? \"dot\" : \"ring\";\nlet minutesLeft = Math.ceil(remainingSeconds / 60); // only minutes, round up\n\nlet text = running \n    ? `${mode.toUpperCase()} | ${currentTemp}C  ${setTemp}C | ${minutesLeft} min left | ${powerWatts} W`\n    : `OFF | Temp: ${currentTemp}C | 0 W`;\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry payload ---\nmsg.payload = {\n    device: \"cooker\",\n    power: running ? \"ON\" : \"OFF\",\n    mode,\n    setTemp,\n    currentTemp,\n    timerMinutes: minutesLeft,\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5990,
        "y": 4040,
        "wires": [
            [
                "8965dc7c7248c5a0"
            ]
        ]
    },
    {
        "id": "8965dc7c7248c5a0",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "48cc597ddf9d2a0b",
        "name": "Cooker AsyncAPI",
        "x": 6330,
        "y": 4040,
        "wires": [
            [
                "9e4e3e37ea5512ca",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "9e4e3e37ea5512ca",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "48cc597ddf9d2a0b",
        "name": "Cooker Debug",
        "active": false,
        "tosidebar": true,
        "complete": "payload",
        "x": 6580,
        "y": 4040,
        "wires": []
    },
    {
        "id": "32f4bbef28dc26e0",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "48cc597ddf9d2a0b",
        "name": "Cooker Device",
        "info": "",
        "x": 5980,
        "y": 3980,
        "wires": []
    },
    {
        "id": "9a7ea0f9330c5cf4",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "282ec275aee5bf61",
        "name": "Thermostat Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 6510,
        "y": 2620,
        "wires": []
    },
    {
        "id": "cdc18a7d203d7802",
        "type": "async-api-red",
        "z": "2a4e2856b37c3f19",
        "g": "282ec275aee5bf61",
        "name": " Thermostat AsyncAPI",
        "x": 6260,
        "y": 2680,
        "wires": [
            [
                "9a7ea0f9330c5cf4",
                "6392dd4d3971d9f8"
            ]
        ]
    },
    {
        "id": "7ba787bbf05f5458",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "282ec275aee5bf61",
        "name": "Thermostat Telemetry",
        "func": "// Check Smart Plug state before running\nconst plugState = global.get('thermostatState') || 'off';\nif (plugState !== 'on') {\n    node.status({ fill: 'grey', shape: 'ring', text: 'Plug OFF  telemetry paused' });\n    return null; // stop execution\n}\n\n// Read environment values from input\nlet envTemp = parseFloat(msg.payload.temperature || 22); // default 22C\nlet envHumidity = msg.payload.humidity || 45;\n\n// Desired temperature\nconst desired = Math.floor(20 + Math.random() * 11);\nlet current = envTemp;\n\n// Random drift within 0.5C\ncurrent += (Math.random() - 0.5);\n\n// Determine HVAC mode\nlet mode = 'idle';\nlet currentPower = 0; // W\n\nif (current < desired - 2) {\n    mode = 'heat';\n    current += 0.5;\n    currentPower = 2000; // heater power in W\n} else if (current > desired + 2) {\n    mode = 'cool';\n    current -= 0.5;\n    currentPower = 1200; // AC power in W\n}\n\n// Energy tracking (cumulative kWh)\nlet energy = flow.get('energy.thermostat') || 0;\nconst scale = global.get(\"simulationScale\") || 1;\nconst tickDuration = 1 * scale; // seconds per tick\n\nfunction wattToKwh(powerWatts, seconds) {\n    return (powerWatts / 1000) * (seconds / 3600);\n}\n\n// Add to cumulative energy\nenergy += wattToKwh(currentPower, tickDuration);\n\n// Save state\nflow.set('energy.thermostat', energy);\nflow.set('current_temp', current);\n\n// --- Node status for visual feedback ---\nlet color = 'grey';\nlet shape = 'ring';\nlet text = 'Idle';\n\nif (mode === 'heat') {\n    color = 'red';\n    shape = 'dot';\n    text = `HEAT | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else if (mode === 'cool') {\n    color = 'blue';\n    shape = 'dot';\n    text = `COOL | ${current.toFixed(1)}C  ${desired}C | ${currentPower} W`;\n} else {\n    text = `IDLE | ${current.toFixed(1)}C | 0 W`;\n}\n\nnode.status({ fill: color, shape: shape, text });\n\n// --- Telemetry output ---\nmsg.payload = {\n    device: \"thermostat\",\n    temperature: envTemp,\n    humidity: envHumidity,\n    mode: mode,\n    power: plugState,       // instantaneous W\n    energyUsed: parseFloat(energy.toFixed(3)), // cumulative kWh\n    unit: \"C\"\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 6000,
        "y": 2680,
        "wires": [
            [
                "cdc18a7d203d7802"
            ]
        ]
    },
    {
        "id": "03b62af0414a3c74",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "282ec275aee5bf61",
        "name": "Thermostat Device",
        "info": "",
        "x": 5990,
        "y": 2620,
        "wires": []
    },
    {
        "id": "0aa83a9c829e4ad4",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "1097f133a27f5465",
        "name": "SMARTHOME",
        "info": "",
        "x": 4420,
        "y": 2560,
        "wires": []
    },
    {
        "id": "a0eb03e744b33bb5",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "daee0bc99036aa55",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 4770,
        "y": 2600,
        "wires": []
    },
    {
        "id": "4ed676d7759d01d1",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "daee0bc99036aa55",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4770,
        "y": 2660,
        "wires": [
            [
                "952de4397df0c7ae"
            ]
        ]
    },
    {
        "id": "66c27091763d575e",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "daee0bc99036aa55",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4760,
        "y": 2730,
        "wires": [
            [
                "952de4397df0c7ae"
            ]
        ]
    },
    {
        "id": "314fa057984054c1",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "daee0bc99036aa55",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('thermostatState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5360,
        "y": 2700,
        "wires": [
            [
                "7ba787bbf05f5458"
            ]
        ]
    },
    {
        "id": "9f1c292a383d7bb9",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "daee0bc99036aa55",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5430,
        "y": 2620,
        "wires": []
    },
    {
        "id": "952de4397df0c7ae",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "daee0bc99036aa55",
        "name": "Thermostat webhook",
        "configUrlNode": "f2d3a14b35277c31",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setSmartPlugState",
            "hasOperationId": true,
            "path": "/smartplug/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5060,
        "y": 2700,
        "wires": [
            [
                "314fa057984054c1",
                "9f1c292a383d7bb9"
            ]
        ]
    },
    {
        "id": "de9e631df19e29bd",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "75a075f042f21639",
        "name": "Smartplug for cooker",
        "info": "",
        "x": 4730,
        "y": 4220,
        "wires": []
    },
    {
        "id": "1aeb278cb949a180",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "75a075f042f21639",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4750,
        "y": 4280,
        "wires": [
            [
                "c44afb35658cb1ce"
            ]
        ]
    },
    {
        "id": "38a46258995cfee1",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "75a075f042f21639",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4740,
        "y": 4350,
        "wires": [
            [
                "c44afb35658cb1ce"
            ]
        ]
    },
    {
        "id": "8ac546d28dccce4d",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "75a075f042f21639",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('cookerState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5340,
        "y": 4320,
        "wires": [
            [
                "aa270da6fd47e4bd"
            ]
        ]
    },
    {
        "id": "111a4730411174b2",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "75a075f042f21639",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5390,
        "y": 4220,
        "wires": []
    },
    {
        "id": "c44afb35658cb1ce",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "75a075f042f21639",
        "name": "Cooker webhook",
        "configUrlNode": "742282c109ee77de",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setCookerPlugState",
            "hasOperationId": true,
            "path": "/smartplug/cooker/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 1,
        "responseOutputLabels": [
            {
                "code": "successful",
                "text": "all successful responses (2xx)"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5030,
        "y": 4320,
        "wires": [
            [
                "8ac546d28dccce4d",
                "111a4730411174b2"
            ]
        ]
    },
    {
        "id": "80c71fda039ddbda",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "2726468caef530d8",
        "name": "Sim Clock Trigger",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "0.1",
        "topic": "",
        "x": 4930,
        "y": 3260,
        "wires": [
            [
                "7a33a172ad66fec5"
            ]
        ]
    },
    {
        "id": "7a33a172ad66fec5",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "2726468caef530d8",
        "name": "Environment Generator",
        "func": "// --- Simulation Scale ---\nif (!global.get(\"simulationScale\")) {\n    global.set(\"simulationScale\", 60); // 1s = 1 minute\n}\n\n// --- Realistic Environment Base ---\nconst baseTemp = 22; // C\nconst baseHumidity = 70; // %\nconst hour = new Date().getHours(); // local time for light simulation\n\n// Get previous state\nlet currentTemp = flow.get('env.temperature') || baseTemp;\nlet currentHumidity = flow.get('env.humidity') || baseHumidity;\nlet currentLight = flow.get('env.lightIntensity') || 50;\n\n// --- Apply small drift ---\ncurrentTemp += (Math.random() * 0.4 - 0.2); // 0.2C\ncurrentHumidity += (Math.random() * 2 - 1);  // 1%\ncurrentHumidity = Math.max(20, Math.min(70, currentHumidity)); // clamp realistic\n// Light based on time of day\nif (hour >= 6 && hour < 18) {\n    currentLight = 70 + Math.floor(Math.random() * 30); // day\n} else {\n    currentLight = 0 + Math.floor(Math.random() * 20);  // night\n}\n\n// Save state for next tick\nflow.set('env.temperature', currentTemp);\nflow.set('env.humidity', currentHumidity);\nflow.set('env.lightIntensity', currentLight);\nflow.set('current_temp', currentTemp);\n\n// --- Output payload ---\nmsg.payload = {\n    environment: true,\n    temperature: currentTemp.toFixed(1),\n    humidity: currentHumidity.toFixed(1),\n    lightIntensity: currentLight,\n    unit: \"C\",\n    simulationScale: global.get(\"simulationScale\")\n};\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5270,
        "y": 3260,
        "wires": [
            [
                "07c1d2a55222992e",
                "6436ee0649f1e4a5",
                "130b1881150a300d",
                "f12856963450124f",
                "d7e52f146c39a21d",
                "aa270da6fd47e4bd",
                "7ba787bbf05f5458",
                "b902d9f53cac3f5f"
            ]
        ]
    },
    {
        "id": "7ad1eec5c580b00c",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "2726468caef530d8",
        "name": "Enviroment variables",
        "info": "",
        "x": 4920,
        "y": 3200,
        "wires": []
    },
    {
        "id": "8405f5d4af553c08",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "1ba2b0626374db8a",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 4740,
        "y": 3400,
        "wires": []
    },
    {
        "id": "7ff5edef9a11a224",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "1ba2b0626374db8a",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4750,
        "y": 3460,
        "wires": [
            [
                "db9b60bc8cb02cc7"
            ]
        ]
    },
    {
        "id": "62648ca35a019951",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "1ba2b0626374db8a",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4740,
        "y": 3530,
        "wires": [
            [
                "db9b60bc8cb02cc7"
            ]
        ]
    },
    {
        "id": "b42a0dd3998c1b01",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "1ba2b0626374db8a",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('lightState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5340,
        "y": 3500,
        "wires": [
            [
                "6436ee0649f1e4a5"
            ]
        ]
    },
    {
        "id": "9675c36195775bb2",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "1ba2b0626374db8a",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5390,
        "y": 3400,
        "wires": []
    },
    {
        "id": "db9b60bc8cb02cc7",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "1ba2b0626374db8a",
        "name": "",
        "configUrlNode": "f63fb066d1c65936",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setLightsPlugState",
            "hasOperationId": true,
            "path": "/smartplug/lights/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart Lights plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5050,
        "y": 3480,
        "wires": [
            [
                "b42a0dd3998c1b01",
                "9675c36195775bb2"
            ],
            []
        ]
    },
    {
        "id": "a9a17073d5a6ae7c",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "41caf86cf1e205e8",
        "name": "Smartplug for thermostat",
        "info": "",
        "x": 4750,
        "y": 2920,
        "wires": []
    },
    {
        "id": "235847ca7d977ddd",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "41caf86cf1e205e8",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4750,
        "y": 2980,
        "wires": [
            [
                "077e4669553aa7f6"
            ]
        ]
    },
    {
        "id": "4625ab24835db11a",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "41caf86cf1e205e8",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4740,
        "y": 3050,
        "wires": [
            [
                "077e4669553aa7f6"
            ]
        ]
    },
    {
        "id": "56fd5f5da3b182f5",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "41caf86cf1e205e8",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('acState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5340,
        "y": 3020,
        "wires": [
            [
                "07c1d2a55222992e"
            ]
        ]
    },
    {
        "id": "8a7e7c1acd4a2dd6",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "41caf86cf1e205e8",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5410,
        "y": 2940,
        "wires": []
    },
    {
        "id": "077e4669553aa7f6",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "41caf86cf1e205e8",
        "name": "",
        "configUrlNode": "d7b4d9ce6378ec33",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setACPlugState",
            "hasOperationId": true,
            "path": "/smartplug/ac/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    },
                    "temperature": {
                        "name": "temperature",
                        "activeFilter": ""
                    },
                    "mode": {
                        "name": "mode",
                        "activeFilter": ""
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart AC plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid parameters specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5040,
        "y": 2980,
        "wires": [
            [
                "56fd5f5da3b182f5"
            ],
            [
                "8a7e7c1acd4a2dd6"
            ]
        ]
    },
    {
        "id": "09f15728336619d1",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "9974167b54831097",
        "name": "Smartplug for laundry",
        "info": "",
        "x": 4720,
        "y": 3640,
        "wires": []
    },
    {
        "id": "3ccbdf1f9e4ea311",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9974167b54831097",
        "name": "State -> ON",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 4730,
        "y": 3700,
        "wires": [
            [
                "94b3ddc23c7d9424"
            ]
        ]
    },
    {
        "id": "8750e519a3ef0d6a",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "9974167b54831097",
        "name": "State -> OFF",
        "props": [
            {
                "p": "payload"
            }
        ],
        "payload": "{\"state\":\"off\"}",
        "payloadType": "json",
        "x": 4720,
        "y": 3770,
        "wires": [
            [
                "94b3ddc23c7d9424"
            ]
        ]
    },
    {
        "id": "ba0d7edcb566d101",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "9974167b54831097",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    global.set('laundryState', msg.payload.state);\n    node.status({fill: msg.payload.state === 'on' ? 'green' : 'red', shape: 'dot', text: `Plug ${msg.payload.state}`});\n}\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5320,
        "y": 3740,
        "wires": [
            [
                "f12856963450124f"
            ]
        ]
    },
    {
        "id": "cd3f6327d30fc1e3",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "9974167b54831097",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5370,
        "y": 3640,
        "wires": []
    },
    {
        "id": "94b3ddc23c7d9424",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "9974167b54831097",
        "name": "",
        "configUrlNode": "a33f75c91933dc08",
        "apiTag": "Laundry",
        "keepAuth": false,
        "operationData": {
            "id": "setLaundryState",
            "hasOperationId": true,
            "path": "/smartplug/laundry/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Laundry plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 4980,
        "y": 3700,
        "wires": [
            [
                "ba0d7edcb566d101",
                "cd3f6327d30fc1e3"
            ],
            []
        ]
    },
    {
        "id": "83d7f80b3f0d5327",
        "type": "openApi-red",
        "z": "2a4e2856b37c3f19",
        "g": "80b1a2a950fbf3a4",
        "name": "Dehumidifier webhook",
        "configUrlNode": "7b3a2e9531bb364e",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setDehumidifierPlugState",
            "hasOperationId": true,
            "path": "/smartplug/dehumidifier/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Dehumidifier Smart Plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 5080,
        "y": 4020,
        "wires": [
            [
                "2fa067bacabd514b"
            ],
            [
                "53a696aa61a0d001"
            ]
        ]
    },
    {
        "id": "b902d9f53cac3f5f",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "80b1a2a950fbf3a4",
        "name": "trigger humidifier webhook",
        "func": "// Default values\nlet state = \"off\";\nlet humidity = 0;\n\n// Check if humidity exists in the incoming payload\nif (msg.payload && msg.payload.humidity !== undefined) {\n    humidity = Number(msg.payload.humidity);\n\n    // Determine the state based on humidity\n    state = humidity > 30 ? \"on\" : \"off\";\n}\n\n// Update payload\nmsg.payload = { state: state };\n\n// Update Node-RED status bubble\nnode.status({\n    fill: state === \"on\" ? \"green\" : \"red\",\n    shape: \"dot\",\n    text: `Humidity: ${humidity.toFixed(1)}%  ${state.toUpperCase()}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4780,
        "y": 4040,
        "wires": [
            [
                "83d7f80b3f0d5327"
            ]
        ]
    },
    {
        "id": "2fa067bacabd514b",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "g": "80b1a2a950fbf3a4",
        "name": "Smartplug debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5350,
        "y": 3940,
        "wires": []
    },
    {
        "id": "53a696aa61a0d001",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "80b1a2a950fbf3a4",
        "name": "Save SmartPlug State",
        "func": "if (msg.payload && msg.payload.state) {\n    // Save the current state globally\n    global.set('dehumidifierState', msg.payload.state);\n\n    // Update the node status\n    const stateText = msg.payload.state === 'on' ? 'ON' : 'OFF';\n    const color = msg.payload.state === 'on' ? 'green' : 'red';\n\n    node.status({\n        fill: color,\n        shape: 'dot',\n        text: `Dehumidifier is ${stateText}`\n    });\n}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 5380,
        "y": 4060,
        "wires": [
            [
                "d7e52f146c39a21d"
            ]
        ]
    },
    {
        "id": "ea84a8a798be8b05",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "80b1a2a950fbf3a4",
        "name": "Dehumidifier smartplug",
        "info": "",
        "x": 4720,
        "y": 3940,
        "wires": []
    },
    {
        "id": "397c310be0bc4b4a",
        "type": "comment",
        "z": "2a4e2856b37c3f19",
        "g": "532eae8f62ba2e88",
        "name": "reset simulation",
        "info": "",
        "x": 7000,
        "y": 3560,
        "wires": []
    },
    {
        "id": "785066598243c053",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "g": "532eae8f62ba2e88",
        "name": "Reset Energy Counter",
        "func": "// --- Reset all device energy values ---\nconst devices = ['ac', 'light', 'fridge', 'laundry', 'dehumidifier', 'cooker', 'thermostat'];\n\n// Reset each devices energy to 0\ndevices.forEach(d => flow.set(`energy.${d}`, 0));\n\n// Reset time period\nflow.set('hours', 1);\n\nnode.status({ fill: \"yellow\", shape: \"ring\", text: \"Energy counters reset\" });\n\n// Output a confirmation message\nmsg.payload = {\n    reset: true,\n    message: \"All energy counters have been reset to 0\",\n    devices: devices\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 7300,
        "y": 3620,
        "wires": [
            []
        ]
    },
    {
        "id": "3926588e6002571b",
        "type": "inject",
        "z": "2a4e2856b37c3f19",
        "g": "532eae8f62ba2e88",
        "name": " Reset Energy Counters",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 7050,
        "y": 3620,
        "wires": [
            [
                "785066598243c053"
            ]
        ]
    },
    {
        "id": "05153a2d3b6cdfe4",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "name": "Total energy home 1,2",
        "func": "// Parse the incoming energy\nlet incoming = parseFloat(msg.totalEnergy);     // \"2.531 kWh\"  2.531\nlet id = msg.id;                                // must be 1 or 2\n\n// Validate ID\nif (![1, 2].includes(id)) {\n    node.warn(\"Message missing msg.id (should be 1 or 2)\");\n    return null;\n}\n\n// Store energy for each home\nflow.set(`energy${id}`, incoming);\n\n// Retrieve both energies\nlet h1 = flow.get(\"energy1\") || 0;\nlet h2 = flow.get(\"energy2\") || 0;\n\n// Calculate total\nlet total = h1 + h2;\n\n// Set output\nmsg.total12 = total.toFixed(3) + \" kWh\";\n\n// Status indicator\nnode.status({\n    fill: total === 0 ? \"grey\" : \"blue\",\n    shape: total === 0 ? \"ring\" : \"dot\",\n    text: `Home1+2: ${msg.total12}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4120,
        "y": 2240,
        "wires": [
            [
                "0f7c797c6e5f1852"
            ]
        ]
    },
    {
        "id": "0f7c797c6e5f1852",
        "type": "function",
        "z": "2a4e2856b37c3f19",
        "name": "total energy of hood",
        "func": "// Parse the incoming energy value\nlet incoming = parseFloat(msg.totalEnergy);        // \"2.531 kWh\" --> 2.531\nlet id = msg.id;                                   // Must be 1,2,3 or 4\n\n// If no ID, ignore message\nif (![3, 4].includes(id)) {\n    node.warn(\"Message missing msg.id (should be 1 to 4)\");\n    return null;\n}\n\n// Store this home's energy value\nflow.set(`energy${id}`, incoming);\n\n// Retrieve energies of all 4 homes\nlet e1 = flow.get(\"energy1\") || 0;\nlet e2 = flow.get(\"energy2\") || 0;\nlet e3 = flow.get(\"energy3\") || 0;\nlet e4 = flow.get(\"energy4\") || 0;\n\n// Total sum\nlet total = e1 + e2 + e3 + e4;\n\n// Prepare output\nmsg.totalSum = total.toFixed(3) + \" kWh\";\n\n// Update node status\nnode.status({\n    fill: total === 0 ? \"grey\" : \"green\",\n    shape: total === 0 ? \"ring\" : \"dot\",\n    text: `Total: ${msg.totalSum}`\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 7740,
        "y": 2200,
        "wires": [
            [
                "4d8f0a2ba6dcd101"
            ]
        ]
    },
    {
        "id": "4d8f0a2ba6dcd101",
        "type": "debug",
        "z": "2a4e2856b37c3f19",
        "name": "debug 6",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 7840,
        "y": 2400,
        "wires": []
    },
    {
        "id": "0623d3f2732f194c",
        "type": "debug",
        "z": "438d596005491859",
        "g": "7f7a81c81fb18909",
        "name": "Debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1170,
        "y": 360,
        "wires": []
    },
    {
        "id": "474ac194c8bbc512",
        "type": "openApi-red",
        "z": "438d596005491859",
        "g": "7f7a81c81fb18909",
        "name": "",
        "configUrlNode": "92fb21b02d9a57e6",
        "apiTag": "SmartPlug",
        "keepAuth": false,
        "operationData": {
            "id": "setSmartPlugState",
            "hasOperationId": true,
            "path": "/smartplug/webhook",
            "method": "post"
        },
        "outputStyle": "each response",
        "errorHandling": "throw exception",
        "internalErrors": {
            "text": "",
            "source": ""
        },
        "parameters": {
            "requestBody": {
                "name": "Request body",
                "required": true,
                "isActive": true,
                "activeFilter": "",
                "type": "editor:Request body",
                "parameters": {
                    "state": {
                        "name": "state",
                        "isActive": true,
                        "activeFilter": "",
                        "required": true,
                        "type": "msg",
                        "value": "payload.state"
                    }
                },
                "collapsed": false
            }
        },
        "requestContentType": "application/json",
        "responseContentType": "application/json",
        "outputs": 2,
        "responseOutputLabels": [
            {
                "code": "200",
                "text": "Smart Plug state successfully changed"
            },
            {
                "code": "400",
                "text": "Invalid state specified"
            }
        ],
        "responseAsPayload": false,
        "debugMode": false,
        "headers": [],
        "_version": "2.2.0",
        "x": 950,
        "y": 360,
        "wires": [
            [
                "0623d3f2732f194c"
            ],
            []
        ]
    },
    {
        "id": "1396224ee5de4b8d",
        "type": "http in",
        "z": "438d596005491859",
        "g": "3e5336b3c932e13c",
        "name": "[POST] Smartplug Webhook",
        "url": "/smartplug/webhook",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 700,
        "y": 540,
        "wires": [
            [
                "ac4c005192cf780a"
            ]
        ]
    },
    {
        "id": "ac4c005192cf780a",
        "type": "function",
        "z": "438d596005491859",
        "g": "3e5336b3c932e13c",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smartplug.state', newState);\nflow.set('smartplug_state', newState);\n\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 960,
        "y": 540,
        "wires": [
            [
                "9e0c9391f9b4250a"
            ]
        ]
    },
    {
        "id": "9e0c9391f9b4250a",
        "type": "http response",
        "z": "438d596005491859",
        "g": "3e5336b3c932e13c",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 1200,
        "y": 540,
        "wires": []
    },
    {
        "id": "a0774d5b5c031c59",
        "type": "inject",
        "z": "438d596005491859",
        "g": "7f7a81c81fb18909",
        "name": "Trigger webhook",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"state\":\"on\"}",
        "payloadType": "json",
        "x": 720,
        "y": 360,
        "wires": [
            [
                "474ac194c8bbc512"
            ]
        ]
    },
    {
        "id": "43333b017ce7e0ff",
        "type": "comment",
        "z": "438d596005491859",
        "g": "3e5336b3c932e13c",
        "name": "Init webhook endpoint",
        "info": "",
        "x": 680,
        "y": 480,
        "wires": []
    },
    {
        "id": "dc0d300ba5c12af3",
        "type": "comment",
        "z": "438d596005491859",
        "g": "7f7a81c81fb18909",
        "name": "Smartplug ",
        "info": "",
        "x": 680,
        "y": 300,
        "wires": []
    },
    {
        "id": "f1a2d740b68acbd5",
        "type": "http in",
        "z": "a1c0e100f11a4f9b",
        "name": "[GET] Smartplug Status",
        "url": "/smartplug",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 260,
        "y": 160,
        "wires": [
            [
                "7d2e0ec5b51d7f25"
            ]
        ]
    },
    {
        "id": "7d2e0ec5b51d7f25",
        "type": "function",
        "z": "a1c0e100f11a4f9b",
        "name": "Get Smartplug State",
        "func": "// Get current state and energy from context\nlet state = flow.get('smartplug_state') || 'off';\nlet energy = global.get('smartplug.energy') || 0;\n\nmsg.payload = {\n    device: 'smartplug',\n    state: state,\n    energyUsed: parseFloat(energy.toFixed(3)),\n    unit: 'kWh',\n    timestamp: new Date().toISOString()\n};\nmsg.statusCode = 200;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 510,
        "y": 160,
        "wires": [
            [
                "3a3c3e93e38c5a7f"
            ]
        ]
    },
    {
        "id": "3a3c3e93e38c5a7f",
        "type": "http response",
        "z": "a1c0e100f11a4f9b",
        "name": "Response (GET)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 760,
        "y": 160,
        "wires": []
    },
    {
        "id": "b8d0e89f6baceb2c",
        "type": "http in",
        "z": "a1c0e100f11a4f9b",
        "name": "[POST] Smartplug Webhook",
        "url": "/smartplug/webhook",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 260,
        "y": 300,
        "wires": [
            [
                "be8e188d1b45f6d8"
            ]
        ]
    },
    {
        "id": "be8e188d1b45f6d8",
        "type": "function",
        "z": "a1c0e100f11a4f9b",
        "name": "Handle Webhook State",
        "func": "// Parse desired state\nlet newState = (msg.payload.state || '').toLowerCase();\n\nif (!['on', 'off'].includes(newState)) {\n    msg.statusCode = 400;\n    msg.payload = { error: 'Invalid state. Use \"on\" or \"off\".' };\n    return msg;\n}\n\n// Save new state\nglobal.set('smartplug.state', newState);\nflow.set('smartplug_state', newState);\n\n// Simulate energy usage accumulation\nlet energy = global.get('smartplug.energy') || 0;\n\nglobal.set('smartplug.energy', energy);\n\nmsg.statusCode = 200;\nmsg.payload = {\n    message: `Smart plug turned ${newState}`,\n    state: newState,\n    timestamp: new Date().toISOString()\n};\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 300,
        "wires": [
            [
                "de6eb1739f1ab3c9"
            ]
        ]
    },
    {
        "id": "de6eb1739f1ab3c9",
        "type": "http response",
        "z": "a1c0e100f11a4f9b",
        "name": "Response (POST)",
        "statusCode": "",
        "headers": {
            "content-type": "application/json"
        },
        "x": 760,
        "y": 300,
        "wires": []
    }
]